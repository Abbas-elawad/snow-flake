[0m18:16:54.174900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0B93BE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0DA723E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0DA72680>]}


============================== 18:16:54.185856 | 7ae54cad-5b3d-4b7c-8855-ec15aad17704 ==============================
[0m18:16:54.185856 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:16:54.189068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:16:54.717478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ae54cad-5b3d-4b7c-8855-ec15aad17704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0DA77D30>]}
[0m18:16:54.775542 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:16:54.779541 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:16:54.782542 [debug] [MainThread]: Command `cli deps` succeeded at 18:16:54.782542 after 0.86 seconds
[0m18:16:54.783539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0B93BE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0DA77D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D0DA75C60>]}
[0m18:16:54.785492 [debug] [MainThread]: Flushing usage events
[0m18:16:55.518980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:17.422485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C835973EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C836CDEA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8373EADD0>]}


============================== 18:39:17.434486 | 1ae76c10-a32e-4153-95ab-d7b1ccc7dd79 ==============================
[0m18:39:17.434486 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:39:17.436440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:39:17.510026 [info ] [MainThread]: dbt version: 1.9.4
[0m18:39:17.511987 [info ] [MainThread]: python version: 3.10.7
[0m18:39:17.513026 [info ] [MainThread]: python path: C:\Users\alawa\AppData\Local\Programs\Python\Python310\python.exe
[0m18:39:17.515026 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m18:39:20.186028 [debug] [MainThread]: Traceback (most recent call last):
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m18:39:20.188048 [error] [MainThread]: Encountered an error:
No module named 'dbt.adapters.catalogs'
[0m18:39:20.276842 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 414, in debug
    results = task.run()
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\debug.py", line 205, in _load_profile
    profile: Profile = Profile.render(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m18:39:20.280836 [debug] [MainThread]: Command `dbt debug` failed at 18:39:20.280836 after 3.08 seconds
[0m18:39:20.282838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C835973EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C837415C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8486E0820>]}
[0m18:39:20.283837 [debug] [MainThread]: Flushing usage events
[0m18:39:21.050547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:55.546806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A28D2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A3B8AFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A3B8A1C0>]}


============================== 18:39:55.557332 | 8c9e48be-67d6-4f67-b4d6-104255616d02 ==============================
[0m18:39:55.557332 [info ] [MainThread]: Running with dbt=1.10.5
[0m18:39:55.559285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:39:55.652905 [info ] [MainThread]: dbt version: 1.10.5
[0m18:39:55.654222 [info ] [MainThread]: python version: 3.9.6
[0m18:39:55.655678 [info ] [MainThread]: python path: c:\users\alawa\snow\dbt_env\scripts\python.exe
[0m18:39:55.656737 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m18:39:57.427681 [info ] [MainThread]: Using profiles dir at C:\Users\alawa\.dbt
[0m18:39:57.428681 [info ] [MainThread]: Using profiles.yml file at C:\Users\alawa\.dbt\profiles.yml
[0m18:39:57.430684 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alawa\snow\snow_dbt\dbt_project.yml
[0m18:39:57.433681 [info ] [MainThread]: adapter type: snowflake
[0m18:39:57.434701 [info ] [MainThread]: adapter version: 1.10.0
[0m18:39:57.750680 [info ] [MainThread]: Configuration:
[0m18:39:57.752686 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:39:57.754686 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:39:57.755687 [info ] [MainThread]: Required dependencies:
[0m18:39:57.756736 [debug] [MainThread]: Executing "git --help"
[0m18:39:57.874515 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:39:57.876494 [debug] [MainThread]: STDERR: "b''"
[0m18:39:57.877493 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:39:57.878496 [info ] [MainThread]: Connection:
[0m18:39:57.880494 [info ] [MainThread]:   account: ki78787.me-central2.gcp
[0m18:39:57.881493 [info ] [MainThread]:   user: ABBAS1213
[0m18:39:57.882493 [info ] [MainThread]:   database: finance_db
[0m18:39:57.884499 [info ] [MainThread]:   warehouse: finance_wh
[0m18:39:57.886499 [info ] [MainThread]:   role: accountadmin
[0m18:39:57.887495 [info ] [MainThread]:   schema: L1_LANDING
[0m18:39:57.889498 [info ] [MainThread]:   authenticator: None
[0m18:39:57.891498 [info ] [MainThread]:   oauth_client_id: None
[0m18:39:57.892492 [info ] [MainThread]:   query_tag: None
[0m18:39:57.895501 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:39:57.897514 [info ] [MainThread]:   host: None
[0m18:39:57.899507 [info ] [MainThread]:   port: None
[0m18:39:57.900499 [info ] [MainThread]:   proxy_host: None
[0m18:39:57.902495 [info ] [MainThread]:   proxy_port: None
[0m18:39:57.903495 [info ] [MainThread]:   protocol: None
[0m18:39:57.905499 [info ] [MainThread]:   connect_retries: 1
[0m18:39:57.907501 [info ] [MainThread]:   connect_timeout: None
[0m18:39:57.918501 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:39:57.923498 [info ] [MainThread]:   retry_all: False
[0m18:39:57.924495 [info ] [MainThread]:   insecure_mode: False
[0m18:39:57.936499 [info ] [MainThread]:   reuse_connections: True
[0m18:39:57.951500 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m18:39:57.953498 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:39:58.900874 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:40:05.071986 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:40:05.072978 [debug] [MainThread]: On debug: select 1 as id
[0m18:40:05.073987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:07.645598 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.571 seconds
[0m18:40:07.649620 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:40:07.652590 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:40:07.657644 [debug] [MainThread]: Command `dbt debug` succeeded at 18:40:07.656633 after 12.33 seconds
[0m18:40:07.659631 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:40:07.661643 [debug] [MainThread]: On debug: Close
[0m18:40:07.764613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A28D2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A3C315E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A581C340>]}
[0m18:40:07.765613 [debug] [MainThread]: Flushing usage events
[0m18:40:08.501128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:09.622317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024930AF3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024931E5D9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493256ADA0>]}


============================== 14:58:09.627335 | 0bd4b628-073f-4f92-b4de-3a9b7003ebdd ==============================
[0m14:58:09.627335 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:58:09.628318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:58:11.965676 [debug] [MainThread]: Traceback (most recent call last):
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m14:58:11.966724 [error] [MainThread]: Encountered an error:
No module named 'dbt.adapters.catalogs'
[0m14:58:11.969677 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 232, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\runtime.py", line 79, in load_profile
    profile = Profile.render(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m14:58:11.970675 [debug] [MainThread]: Command `dbt run` failed at 14:58:11.970675 after 2.45 seconds
[0m14:58:11.971725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024930AF3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024943819450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024943819600>]}
[0m14:58:11.972727 [debug] [MainThread]: Flushing usage events
[0m14:58:12.695758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:51.780074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F12B00310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F13DAA370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F13DAA100>]}


============================== 14:58:51.787037 | 1179d8ac-f711-4753-93ae-fc315fae693d ==============================
[0m14:58:51.787037 [info ] [MainThread]: Running with dbt=1.10.5
[0m14:58:51.789036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:58:53.481262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1179d8ac-f711-4753-93ae-fc315fae693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0FEFA250>]}
[0m14:58:53.609266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1179d8ac-f711-4753-93ae-fc315fae693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F13D87250>]}
[0m14:58:53.612263 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m14:58:54.227394 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m14:58:54.229397 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:58:54.230393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1179d8ac-f711-4753-93ae-fc315fae693d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F14AA9D90>]}
[0m14:58:57.982982 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.snow_dbt.customer_stg' (models\customer rev\customer_stg.sql) depends on a source named 'landing.customers' which was not found
[0m14:58:57.983981 [debug] [MainThread]: Command `dbt run` failed at 14:58:57.983981 after 6.31 seconds
[0m14:58:57.984979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F12B00310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F15F16490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F15EA2940>]}
[0m14:58:57.985978 [debug] [MainThread]: Flushing usage events
[0m14:58:59.220697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:41.540075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001199ED012E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001199FFAA3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001199FFAA160>]}


============================== 14:59:41.545110 | bdbeea09-0253-48ba-9e66-70e268a551ac ==============================
[0m14:59:41.545110 [info ] [MainThread]: Running with dbt=1.10.5
[0m14:59:41.546074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:59:42.272937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdbeea09-0253-48ba-9e66-70e268a551ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001199F763370>]}
[0m14:59:42.353935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdbeea09-0253-48ba-9e66-70e268a551ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001199FFE71C0>]}
[0m14:59:42.355888 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m14:59:42.734971 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m14:59:42.736015 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:59:42.736965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdbeea09-0253-48ba-9e66-70e268a551ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119A0C35490>]}
[0m14:59:44.295164 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.snow_dbt.order_item_stg' (models\customer rev\order_item_stg.sql) depends on a source named 'landing.order_items' which was not found
[0m14:59:44.297117 [debug] [MainThread]: Command `dbt run` failed at 14:59:44.297117 after 2.86 seconds
[0m14:59:44.298167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001199ED012E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119A2021FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000119A2021160>]}
[0m14:59:44.298167 [debug] [MainThread]: Flushing usage events
[0m14:59:45.014309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:10.158077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211BFFD0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C224A3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C224A130>]}


============================== 15:00:10.163034 | 31914177-5946-4dfc-9786-9495c85f4b0f ==============================
[0m15:00:10.163034 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:00:10.164035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:11.104854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31914177-5946-4dfc-9786-9495c85f4b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C2E0A3D0>]}
[0m15:00:11.190890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31914177-5946-4dfc-9786-9495c85f4b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C2287160>]}
[0m15:00:11.193204 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:00:11.629850 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:00:11.630852 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:00:11.631853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31914177-5946-4dfc-9786-9495c85f4b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C2E2B460>]}
[0m15:00:13.472512 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.snow_dbt.order_stg' (models\customer rev\order_stg.sql) depends on a source named 'landing.dates' which was not found
[0m15:00:13.474466 [debug] [MainThread]: Command `dbt run` failed at 15:00:13.474466 after 3.43 seconds
[0m15:00:13.474466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211BFFD0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C42FB400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C42FB5E0>]}
[0m15:00:13.475513 [debug] [MainThread]: Flushing usage events
[0m15:00:14.186999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:52.577496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038D081250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038E32A340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038E32A0D0>]}


============================== 15:03:52.582505 | 9480a64e-3124-421c-b3ce-4adc09924f3c ==============================
[0m15:03:52.582505 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:03:52.584533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:03:53.629954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038EE8C0D0>]}
[0m15:03:53.741473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038E367130>]}
[0m15:03:53.743983 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:03:54.248443 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:03:54.250449 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:03:54.251443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203900536A0>]}
[0m15:03:56.993871 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example
- models.snow_dbt.example.customer_stg
[0m15:03:57.037646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203904BD520>]}
[0m15:03:57.214546 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:03:57.249212 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:03:57.328411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038E2C4AF0>]}
[0m15:03:57.329409 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m15:03:57.330409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038E1770D0>]}
[0m15:03:57.332409 [info ] [MainThread]: 
[0m15:03:57.332409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:03:57.333914 [info ] [MainThread]: 
[0m15:03:57.335429 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:03:57.344483 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m15:03:57.627864 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m15:03:57.627864 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m15:03:57.628864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:58.309068 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.680 seconds
[0m15:03:58.314572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m15:03:58.342838 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m15:03:58.343907 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m15:03:58.345018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:59.126524 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.782 seconds
[0m15:03:59.131522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038A587970>]}
[0m15:03:59.146166 [debug] [Thread-1  ]: Began running node model.snow_dbt.customer_stg
[0m15:03:59.147211 [debug] [Thread-2  ]: Began running node model.snow_dbt.date_stg
[0m15:03:59.147211 [info ] [Thread-1  ]: 1 of 5 START sql table model L1_LANDING.customer_stg ........................... [RUN]
[0m15:03:59.149163 [debug] [Thread-3  ]: Began running node model.snow_dbt.order_item_stg
[0m15:03:59.149163 [debug] [Thread-4  ]: Began running node model.snow_dbt.order_stg
[0m15:03:59.151163 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.customer_stg'
[0m15:03:59.150171 [info ] [Thread-2  ]: 2 of 5 START sql table model L1_LANDING.date_stg ............................... [RUN]
[0m15:03:59.152175 [info ] [Thread-3  ]: 3 of 5 START sql table model L1_LANDING.order_item_stg ......................... [RUN]
[0m15:03:59.155205 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.customer_stg
[0m15:03:59.153688 [info ] [Thread-4  ]: 4 of 5 START sql table model L1_LANDING.order_stg .............................. [RUN]
[0m15:03:59.157221 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.snow_dbt.date_stg'
[0m15:03:59.158218 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.snow_dbt.order_item_stg'
[0m15:03:59.171277 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.snow_dbt.order_stg'
[0m15:03:59.176122 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.customer_stg"
[0m15:03:59.177121 [debug] [Thread-2  ]: Began compiling node model.snow_dbt.date_stg
[0m15:03:59.178126 [debug] [Thread-3  ]: Began compiling node model.snow_dbt.order_item_stg
[0m15:03:59.179119 [debug] [Thread-4  ]: Began compiling node model.snow_dbt.order_stg
[0m15:03:59.186044 [debug] [Thread-2  ]: Writing injected SQL for node "model.snow_dbt.date_stg"
[0m15:03:59.194722 [debug] [Thread-3  ]: Writing injected SQL for node "model.snow_dbt.order_item_stg"
[0m15:03:59.199739 [debug] [Thread-4  ]: Writing injected SQL for node "model.snow_dbt.order_stg"
[0m15:03:59.202741 [debug] [Thread-2  ]: Began executing node model.snow_dbt.date_stg
[0m15:03:59.205773 [debug] [Thread-1  ]: Began executing node model.snow_dbt.customer_stg
[0m15:03:59.263710 [debug] [Thread-4  ]: Began executing node model.snow_dbt.order_stg
[0m15:03:59.279785 [debug] [Thread-3  ]: Began executing node model.snow_dbt.order_item_stg
[0m15:03:59.280784 [debug] [Thread-2  ]: Writing runtime sql for node "model.snow_dbt.date_stg"
[0m15:03:59.289332 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.customer_stg"
[0m15:03:59.293829 [debug] [Thread-4  ]: Writing runtime sql for node "model.snow_dbt.order_stg"
[0m15:03:59.299139 [debug] [Thread-3  ]: Writing runtime sql for node "model.snow_dbt.order_item_stg"
[0m15:03:59.307398 [debug] [Thread-2  ]: Using snowflake connection "model.snow_dbt.date_stg"
[0m15:03:59.309403 [debug] [Thread-4  ]: Using snowflake connection "model.snow_dbt.order_stg"
[0m15:03:59.309403 [debug] [Thread-2  ]: On model.snow_dbt.date_stg: create or replace transient table finance_db.L1_LANDING.date_stg
    
    
    
    as (

select 
	DATE,
	DAY,
	MONTH,
	YEAR,
	QUARTER,
	DAYOFWEEK,
	WEEKOFYEAR,
	UPDATED_AT 
from finance_db.L1_LANDING.DATES
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.date_stg"} */;
[0m15:03:59.310402 [debug] [Thread-4  ]: On model.snow_dbt.order_stg: create or replace transient table finance_db.L1_LANDING.order_stg
    
    
    
    as (
select 
	ORDERID as order_id,
	ORDERDATE as order_date,
	CUSTOMERID as customer_id,
	EMPLOYEEID as employee_id,
	STOREID as store_id,
	STATUS as status,
	UPDATED_AT as updated_at
from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.order_stg"} */;
[0m15:03:59.312400 [debug] [Thread-3  ]: Using snowflake connection "model.snow_dbt.order_item_stg"
[0m15:03:59.313913 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.customer_stg"
[0m15:03:59.314936 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:03:59.315444 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:03:59.316453 [debug] [Thread-3  ]: On model.snow_dbt.order_item_stg: create or replace transient table finance_db.L1_LANDING.order_item_stg
    
    
    
    as (
 select 
	ORDERID as order_id,
	ORDERITEMID as order_item,
	PRODUCTID as product_id,
	QUANTITY as quantity,
	UNITPRICE as unit_price,
	UPDATED_AT as updated_at
from finance_db.L1_LANDING.ORDERITEMS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.order_item_stg"} */;
[0m15:03:59.316453 [debug] [Thread-1  ]: On model.snow_dbt.customer_stg: create or replace transient table finance_db.L1_LANDING.customer_stg
    
    
    
    as (
select 
	CUSTOMERID as customer_id,
    FIRSTNAME as first_name,
    LASTNAME as last_name,
    concat(FIRSTNAME, ' ', LASTNAME) as full_name,
	EMAIL as email,
	PHONE as phone,
	ADDRESS as address,
	CITY as city,
	STATE as state,
	ZIPCODE as zipcode,
	UPDATED_AT as updated_at
from finance_db.L1_LANDING.CUSTOMERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_stg"} */;
[0m15:03:59.320454 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:03:59.323971 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:04:03.055511 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.732 seconds
[0m15:04:03.092587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038A661340>]}
[0m15:04:03.092587 [info ] [Thread-1  ]: 1 of 5 OK created sql table model L1_LANDING.customer_stg ...................... [[32mSUCCESS 1[0m in 3.93s]
[0m15:04:03.094639 [debug] [Thread-1  ]: Finished running node model.snow_dbt.customer_stg
[0m15:04:03.109693 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.795 seconds
[0m15:04:03.112728 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020390D5CDC0>]}
[0m15:04:03.113727 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.800 seconds
[0m15:04:03.116214 [info ] [Thread-4  ]: 4 of 5 OK created sql table model L1_LANDING.order_stg ......................... [[32mSUCCESS 1[0m in 3.94s]
[0m15:04:03.124802 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020390DBA850>]}
[0m15:04:03.126131 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.806 seconds
[0m15:04:03.127143 [debug] [Thread-4  ]: Finished running node model.snow_dbt.order_stg
[0m15:04:03.132139 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038EE854F0>]}
[0m15:04:03.128143 [info ] [Thread-2  ]: 2 of 5 OK created sql table model L1_LANDING.date_stg .......................... [[32mSUCCESS 1[0m in 3.97s]
[0m15:04:03.137168 [debug] [Thread-2  ]: Finished running node model.snow_dbt.date_stg
[0m15:04:03.135159 [info ] [Thread-3  ]: 3 of 5 OK created sql table model L1_LANDING.order_item_stg .................... [[32mSUCCESS 1[0m in 3.97s]
[0m15:04:03.138172 [debug] [Thread-3  ]: Finished running node model.snow_dbt.order_item_stg
[0m15:04:03.140170 [debug] [Thread-1  ]: Began running node model.snow_dbt.fact_orders
[0m15:04:03.141210 [info ] [Thread-1  ]: 5 of 5 START sql table model L1_LANDING.fact_orders ............................ [RUN]
[0m15:04:03.142185 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.snow_dbt.customer_stg, now model.snow_dbt.fact_orders)
[0m15:04:03.143742 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.fact_orders
[0m15:04:03.150736 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.fact_orders"
[0m15:04:03.151736 [debug] [Thread-1  ]: Began executing node model.snow_dbt.fact_orders
[0m15:04:03.157807 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.fact_orders"
[0m15:04:03.166363 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.fact_orders"
[0m15:04:03.166363 [debug] [Thread-1  ]: On model.snow_dbt.fact_orders: create or replace transient table finance_db.L1_LANDING.fact_orders
    
    
    
    as ( 
 
 select 
	oi.order_id,
	oi.updated_at,
	d.day,
	d.month,
	d.year,
	d.quarter,
	d.day_of_week,
	d.week_of_year
 from finance_db.L1_LANDING.order_stg oi
 left join finance_db.L1_LANDING.order_item_stg d
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fact_orders"} */;
[0m15:04:03.575875 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bdfd34-0000-a3b5-0000-a1790004110e
[0m15:04:03.575875 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 1
invalid identifier 'D.DAY'
[0m15:04:03.593029 [debug] [Thread-1  ]: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 1
  invalid identifier 'D.DAY'
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m15:04:03.594543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9480a64e-3124-421c-b3ce-4adc09924f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020390DC43D0>]}
[0m15:04:03.595558 [error] [Thread-1  ]: 5 of 5 ERROR creating sql table model L1_LANDING.fact_orders ................... [[31mERROR[0m in 0.45s]
[0m15:04:03.596933 [debug] [Thread-1  ]: Finished running node model.snow_dbt.fact_orders
[0m15:04:03.597944 [debug] [Thread-7  ]: Marking all children of 'model.snow_dbt.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 1
  invalid identifier 'D.DAY'
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql.
[0m15:04:03.598902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:03.599938 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m15:04:03.599938 [debug] [MainThread]: On list_finance_db: Close
[0m15:04:03.685033 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m15:04:03.685822 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m15:04:03.774921 [debug] [MainThread]: Connection 'model.snow_dbt.fact_orders' was left open.
[0m15:04:03.776380 [debug] [MainThread]: On model.snow_dbt.fact_orders: Close
[0m15:04:03.867907 [debug] [MainThread]: Connection 'model.snow_dbt.date_stg' was left open.
[0m15:04:03.867907 [debug] [MainThread]: On model.snow_dbt.date_stg: Close
[0m15:04:03.946698 [debug] [MainThread]: Connection 'model.snow_dbt.order_item_stg' was left open.
[0m15:04:03.946698 [debug] [MainThread]: On model.snow_dbt.order_item_stg: Close
[0m15:04:04.018627 [debug] [MainThread]: Connection 'model.snow_dbt.order_stg' was left open.
[0m15:04:04.019627 [debug] [MainThread]: On model.snow_dbt.order_stg: Close
[0m15:04:04.111733 [info ] [MainThread]: 
[0m15:04:04.112736 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.78 seconds (6.78s).
[0m15:04:04.114752 [debug] [MainThread]: Command end result
[0m15:04:04.153862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:04:04.157905 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:04:04.175233 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m15:04:04.176181 [info ] [MainThread]: 
[0m15:04:04.178253 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:04:04.178253 [info ] [MainThread]: 
[0m15:04:04.179249 [error] [MainThread]: [31mFailure in model fact_orders (models\customer rev\fact_orders.sql)[0m
[0m15:04:04.180250 [error] [MainThread]:   Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 1
  invalid identifier 'D.DAY'
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m15:04:04.181249 [info ] [MainThread]: 
[0m15:04:04.182242 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\customer rev\fact_orders.sql
[0m15:04:04.182242 [info ] [MainThread]: 
[0m15:04:04.183753 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m15:04:04.185790 [debug] [MainThread]: Command `dbt run` failed at 15:04:04.185790 after 11.75 seconds
[0m15:04:04.186809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038D081250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038A49F760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002038E2C4FA0>]}
[0m15:04:04.187808 [debug] [MainThread]: Flushing usage events
[0m15:04:05.042076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:49.105482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C576012B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C588AD370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C588AD100>]}


============================== 15:04:49.112842 | 4d80b998-39db-404b-99b4-aad54fd67e05 ==============================
[0m15:04:49.112842 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:04:49.114859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s fact_orders.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:04:50.137720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d80b998-39db-404b-99b4-aad54fd67e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C54A35100>]}
[0m15:04:50.230889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d80b998-39db-404b-99b4-aad54fd67e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C59537F70>]}
[0m15:04:50.231889 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:04:50.764681 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:04:51.216367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:51.217380 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\fact_orders.sql
[0m15:04:51.656146 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example.customer_stg
- models.snow_dbt.example
[0m15:04:51.691451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d80b998-39db-404b-99b4-aad54fd67e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5AB7B130>]}
[0m15:04:51.828929 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:04:51.833927 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:04:51.876347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d80b998-39db-404b-99b4-aad54fd67e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5AB4B340>]}
[0m15:04:51.877362 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m15:04:51.878356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d80b998-39db-404b-99b4-aad54fd67e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5A96BFD0>]}
[0m15:04:51.881353 [info ] [MainThread]: 
[0m15:04:51.882353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:51.882353 [info ] [MainThread]: 
[0m15:04:51.884872 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:04:51.887403 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m15:04:52.019536 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m15:04:52.020539 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m15:04:52.021535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:52.895988 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.874 seconds
[0m15:04:52.916595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m15:04:52.956844 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m15:04:52.957843 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m15:04:52.958842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:53.423609 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.465 seconds
[0m15:04:53.432130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d80b998-39db-404b-99b4-aad54fd67e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5AB48A30>]}
[0m15:04:53.439665 [debug] [Thread-1  ]: Began running node model.snow_dbt.fact_orders
[0m15:04:53.440665 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.fact_orders ............................ [RUN]
[0m15:04:53.442664 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.fact_orders'
[0m15:04:53.444169 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.fact_orders
[0m15:04:53.458738 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.fact_orders"
[0m15:04:53.461736 [debug] [Thread-1  ]: Began executing node model.snow_dbt.fact_orders
[0m15:04:53.533070 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.fact_orders"
[0m15:04:53.536093 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.fact_orders"
[0m15:04:53.537104 [debug] [Thread-1  ]: On model.snow_dbt.fact_orders: create or replace transient table finance_db.L1_LANDING.fact_orders
    
    
    
    as ( 
 
 select 
	oi.order_id,
	oi.updated_at,
	d.day,
	d.month,
	d.year,
	d.quarter,
	d.day_of_week,
	d.week_of_year
 from finance_db.L1_LANDING.date_stg oi
 left join finance_db.L1_LANDING.order_item_stg d 
 on oi.order_id = d.order_id
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fact_orders"} */;
[0m15:04:53.538115 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:04:53.994164 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bdfd35-0000-a353-0000-a1790003d3da
[0m15:04:53.994669 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 1
invalid identifier 'OI.ORDER_ID'
[0m15:04:53.998685 [debug] [Thread-1  ]: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 8 at position 1
  invalid identifier 'OI.ORDER_ID'
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m15:04:54.005723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d80b998-39db-404b-99b4-aad54fd67e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5B144EE0>]}
[0m15:04:54.007734 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model L1_LANDING.fact_orders ................... [[31mERROR[0m in 0.56s]
[0m15:04:54.011747 [debug] [Thread-1  ]: Finished running node model.snow_dbt.fact_orders
[0m15:04:54.013732 [debug] [Thread-7  ]: Marking all children of 'model.snow_dbt.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 8 at position 1
  invalid identifier 'OI.ORDER_ID'
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql.
[0m15:04:54.015765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:54.016767 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m15:04:54.016767 [debug] [MainThread]: On list_finance_db: Close
[0m15:04:54.105617 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m15:04:54.106625 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m15:04:54.199380 [debug] [MainThread]: Connection 'model.snow_dbt.fact_orders' was left open.
[0m15:04:54.200383 [debug] [MainThread]: On model.snow_dbt.fact_orders: Close
[0m15:04:54.361460 [info ] [MainThread]: 
[0m15:04:54.362460 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m15:04:54.365499 [debug] [MainThread]: Command end result
[0m15:04:54.491469 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:04:54.495936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:04:54.509593 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m15:04:54.510597 [info ] [MainThread]: 
[0m15:04:54.511595 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:04:54.512591 [info ] [MainThread]: 
[0m15:04:54.514605 [error] [MainThread]: [31mFailure in model fact_orders (models\customer rev\fact_orders.sql)[0m
[0m15:04:54.515612 [error] [MainThread]:   Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 8 at position 1
  invalid identifier 'OI.ORDER_ID'
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m15:04:54.516337 [info ] [MainThread]: 
[0m15:04:54.518345 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\customer rev\fact_orders.sql
[0m15:04:54.519346 [info ] [MainThread]: 
[0m15:04:54.521346 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:04:54.523865 [debug] [MainThread]: Command `dbt run` failed at 15:04:54.523865 after 5.63 seconds
[0m15:04:54.525383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C576012B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5AB4B340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C5B1AD340>]}
[0m15:04:54.527397 [debug] [MainThread]: Flushing usage events
[0m15:04:55.427981 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:28.731821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1534D12E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15574D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15574D130>]}


============================== 15:05:28.742866 | 1675b4ed-6f13-44c4-b9dd-d5e1266dddb4 ==============================
[0m15:05:28.742866 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:05:28.744883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_orders.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:31.031867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1675b4ed-6f13-44c4-b9dd-d5e1266dddb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1562D17C0>]}
[0m15:05:31.209457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1675b4ed-6f13-44c4-b9dd-d5e1266dddb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F154EA2970>]}
[0m15:05:31.213964 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:05:32.411748 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:05:35.241861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:35.242859 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\fact_orders.sql
[0m15:05:35.726781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example
- models.snow_dbt.example.customer_stg
[0m15:05:35.754412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1675b4ed-6f13-44c4-b9dd-d5e1266dddb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F157A19130>]}
[0m15:05:35.927625 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:05:35.947554 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:05:35.995610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1675b4ed-6f13-44c4-b9dd-d5e1266dddb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1577F3550>]}
[0m15:05:35.996415 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m15:05:35.997468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1675b4ed-6f13-44c4-b9dd-d5e1266dddb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15782C070>]}
[0m15:05:36.000423 [info ] [MainThread]: 
[0m15:05:36.002426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:36.002426 [info ] [MainThread]: 
[0m15:05:36.004463 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:05:36.007473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m15:05:39.822565 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m15:05:39.822565 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m15:05:39.822565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:40.337371 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.514 seconds
[0m15:05:40.347404 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m15:05:40.366514 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m15:05:40.367079 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m15:05:40.367079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:40.818011 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.451 seconds
[0m15:05:40.824607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1675b4ed-6f13-44c4-b9dd-d5e1266dddb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1579EAAF0>]}
[0m15:05:40.831616 [debug] [Thread-1  ]: Began running node model.snow_dbt.fact_orders
[0m15:05:40.832659 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.fact_orders ............................ [RUN]
[0m15:05:40.834168 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.fact_orders'
[0m15:05:40.834731 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.fact_orders
[0m15:05:40.845962 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.fact_orders"
[0m15:05:40.846956 [debug] [Thread-1  ]: Began executing node model.snow_dbt.fact_orders
[0m15:05:40.898741 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.fact_orders"
[0m15:05:40.901700 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.fact_orders"
[0m15:05:40.901700 [debug] [Thread-1  ]: On model.snow_dbt.fact_orders: create or replace transient table finance_db.L1_LANDING.fact_orders
    
    
    
    as ( 
 
 select 
	oi.order_id,
	oi.updated_at,
	d.day,
	d.month,
	d.year,
	d.quarter,
	d.day_of_week,
	d.week_of_year
 from finance_db.L1_LANDING.order_stg oi
 left join finance_db.L1_LANDING.order_item_stg d 
 on oi.order_id = d.order_id
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fact_orders"} */;
[0m15:05:40.902743 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:05:41.430497 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bdfd35-0000-a3b5-0000-a1790004111a
[0m15:05:41.431499 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 1
invalid identifier 'D.DAY'
[0m15:05:41.459664 [debug] [Thread-1  ]: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 1
  invalid identifier 'D.DAY'
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m15:05:41.464678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1675b4ed-6f13-44c4-b9dd-d5e1266dddb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1562B1D90>]}
[0m15:05:41.466691 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model L1_LANDING.fact_orders ................... [[31mERROR[0m in 0.63s]
[0m15:05:41.470213 [debug] [Thread-1  ]: Finished running node model.snow_dbt.fact_orders
[0m15:05:41.472214 [debug] [Thread-7  ]: Marking all children of 'model.snow_dbt.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 1
  invalid identifier 'D.DAY'
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql.
[0m15:05:41.476748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:41.477748 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m15:05:41.479748 [debug] [MainThread]: On list_finance_db: Close
[0m15:05:41.591371 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m15:05:41.592365 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m15:05:41.661530 [debug] [MainThread]: Connection 'model.snow_dbt.fact_orders' was left open.
[0m15:05:41.662531 [debug] [MainThread]: On model.snow_dbt.fact_orders: Close
[0m15:05:41.750917 [info ] [MainThread]: 
[0m15:05:41.751884 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.75 seconds (5.75s).
[0m15:05:41.752877 [debug] [MainThread]: Command end result
[0m15:05:41.870702 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:05:41.874738 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:05:41.886800 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m15:05:41.887799 [info ] [MainThread]: 
[0m15:05:41.888800 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:05:41.889799 [info ] [MainThread]: 
[0m15:05:41.890802 [error] [MainThread]: [31mFailure in model fact_orders (models\customer rev\fact_orders.sql)[0m
[0m15:05:41.891805 [error] [MainThread]:   Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 1
  invalid identifier 'D.DAY'
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m15:05:41.892800 [info ] [MainThread]: 
[0m15:05:41.893802 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\customer rev\fact_orders.sql
[0m15:05:41.895022 [info ] [MainThread]: 
[0m15:05:41.896038 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:05:41.897037 [debug] [MainThread]: Command `dbt run` failed at 15:05:41.897037 after 13.51 seconds
[0m15:05:41.898073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1534D12E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1577F3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15779C790>]}
[0m15:05:41.899055 [debug] [MainThread]: Flushing usage events
[0m15:05:42.613852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:43.283836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA4A81280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA6CFD3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA6CFD160>]}


============================== 15:06:43.288045 | b5094067-399d-4486-8d15-f386b150ebf3 ==============================
[0m15:06:43.288045 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:06:43.289045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_orders.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:44.056891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5094067-399d-4486-8d15-f386b150ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA2E6F760>]}
[0m15:06:44.140189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5094067-399d-4486-8d15-f386b150ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA6D3A190>]}
[0m15:06:44.142050 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:06:44.524813 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:06:44.764300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:44.764854 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\fact_orders.sql
[0m15:06:45.102715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example
- models.snow_dbt.example.customer_stg
[0m15:06:45.125678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5094067-399d-4486-8d15-f386b150ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA8FC9130>]}
[0m15:06:45.252574 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:06:45.255621 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:06:45.292801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5094067-399d-4486-8d15-f386b150ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA8DA3BB0>]}
[0m15:06:45.293374 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m15:06:45.293895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5094067-399d-4486-8d15-f386b150ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA8DDC130>]}
[0m15:06:45.296940 [info ] [MainThread]: 
[0m15:06:45.298202 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:45.298766 [info ] [MainThread]: 
[0m15:06:45.300457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:45.303447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m15:06:45.402371 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m15:06:45.403876 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m15:06:45.403876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:45.926044 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.521 seconds
[0m15:06:45.944725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m15:06:45.965710 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m15:06:45.966462 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m15:06:45.966462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:46.417737 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.451 seconds
[0m15:06:46.431987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5094067-399d-4486-8d15-f386b150ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA8F9A6D0>]}
[0m15:06:46.440596 [debug] [Thread-1  ]: Began running node model.snow_dbt.fact_orders
[0m15:06:46.442599 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.fact_orders ............................ [RUN]
[0m15:06:46.444632 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.fact_orders'
[0m15:06:46.445641 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.fact_orders
[0m15:06:46.461405 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.fact_orders"
[0m15:06:46.463915 [debug] [Thread-1  ]: Began executing node model.snow_dbt.fact_orders
[0m15:06:46.521431 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.fact_orders"
[0m15:06:46.530524 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.fact_orders"
[0m15:06:46.531518 [debug] [Thread-1  ]: On model.snow_dbt.fact_orders: create or replace transient table finance_db.L1_LANDING.fact_orders
    
    
    
    as ( 
 
 select 
    oi.order_id,
    oi.order_date,
    oi.customer_id,
    oi.employee_id,
    oi.store_id,
    oi.status,
    oi.updated_at,
    d.order_item,
    d.product_id,
    d.quantity,
    d.unit_price
 from finance_db.L1_LANDING.order_stg oi
 left join finance_db.L1_LANDING.order_item_stg d 
 on oi.order_id = d.order_id
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fact_orders"} */;
[0m15:06:46.532515 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:06:48.721392 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.188 seconds
[0m15:06:48.751105 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5094067-399d-4486-8d15-f386b150ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA9669670>]}
[0m15:06:48.752068 [info ] [Thread-1  ]: 1 of 1 OK created sql table model L1_LANDING.fact_orders ....................... [[32mSUCCESS 1[0m in 2.31s]
[0m15:06:48.754581 [debug] [Thread-1  ]: Finished running node model.snow_dbt.fact_orders
[0m15:06:48.756590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:48.756590 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m15:06:48.757591 [debug] [MainThread]: On list_finance_db: Close
[0m15:06:48.851004 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m15:06:48.852005 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m15:06:48.932447 [debug] [MainThread]: Connection 'model.snow_dbt.fact_orders' was left open.
[0m15:06:48.932447 [debug] [MainThread]: On model.snow_dbt.fact_orders: Close
[0m15:06:49.310563 [info ] [MainThread]: 
[0m15:06:49.311565 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m15:06:49.312564 [debug] [MainThread]: Command end result
[0m15:06:49.420719 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:06:49.423767 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:06:49.432726 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m15:06:49.434229 [info ] [MainThread]: 
[0m15:06:49.435747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:49.436756 [info ] [MainThread]: 
[0m15:06:49.437753 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:06:49.438798 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:49.438798 after 6.26 seconds
[0m15:06:49.438798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA4A81280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA5E1CA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA9673A00>]}
[0m15:06:49.439801 [debug] [MainThread]: Flushing usage events
[0m15:06:50.176579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:01.438441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74A5212B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74B7CD370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74B7CD100>]}


============================== 15:53:01.443441 | e02ed527-bb0f-4775-ba0b-6eae3e36f438 ==============================
[0m15:53:01.443441 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:53:01.444443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s order_item_stg.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:02.606164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e02ed527-bb0f-4775-ba0b-6eae3e36f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E747945100>]}
[0m15:53:02.688170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e02ed527-bb0f-4775-ba0b-6eae3e36f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74B7819D0>]}
[0m15:53:02.690280 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:53:03.186748 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:53:03.812810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:53:03.813812 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\order_stg.sql
[0m15:53:03.813812 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\order_item_stg.sql
[0m15:53:04.144085 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example
- models.snow_dbt.example.customer_stg
[0m15:53:04.167097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e02ed527-bb0f-4775-ba0b-6eae3e36f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74DA87130>]}
[0m15:53:04.281089 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:53:04.286101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:53:04.321589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e02ed527-bb0f-4775-ba0b-6eae3e36f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74D6B4B50>]}
[0m15:53:04.321589 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m15:53:04.322590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e02ed527-bb0f-4775-ba0b-6eae3e36f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74D879970>]}
[0m15:53:04.324634 [info ] [MainThread]: 
[0m15:53:04.325591 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:04.326273 [info ] [MainThread]: 
[0m15:53:04.327315 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:53:04.328282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m15:53:05.630256 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m15:53:05.631256 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m15:53:05.631256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:06.505128 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.874 seconds
[0m15:53:06.515535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m15:53:06.533589 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m15:53:06.534594 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m15:53:06.534594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:06.907234 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.372 seconds
[0m15:53:06.926157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e02ed527-bb0f-4775-ba0b-6eae3e36f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74DA5A610>]}
[0m15:53:06.943904 [debug] [Thread-1  ]: Began running node model.snow_dbt.order_item_stg
[0m15:53:06.945906 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.order_item_stg ......................... [RUN]
[0m15:53:06.947909 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.order_item_stg'
[0m15:53:06.948954 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.order_item_stg
[0m15:53:06.963902 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.order_item_stg"
[0m15:53:06.964908 [debug] [Thread-1  ]: Began executing node model.snow_dbt.order_item_stg
[0m15:53:07.004946 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.order_item_stg"
[0m15:53:07.005948 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.order_item_stg"
[0m15:53:07.006946 [debug] [Thread-1  ]: On model.snow_dbt.order_item_stg: create or replace transient table finance_db.L1_LANDING.order_item_stg
    
    
    
    as (
 select 
	ORDERID as order_id,
	ORDERITEMID as order_item,
	PRODUCTID as product_id,
	QUANTITY as quantity,
	UNITPRICE as unit_price,
    quantity * unitprice as total_price,
	UPDATED_AT as updated_at
from finance_db.L1_LANDING.ORDERITEMS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.order_item_stg"} */;
[0m15:53:07.007945 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:53:09.013133 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.005 seconds
[0m15:53:09.044630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e02ed527-bb0f-4775-ba0b-6eae3e36f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7483D39A0>]}
[0m15:53:09.045638 [info ] [Thread-1  ]: 1 of 1 OK created sql table model L1_LANDING.order_item_stg .................... [[32mSUCCESS 1[0m in 2.10s]
[0m15:53:09.046384 [debug] [Thread-1  ]: Finished running node model.snow_dbt.order_item_stg
[0m15:53:09.048391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:09.049434 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m15:53:09.049434 [debug] [MainThread]: On list_finance_db: Close
[0m15:53:09.222949 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m15:53:09.224948 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m15:53:09.310128 [debug] [MainThread]: Connection 'model.snow_dbt.order_item_stg' was left open.
[0m15:53:09.310958 [debug] [MainThread]: On model.snow_dbt.order_item_stg: Close
[0m15:53:09.403686 [info ] [MainThread]: 
[0m15:53:09.407665 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m15:53:09.412666 [debug] [MainThread]: Command end result
[0m15:53:09.521707 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:53:09.524704 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:53:09.533701 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m15:53:09.533701 [info ] [MainThread]: 
[0m15:53:09.534703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:09.535711 [info ] [MainThread]: 
[0m15:53:09.536656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:53:09.537259 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:09.537259 after 8.22 seconds
[0m15:53:09.538321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74A5212B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74D6B4BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E74A8A5340>]}
[0m15:53:09.539315 [debug] [MainThread]: Flushing usage events
[0m15:53:10.282637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:26.191973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211F571280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221217ED3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221217ED160>]}


============================== 15:53:26.196662 | 1dac1e55-eb1a-4fdc-9b9b-b46a69c8ee95 ==============================
[0m15:53:26.196662 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:53:26.197663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s order_stg.sql', 'send_anonymous_usage_stats': 'True'}
[0m15:53:26.972578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dac1e55-eb1a-4fdc-9b9b-b46a69c8ee95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211D95F760>]}
[0m15:53:27.058579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dac1e55-eb1a-4fdc-9b9b-b46a69c8ee95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002212182A190>]}
[0m15:53:27.060533 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:53:27.448541 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:53:27.681581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:27.682584 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:27.691587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example.customer_stg
- models.snow_dbt.example
[0m15:53:27.740578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dac1e55-eb1a-4fdc-9b9b-b46a69c8ee95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022123907EB0>]}
[0m15:53:27.858546 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:53:27.861582 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:53:27.894545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dac1e55-eb1a-4fdc-9b9b-b46a69c8ee95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221238FED30>]}
[0m15:53:27.895582 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m15:53:27.896542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dac1e55-eb1a-4fdc-9b9b-b46a69c8ee95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221239075E0>]}
[0m15:53:27.897543 [info ] [MainThread]: 
[0m15:53:27.898911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:27.898911 [info ] [MainThread]: 
[0m15:53:27.899947 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:53:27.901811 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m15:53:27.998564 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m15:53:27.999568 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m15:53:27.999568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:28.810969 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.811 seconds
[0m15:53:28.820673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m15:53:28.838674 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m15:53:28.838674 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m15:53:28.839673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:29.200967 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.362 seconds
[0m15:53:29.208996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dac1e55-eb1a-4fdc-9b9b-b46a69c8ee95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221239249D0>]}
[0m15:53:29.215953 [debug] [Thread-1  ]: Began running node model.snow_dbt.order_stg
[0m15:53:29.215953 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.order_stg .............................. [RUN]
[0m15:53:29.217956 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.order_stg'
[0m15:53:29.218954 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.order_stg
[0m15:53:29.229958 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.order_stg"
[0m15:53:29.230959 [debug] [Thread-1  ]: Began executing node model.snow_dbt.order_stg
[0m15:53:29.273960 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.order_stg"
[0m15:53:29.275961 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.order_stg"
[0m15:53:29.276959 [debug] [Thread-1  ]: On model.snow_dbt.order_stg: create or replace transient table finance_db.L1_LANDING.order_stg
    
    
    
    as (
select 
	ORDERID as order_id,
	ORDERDATE as order_date,
	CUSTOMERID as customer_id,
	EMPLOYEEID as employee_id,
	STOREID as store_id,
	STATUS as status,
    case    
        when STATUS = '01' then 'Complete'
        when STATUS = '02' then 'In Progress'
        when STATUS = '03' then 'Cancelled'
        else null
    end as order_status,
	UPDATED_AT as updated_at
from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.order_stg"} */;
[0m15:53:29.276959 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:53:30.712112 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.435 seconds
[0m15:53:30.750413 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dac1e55-eb1a-4fdc-9b9b-b46a69c8ee95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022124030FD0>]}
[0m15:53:30.751423 [info ] [Thread-1  ]: 1 of 1 OK created sql table model L1_LANDING.order_stg ......................... [[32mSUCCESS 1[0m in 1.53s]
[0m15:53:30.754421 [debug] [Thread-1  ]: Finished running node model.snow_dbt.order_stg
[0m15:53:30.756420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:30.757465 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m15:53:30.757465 [debug] [MainThread]: On list_finance_db: Close
[0m15:53:30.851919 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m15:53:30.852937 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m15:53:30.936774 [debug] [MainThread]: Connection 'model.snow_dbt.order_stg' was left open.
[0m15:53:30.939777 [debug] [MainThread]: On model.snow_dbt.order_stg: Close
[0m15:53:31.047760 [info ] [MainThread]: 
[0m15:53:31.049766 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m15:53:31.054762 [debug] [MainThread]: Command end result
[0m15:53:31.117810 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:53:31.121754 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:53:31.130751 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m15:53:31.130751 [info ] [MainThread]: 
[0m15:53:31.131752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:31.132734 [info ] [MainThread]: 
[0m15:53:31.132734 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:53:31.134778 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:31.134778 after 5.05 seconds
[0m15:53:31.134778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211F571280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221217B2D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022123925F10>]}
[0m15:53:31.135743 [debug] [MainThread]: Flushing usage events
[0m15:53:31.819534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:49.406498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDD141280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDE3ED340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDE3ED0D0>]}


============================== 15:59:49.411499 | 1572241e-ef67-4fc0-a2ba-dcae66ed1e12 ==============================
[0m15:59:49.411499 [info ] [MainThread]: Running with dbt=1.10.5
[0m15:59:49.413497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s fact_order.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:59:50.146579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1572241e-ef67-4fc0-a2ba-dcae66ed1e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDA55F760>]}
[0m15:59:50.237534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1572241e-ef67-4fc0-a2ba-dcae66ed1e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDE42A160>]}
[0m15:59:50.238948 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:59:50.614959 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m15:59:50.834958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:50.836007 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\fact_orders.sql
[0m15:59:51.157832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example
- models.snow_dbt.example.customer_stg
[0m15:59:51.178897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1572241e-ef67-4fc0-a2ba-dcae66ed1e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EE06B9130>]}
[0m15:59:51.292842 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:59:51.295845 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:59:51.331433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1572241e-ef67-4fc0-a2ba-dcae66ed1e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EE0689700>]}
[0m15:59:51.332429 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m15:59:51.332429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1572241e-ef67-4fc0-a2ba-dcae66ed1e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EE034C340>]}
[0m15:59:51.333430 [warn ] [MainThread]: The selection criterion 'fact_order.sql' does not match any enabled nodes
[0m15:59:51.335431 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:59:51.336430 [debug] [MainThread]: Command end result
[0m15:59:51.365428 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m15:59:51.369430 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m15:59:51.375430 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m15:59:51.376430 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:51.376430 after 2.07 seconds
[0m15:59:51.377430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDD141280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDBB528E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EDE42A160>]}
[0m15:59:51.377430 [debug] [MainThread]: Flushing usage events
[0m15:59:52.055635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:25.363813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F1A712E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F3CFD370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F3CFD100>]}


============================== 16:00:25.368811 | e969c883-5673-4f87-9e30-cd5589b90264 ==============================
[0m16:00:25.368811 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:00:25.369813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s fact_orders.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:26.228811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e969c883-5673-4f87-9e30-cd5589b90264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224EFE71820>]}
[0m16:00:26.308811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e969c883-5673-4f87-9e30-cd5589b90264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F3CCC3A0>]}
[0m16:00:26.309812 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:00:26.680408 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:00:26.929889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:26.929889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:26.938892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example
- models.snow_dbt.example.customer_stg
[0m16:00:26.986840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e969c883-5673-4f87-9e30-cd5589b90264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F5E12130>]}
[0m16:00:27.099840 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:00:27.102843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:00:27.136299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e969c883-5673-4f87-9e30-cd5589b90264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F5E01A30>]}
[0m16:00:27.137337 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m16:00:27.137337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e969c883-5673-4f87-9e30-cd5589b90264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F5E12460>]}
[0m16:00:27.139327 [info ] [MainThread]: 
[0m16:00:27.140327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:27.141278 [info ] [MainThread]: 
[0m16:00:27.141725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:27.143781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:00:27.243947 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:00:27.243947 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:00:27.244947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:28.095986 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.851 seconds
[0m16:00:28.109246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:00:28.126303 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:00:28.126303 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:00:28.127299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:28.609967 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.483 seconds
[0m16:00:28.617398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e969c883-5673-4f87-9e30-cd5589b90264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F4860520>]}
[0m16:00:28.623912 [debug] [Thread-1  ]: Began running node model.snow_dbt.fact_orders
[0m16:00:28.624912 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.fact_orders ............................ [RUN]
[0m16:00:28.626945 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.fact_orders'
[0m16:00:28.626945 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.fact_orders
[0m16:00:28.639957 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.fact_orders"
[0m16:00:28.640913 [debug] [Thread-1  ]: Began executing node model.snow_dbt.fact_orders
[0m16:00:28.681959 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.fact_orders"
[0m16:00:28.684913 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.fact_orders"
[0m16:00:28.685913 [debug] [Thread-1  ]: On model.snow_dbt.fact_orders: create or replace transient table finance_db.L1_LANDING.fact_orders
    
    
    
    as ( 
 
 select 
    oi.order_id,
    oi.order_date,
    oi.customer_id,
    oi.employee_id,
    oi.store_id,
    oi.status,
    oi.order_status,
    count(distinct oi.order_id) as order_count,
    sum(d.total_price) as Revenue,
    oi.updated_at
 from finance_db.L1_LANDING.order_stg oi
 left join finance_db.L1_LANDING.order_item_stg d 
 on oi.order_id = d.order_id
 group by (1, 2, 3, 4, 5, 6, 7)
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fact_orders"} */;
[0m16:00:28.685913 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:00:29.298922 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bdfd6c-0000-a353-0000-a1790003d50e
[0m16:00:29.298922 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 17 at position 4
'OI.UPDATED_AT' in select clause is neither an aggregate nor in the group by clause.
[0m16:00:29.312921 [debug] [Thread-1  ]: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  001104 (42601): SQL compilation error: error line 17 at position 4
  'OI.UPDATED_AT' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m16:00:29.315920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e969c883-5673-4f87-9e30-cd5589b90264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F646EE80>]}
[0m16:00:29.316964 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model L1_LANDING.fact_orders ................... [[31mERROR[0m in 0.69s]
[0m16:00:29.317924 [debug] [Thread-1  ]: Finished running node model.snow_dbt.fact_orders
[0m16:00:29.318971 [debug] [Thread-7  ]: Marking all children of 'model.snow_dbt.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  001104 (42601): SQL compilation error: error line 17 at position 4
  'OI.UPDATED_AT' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql.
[0m16:00:29.320920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:29.321962 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:00:29.321962 [debug] [MainThread]: On list_finance_db: Close
[0m16:00:29.410923 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:00:29.412926 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:00:29.493770 [debug] [MainThread]: Connection 'model.snow_dbt.fact_orders' was left open.
[0m16:00:29.494304 [debug] [MainThread]: On model.snow_dbt.fact_orders: Close
[0m16:00:29.582488 [info ] [MainThread]: 
[0m16:00:29.583448 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m16:00:29.585438 [debug] [MainThread]: Command end result
[0m16:00:29.622964 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:00:29.626006 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:00:29.635007 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:00:29.635007 [info ] [MainThread]: 
[0m16:00:29.635966 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:00:29.637173 [info ] [MainThread]: 
[0m16:00:29.638185 [error] [MainThread]: [31mFailure in model fact_orders (models\customer rev\fact_orders.sql)[0m
[0m16:00:29.639225 [error] [MainThread]:   Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  001104 (42601): SQL compilation error: error line 17 at position 4
  'OI.UPDATED_AT' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m16:00:29.639225 [info ] [MainThread]: 
[0m16:00:29.640230 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\customer rev\fact_orders.sql
[0m16:00:29.641183 [info ] [MainThread]: 
[0m16:00:29.641183 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:00:29.643234 [debug] [MainThread]: Command `dbt run` failed at 16:00:29.642184 after 4.45 seconds
[0m16:00:29.643234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F1A712E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F3CDD3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F2D6D0A0>]}
[0m16:00:29.644226 [debug] [MainThread]: Flushing usage events
[0m16:00:30.443597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:58.464855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823AED1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823C17D340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823C17D0D0>]}


============================== 16:03:58.469892 | 88e2d7ff-f052-4c57-a472-d8f1857016ce ==============================
[0m16:03:58.469892 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:03:58.470877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s fact_orders.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:59.197766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88e2d7ff-f052-4c57-a472-d8f1857016ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182382EF760>]}
[0m16:03:59.279767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88e2d7ff-f052-4c57-a472-d8f1857016ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823C1BA160>]}
[0m16:03:59.281901 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:03:59.646953 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:03:59.860913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:59.861912 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\fact_orders.sql
[0m16:04:00.190909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example.customer_stg
- models.snow_dbt.example
[0m16:04:00.212907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88e2d7ff-f052-4c57-a472-d8f1857016ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823E448130>]}
[0m16:04:00.327911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:04:00.330966 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:04:00.366851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88e2d7ff-f052-4c57-a472-d8f1857016ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823E239D60>]}
[0m16:04:00.366851 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m16:04:00.368120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88e2d7ff-f052-4c57-a472-d8f1857016ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823E25CDF0>]}
[0m16:04:00.370176 [info ] [MainThread]: 
[0m16:04:00.371130 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:00.371130 [info ] [MainThread]: 
[0m16:04:00.372178 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:00.374196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:04:00.470010 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:04:00.470010 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:04:00.471021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:01.316163 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.845 seconds
[0m16:04:01.333094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:04:01.350095 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:04:01.350095 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:04:01.351096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:01.753519 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.403 seconds
[0m16:04:01.761469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88e2d7ff-f052-4c57-a472-d8f1857016ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823E47B460>]}
[0m16:04:01.768451 [debug] [Thread-1  ]: Began running node model.snow_dbt.fact_orders
[0m16:04:01.769460 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.fact_orders ............................ [RUN]
[0m16:04:01.770480 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.fact_orders'
[0m16:04:01.771500 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.fact_orders
[0m16:04:01.784502 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.fact_orders"
[0m16:04:01.786460 [debug] [Thread-1  ]: Began executing node model.snow_dbt.fact_orders
[0m16:04:01.831466 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.fact_orders"
[0m16:04:01.834457 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.fact_orders"
[0m16:04:01.834457 [debug] [Thread-1  ]: On model.snow_dbt.fact_orders: create or replace transient table finance_db.L1_LANDING.fact_orders
    
    
    
    as ( 
 
 select 
    oi.order_id,
    oi.order_date,
    oi.customer_id,
    oi.employee_id,
    oi.store_id,
    oi.status,
    oi.order_status,
    count(distinct oi.order_id) as order_count,
    sum(d.total_price) as Revenue,
    oi.updated_at
 from finance_db.L1_LANDING.order_stg oi
 left join finance_db.L1_LANDING.order_item_stg d 
 on oi.order_id = d.order_id
 group by (1, 2, 3, 4, 5, 6, 7, 8)
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fact_orders"} */;
[0m16:04:01.835502 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:04:02.172166 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bdfd70-0000-a3ba-0000-a179000420ce
[0m16:04:02.173126 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 17 at position 4
'OI.UPDATED_AT' in select clause is neither an aggregate nor in the group by clause.
[0m16:04:02.177164 [debug] [Thread-1  ]: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  001104 (42601): SQL compilation error: error line 17 at position 4
  'OI.UPDATED_AT' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m16:04:02.181004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88e2d7ff-f052-4c57-a472-d8f1857016ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823E8BA490>]}
[0m16:04:02.182013 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model L1_LANDING.fact_orders ................... [[31mERROR[0m in 0.41s]
[0m16:04:02.184019 [debug] [Thread-1  ]: Finished running node model.snow_dbt.fact_orders
[0m16:04:02.185017 [debug] [Thread-7  ]: Marking all children of 'model.snow_dbt.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  001104 (42601): SQL compilation error: error line 17 at position 4
  'OI.UPDATED_AT' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql.
[0m16:04:02.187057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:02.187057 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:04:02.188055 [debug] [MainThread]: On list_finance_db: Close
[0m16:04:02.289686 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:04:02.290660 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:04:02.377288 [debug] [MainThread]: Connection 'model.snow_dbt.fact_orders' was left open.
[0m16:04:02.378290 [debug] [MainThread]: On model.snow_dbt.fact_orders: Close
[0m16:04:02.479527 [info ] [MainThread]: 
[0m16:04:02.479527 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m16:04:02.480896 [debug] [MainThread]: Command end result
[0m16:04:02.576037 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:04:02.578995 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:04:02.587997 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:04:02.587997 [info ] [MainThread]: 
[0m16:04:02.589040 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:04:02.589993 [info ] [MainThread]: 
[0m16:04:02.590995 [error] [MainThread]: [31mFailure in model fact_orders (models\customer rev\fact_orders.sql)[0m
[0m16:04:02.590995 [error] [MainThread]:   Database Error in model fact_orders (models\customer rev\fact_orders.sql)
  001104 (42601): SQL compilation error: error line 17 at position 4
  'OI.UPDATED_AT' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\fact_orders.sql
[0m16:04:02.592036 [info ] [MainThread]: 
[0m16:04:02.593055 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\customer rev\fact_orders.sql
[0m16:04:02.593995 [info ] [MainThread]: 
[0m16:04:02.594996 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:04:02.595993 [debug] [MainThread]: Command `dbt run` failed at 16:04:02.595993 after 4.25 seconds
[0m16:04:02.597036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823AED1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018239DD9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823EA7DB50>]}
[0m16:04:02.598037 [debug] [MainThread]: Flushing usage events
[0m16:04:03.264336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:50.690572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9A9B12E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9BC5D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9BC5D130>]}


============================== 16:04:50.696087 | 111e177d-0f59-4487-bb74-2d2c7591f7ff ==============================
[0m16:04:50.696087 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:04:50.697042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s fact_orders.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:04:51.414252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '111e177d-0f59-4487-bb74-2d2c7591f7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9C7E17C0>]}
[0m16:04:51.499252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '111e177d-0f59-4487-bb74-2d2c7591f7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9B3B57F0>]}
[0m16:04:51.501144 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:04:51.878878 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:04:52.104884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:52.104884 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\fact_orders.sql
[0m16:04:52.426833 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example.customer_stg
- models.snow_dbt.example
[0m16:04:52.454838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '111e177d-0f59-4487-bb74-2d2c7591f7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9DF27130>]}
[0m16:04:52.582667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:04:52.586681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:04:52.622687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '111e177d-0f59-4487-bb74-2d2c7591f7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9DD02550>]}
[0m16:04:52.622687 [info ] [MainThread]: Found 5 models, 8 sources, 477 macros
[0m16:04:52.623726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '111e177d-0f59-4487-bb74-2d2c7591f7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9DD3C070>]}
[0m16:04:52.625690 [info ] [MainThread]: 
[0m16:04:52.626689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:52.626689 [info ] [MainThread]: 
[0m16:04:52.627689 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:52.630235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:04:52.732248 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:04:52.732248 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:04:52.733248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:53.298543 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.565 seconds
[0m16:04:53.320315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:04:53.339305 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:04:53.340305 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:04:53.340305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:53.774235 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.434 seconds
[0m16:04:53.781243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '111e177d-0f59-4487-bb74-2d2c7591f7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9DEFB8E0>]}
[0m16:04:53.788237 [debug] [Thread-1  ]: Began running node model.snow_dbt.fact_orders
[0m16:04:53.790235 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.fact_orders ............................ [RUN]
[0m16:04:53.791235 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.fact_orders'
[0m16:04:53.792235 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.fact_orders
[0m16:04:53.806239 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.fact_orders"
[0m16:04:53.808239 [debug] [Thread-1  ]: Began executing node model.snow_dbt.fact_orders
[0m16:04:53.865243 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.fact_orders"
[0m16:04:53.869235 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.fact_orders"
[0m16:04:53.870238 [debug] [Thread-1  ]: On model.snow_dbt.fact_orders: create or replace transient table finance_db.L1_LANDING.fact_orders
    
    
    
    as ( 
 
 select 
    oi.order_id,
    oi.order_date,
    oi.customer_id,
    oi.employee_id,
    oi.store_id,
    oi.status,
    oi.order_status,
    count(distinct oi.order_id) as order_count,
    sum(d.total_price) as Revenue,
    oi.updated_at
 from finance_db.L1_LANDING.order_stg oi
 left join finance_db.L1_LANDING.order_item_stg d 
 on oi.order_id = d.order_id
 group by 
    oi.order_id,
    oi.order_date,
    oi.customer_id,
    oi.employee_id,
    oi.store_id,
    oi.status,
    oi.order_status,
    oi.updated_at
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fact_orders"} */;
[0m16:04:53.871237 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:04:55.814228 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.943 seconds
[0m16:04:55.846636 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '111e177d-0f59-4487-bb74-2d2c7591f7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9C7C0D90>]}
[0m16:04:55.847644 [info ] [Thread-1  ]: 1 of 1 OK created sql table model L1_LANDING.fact_orders ....................... [[32mSUCCESS 1[0m in 2.05s]
[0m16:04:55.848500 [debug] [Thread-1  ]: Finished running node model.snow_dbt.fact_orders
[0m16:04:55.850509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:55.850509 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:04:55.851555 [debug] [MainThread]: On list_finance_db: Close
[0m16:04:55.927693 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:04:55.927693 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:04:56.019955 [debug] [MainThread]: Connection 'model.snow_dbt.fact_orders' was left open.
[0m16:04:56.020957 [debug] [MainThread]: On model.snow_dbt.fact_orders: Close
[0m16:04:56.108658 [info ] [MainThread]: 
[0m16:04:56.110861 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m16:04:56.114948 [debug] [MainThread]: Command end result
[0m16:04:56.221920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:04:56.224918 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:04:56.233869 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:04:56.233869 [info ] [MainThread]: 
[0m16:04:56.235242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:56.235938 [info ] [MainThread]: 
[0m16:04:56.236951 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:04:56.237946 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:56.237946 after 5.66 seconds
[0m16:04:56.238980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9A9B12E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9DD02340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9AD24190>]}
[0m16:04:56.238980 [debug] [MainThread]: Flushing usage events
[0m16:04:56.960961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:00.999962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C13731250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C149DD340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C149DD0D0>]}


============================== 16:16:01.004931 | cca47eb6-b398-4cd3-9bb6-cccb4bd44f16 ==============================
[0m16:16:01.004931 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:16:01.005931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s customer_rev.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:16:01.769056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cca47eb6-b398-4cd3-9bb6-cccb4bd44f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C1563C790>]}
[0m16:16:01.854096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cca47eb6-b398-4cd3-9bb6-cccb4bd44f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C14992220>]}
[0m16:16:01.856080 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:16:02.228092 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:16:02.464089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:16:02.465132 [debug] [MainThread]: Partial parsing: added file: snow_dbt://models\customer rev\customer_rev.sql
[0m16:16:02.810094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example.customer_stg
- models.snow_dbt.example
[0m16:16:02.832793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cca47eb6-b398-4cd3-9bb6-cccb4bd44f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C16C96130>]}
[0m16:16:02.948791 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:16:02.950786 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:16:02.987920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cca47eb6-b398-4cd3-9bb6-cccb4bd44f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C16C53670>]}
[0m16:16:02.987920 [info ] [MainThread]: Found 6 models, 8 sources, 477 macros
[0m16:16:02.988964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca47eb6-b398-4cd3-9bb6-cccb4bd44f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C16CD6220>]}
[0m16:16:02.990923 [info ] [MainThread]: 
[0m16:16:02.991922 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:16:02.992960 [info ] [MainThread]: 
[0m16:16:02.993920 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:16:02.995919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:16:03.089942 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:16:03.090940 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:16:03.090940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:04.092019 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.000 seconds
[0m16:16:04.116226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:16:04.140237 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:16:04.141234 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:16:04.142242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:04.626678 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.484 seconds
[0m16:16:04.634674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca47eb6-b398-4cd3-9bb6-cccb4bd44f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C168D40A0>]}
[0m16:16:04.641914 [debug] [Thread-1  ]: Began running node model.snow_dbt.customer_rev
[0m16:16:04.642957 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.customer_rev ........................... [RUN]
[0m16:16:04.643914 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.customer_rev'
[0m16:16:04.644912 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.customer_rev
[0m16:16:04.654950 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.customer_rev"
[0m16:16:04.657915 [debug] [Thread-1  ]: Began executing node model.snow_dbt.customer_rev
[0m16:16:04.701957 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.customer_rev"
[0m16:16:04.703914 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.customer_rev"
[0m16:16:04.704959 [debug] [Thread-1  ]: On model.snow_dbt.customer_rev: create or replace transient table finance_db.L1_LANDING.customer_rev
    
    
    
    as (
select 
c.customer_id
c.full_name,
sum(o.order_count) as total_order_count,
sum(o.Revenue) as total_revenue
from finance_db.L1_LANDING.fact_orders o 
left join finance_db.L1_LANDING.customer_stg c
on o.customer_id = c.customer_id
group by 
c.customer_id,
c.full_name
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_rev"} */;
[0m16:16:04.704959 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:16:04.975890 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bdfd7c-0000-a3ba-0000-a1790004210e
[0m16:16:04.976933 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 1 unexpected '.'.
syntax error line 13 at position 3 unexpected 'o'.
[0m16:16:04.980931 [debug] [Thread-1  ]: Database Error in model customer_rev (models\customer rev\customer_rev.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 1 unexpected '.'.
  syntax error line 13 at position 3 unexpected 'o'.
  compiled code at target\run\snow_dbt\models\customer rev\customer_rev.sql
[0m16:16:04.984693 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cca47eb6-b398-4cd3-9bb6-cccb4bd44f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C1553B100>]}
[0m16:16:04.985703 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model L1_LANDING.customer_rev .................. [[31mERROR[0m in 0.34s]
[0m16:16:04.986835 [debug] [Thread-1  ]: Finished running node model.snow_dbt.customer_rev
[0m16:16:04.987892 [debug] [Thread-7  ]: Marking all children of 'model.snow_dbt.customer_rev' to be skipped because of status 'error'.  Reason: Database Error in model customer_rev (models\customer rev\customer_rev.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 1 unexpected '.'.
  syntax error line 13 at position 3 unexpected 'o'.
  compiled code at target\run\snow_dbt\models\customer rev\customer_rev.sql.
[0m16:16:04.990843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:04.990843 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:16:04.991842 [debug] [MainThread]: On list_finance_db: Close
[0m16:16:05.073983 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:16:05.075030 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:16:05.158628 [debug] [MainThread]: Connection 'model.snow_dbt.customer_rev' was left open.
[0m16:16:05.160629 [debug] [MainThread]: On model.snow_dbt.customer_rev: Close
[0m16:16:05.260734 [info ] [MainThread]: 
[0m16:16:05.261742 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m16:16:05.263752 [debug] [MainThread]: Command end result
[0m16:16:05.357753 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:16:05.360760 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:16:05.369751 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:16:05.370704 [info ] [MainThread]: 
[0m16:16:05.371706 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:16:05.371706 [info ] [MainThread]: 
[0m16:16:05.372703 [error] [MainThread]: [31mFailure in model customer_rev (models\customer rev\customer_rev.sql)[0m
[0m16:16:05.373723 [error] [MainThread]:   Database Error in model customer_rev (models\customer rev\customer_rev.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 1 unexpected '.'.
  syntax error line 13 at position 3 unexpected 'o'.
  compiled code at target\run\snow_dbt\models\customer rev\customer_rev.sql
[0m16:16:05.374732 [info ] [MainThread]: 
[0m16:16:05.375730 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\customer rev\customer_rev.sql
[0m16:16:05.376135 [info ] [MainThread]: 
[0m16:16:05.377157 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:16:05.378144 [debug] [MainThread]: Command `dbt run` failed at 16:16:05.378144 after 4.49 seconds
[0m16:16:05.379187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C13731250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C17339A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C173396D0>]}
[0m16:16:05.379187 [debug] [MainThread]: Flushing usage events
[0m16:16:06.072851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:34.686469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188FA112B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021890CBD370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021890CBD100>]}


============================== 16:17:34.690468 | 0848c426-c546-48d1-b613-2cccab17124c ==============================
[0m16:17:34.690468 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:17:34.691476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s customer_rev.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:17:35.405679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0848c426-c546-48d1-b613-2cccab17124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188CE45100>]}
[0m16:17:35.488674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0848c426-c546-48d1-b613-2cccab17124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021890C729D0>]}
[0m16:17:35.490632 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:17:35.850674 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:17:36.075683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:17:36.076680 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\customer_rev.sql
[0m16:17:36.439549 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example.customer_stg
- models.snow_dbt.example
[0m16:17:36.464599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0848c426-c546-48d1-b613-2cccab17124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021892FA7EE0>]}
[0m16:17:36.578553 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:17:36.581556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:17:36.615326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0848c426-c546-48d1-b613-2cccab17124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021892FA0220>]}
[0m16:17:36.616326 [info ] [MainThread]: Found 6 models, 8 sources, 477 macros
[0m16:17:36.617323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0848c426-c546-48d1-b613-2cccab17124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021892F69F10>]}
[0m16:17:36.619368 [info ] [MainThread]: 
[0m16:17:36.619933 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:17:36.620941 [info ] [MainThread]: 
[0m16:17:36.620941 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:17:36.623945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:17:36.717671 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:17:36.717671 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:17:36.718671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:37.515643 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.797 seconds
[0m16:17:37.528596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:17:37.547602 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:17:37.548602 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:17:37.548602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:37.872665 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.324 seconds
[0m16:17:37.880656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0848c426-c546-48d1-b613-2cccab17124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021892E16C10>]}
[0m16:17:37.887657 [debug] [Thread-1  ]: Began running node model.snow_dbt.customer_rev
[0m16:17:37.889661 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.customer_rev ........................... [RUN]
[0m16:17:37.890660 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.customer_rev'
[0m16:17:37.890660 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.customer_rev
[0m16:17:37.902659 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.customer_rev"
[0m16:17:37.904661 [debug] [Thread-1  ]: Began executing node model.snow_dbt.customer_rev
[0m16:17:37.953656 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.customer_rev"
[0m16:17:37.954658 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.customer_rev"
[0m16:17:37.955661 [debug] [Thread-1  ]: On model.snow_dbt.customer_rev: create or replace transient table finance_db.L1_LANDING.customer_rev
    
    
    
    as (
select 
o.customer_id,
c.full_name,
sum(o.order_count) as total_order_count,
sum(o.Revenue) as total_revenue
from finance_db.L1_LANDING.fact_orders o 
left join finance_db.L1_LANDING.customer_stg c
on o.customer_id = c.customer_id
group by 
o.customer_id,
c.full_name
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_rev"} */;
[0m16:17:37.956657 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:17:40.419560 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.464 seconds
[0m16:17:40.460550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0848c426-c546-48d1-b613-2cccab17124c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189186AE80>]}
[0m16:17:40.461559 [info ] [Thread-1  ]: 1 of 1 OK created sql table model L1_LANDING.customer_rev ...................... [[32mSUCCESS 1[0m in 2.57s]
[0m16:17:40.462164 [debug] [Thread-1  ]: Finished running node model.snow_dbt.customer_rev
[0m16:17:40.464173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:40.465177 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:17:40.465177 [debug] [MainThread]: On list_finance_db: Close
[0m16:17:40.557488 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:17:40.558486 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:17:40.644026 [debug] [MainThread]: Connection 'model.snow_dbt.customer_rev' was left open.
[0m16:17:40.647018 [debug] [MainThread]: On model.snow_dbt.customer_rev: Close
[0m16:17:40.736801 [info ] [MainThread]: 
[0m16:17:40.738748 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m16:17:40.741745 [debug] [MainThread]: Command end result
[0m16:17:40.848736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:17:40.851742 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:17:40.859783 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:17:40.860737 [info ] [MainThread]: 
[0m16:17:40.861537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:40.861537 [info ] [MainThread]: 
[0m16:17:40.862588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:17:40.863585 [debug] [MainThread]: Command `dbt run` succeeded at 16:17:40.863585 after 6.28 seconds
[0m16:17:40.864590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188FA112B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021892E48E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021892E48CD0>]}
[0m16:17:40.864590 [debug] [MainThread]: Flushing usage events
[0m16:17:41.563625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:10.833228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022379DC2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237C03D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237C03D0A0>]}


============================== 16:19:10.837215 | 07c97328-e825-4d40-8ec3-10bc7a5f2cb8 ==============================
[0m16:19:10.837215 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:19:10.838216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s customer_rev.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:19:11.610420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07c97328-e825-4d40-8ec3-10bc7a5f2cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223781AF760>]}
[0m16:19:11.696357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07c97328-e825-4d40-8ec3-10bc7a5f2cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237CBCF8B0>]}
[0m16:19:11.698364 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:19:12.061361 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:19:12.289655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:19:12.289655 [debug] [MainThread]: Partial parsing: updated file: snow_dbt://models\customer rev\customer_rev.sql
[0m16:19:12.615610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example.customer_stg
- models.snow_dbt.example
[0m16:19:12.637607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07c97328-e825-4d40-8ec3-10bc7a5f2cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237E2F6130>]}
[0m16:19:12.757034 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:19:12.760031 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:19:12.793042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07c97328-e825-4d40-8ec3-10bc7a5f2cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237E2F68B0>]}
[0m16:19:12.794042 [info ] [MainThread]: Found 6 models, 8 sources, 477 macros
[0m16:19:12.794042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c97328-e825-4d40-8ec3-10bc7a5f2cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237E15F0D0>]}
[0m16:19:12.796567 [info ] [MainThread]: 
[0m16:19:12.797110 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:19:12.798120 [info ] [MainThread]: 
[0m16:19:12.799167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:19:12.800225 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:19:12.894976 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:19:12.895976 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:19:12.895976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:13.393495 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.497 seconds
[0m16:19:13.405522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:19:13.424550 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:19:13.424550 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:19:13.425543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:13.840115 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.415 seconds
[0m16:19:13.846084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c97328-e825-4d40-8ec3-10bc7a5f2cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002237CCEFF70>]}
[0m16:19:13.852361 [debug] [Thread-1  ]: Began running node model.snow_dbt.customer_rev
[0m16:19:13.853359 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.customer_rev ........................... [RUN]
[0m16:19:13.854361 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.customer_rev'
[0m16:19:13.855396 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.customer_rev
[0m16:19:13.865413 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.customer_rev"
[0m16:19:13.867362 [debug] [Thread-1  ]: Began executing node model.snow_dbt.customer_rev
[0m16:19:13.908409 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.customer_rev"
[0m16:19:13.910410 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.customer_rev"
[0m16:19:13.910410 [debug] [Thread-1  ]: On model.snow_dbt.customer_rev: create or replace transient table finance_db.L1_LANDING.customer_rev
    
    
    
    as (
select 
o.customer_id,
c.full_name,
sum(o.order_count) as total_order_count,
sum(o.Revenue) as total_revenue,
o.Revenue,
o.order_count
from finance_db.L1_LANDING.fact_orders o 
left join finance_db.L1_LANDING.customer_stg c
on o.customer_id = c.customer_id
group by 
o.customer_id,
c.full_name
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_rev"} */;
[0m16:19:13.911405 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:19:14.256284 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bdfd7f-0000-a3ba-0000-a17900042132
[0m16:19:14.257272 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 11 at position 0
'O.REVENUE' in select clause is neither an aggregate nor in the group by clause.
[0m16:19:14.259272 [debug] [Thread-1  ]: Database Error in model customer_rev (models\customer rev\customer_rev.sql)
  001104 (42601): SQL compilation error: error line 11 at position 0
  'O.REVENUE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\customer_rev.sql
[0m16:19:14.262481 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07c97328-e825-4d40-8ec3-10bc7a5f2cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022378297850>]}
[0m16:19:14.263489 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model L1_LANDING.customer_rev .................. [[31mERROR[0m in 0.41s]
[0m16:19:14.264494 [debug] [Thread-1  ]: Finished running node model.snow_dbt.customer_rev
[0m16:19:14.265538 [debug] [Thread-7  ]: Marking all children of 'model.snow_dbt.customer_rev' to be skipped because of status 'error'.  Reason: Database Error in model customer_rev (models\customer rev\customer_rev.sql)
  001104 (42601): SQL compilation error: error line 11 at position 0
  'O.REVENUE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\customer_rev.sql.
[0m16:19:14.267532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:14.267532 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:19:14.268535 [debug] [MainThread]: On list_finance_db: Close
[0m16:19:14.362077 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:19:14.363078 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:19:14.449359 [debug] [MainThread]: Connection 'model.snow_dbt.customer_rev' was left open.
[0m16:19:14.449359 [debug] [MainThread]: On model.snow_dbt.customer_rev: Close
[0m16:19:14.553651 [info ] [MainThread]: 
[0m16:19:14.555642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m16:19:14.557645 [debug] [MainThread]: Command end result
[0m16:19:14.657636 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:19:14.660639 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:19:14.669636 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:19:14.669636 [info ] [MainThread]: 
[0m16:19:14.670637 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:19:14.671587 [info ] [MainThread]: 
[0m16:19:14.672653 [error] [MainThread]: [31mFailure in model customer_rev (models\customer rev\customer_rev.sql)[0m
[0m16:19:14.672653 [error] [MainThread]:   Database Error in model customer_rev (models\customer rev\customer_rev.sql)
  001104 (42601): SQL compilation error: error line 11 at position 0
  'O.REVENUE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\customer_rev.sql
[0m16:19:14.673638 [info ] [MainThread]: 
[0m16:19:14.674595 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\customer rev\customer_rev.sql
[0m16:19:14.674595 [info ] [MainThread]: 
[0m16:19:14.675595 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:19:14.676640 [debug] [MainThread]: Command `dbt run` failed at 16:19:14.676640 after 3.96 seconds
[0m16:19:14.677638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022379DC2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223797A28E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223781AF880>]}
[0m16:19:14.677638 [debug] [MainThread]: Flushing usage events
[0m16:19:15.352266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:08.304368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211491722E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114A41D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114A41D220>]}


============================== 16:22:08.309368 | c0ffe75f-48e0-409a-a574-033305767694 ==============================
[0m16:22:08.309368 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:22:08.309368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s customer_rev.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:22:09.031228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0ffe75f-48e0-409a-a574-033305767694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211465A1820>]}
[0m16:22:09.112226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0ffe75f-48e0-409a-a574-033305767694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114A45A220>]}
[0m16:22:09.114579 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:22:09.496450 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:22:09.725133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:22:09.726132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:22:09.734132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.example
- models.snow_dbt.example.customer_stg
[0m16:22:09.784088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0ffe75f-48e0-409a-a574-033305767694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114C533130>]}
[0m16:22:09.902088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:22:09.905089 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:22:09.940118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0ffe75f-48e0-409a-a574-033305767694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114C555550>]}
[0m16:22:09.940118 [info ] [MainThread]: Found 6 models, 8 sources, 477 macros
[0m16:22:09.941451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ffe75f-48e0-409a-a574-033305767694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114C558490>]}
[0m16:22:09.943462 [info ] [MainThread]: 
[0m16:22:09.944459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:22:09.945459 [info ] [MainThread]: 
[0m16:22:09.946459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:22:09.948458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:22:10.043793 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:22:10.044792 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:22:10.044792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:10.801955 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.757 seconds
[0m16:22:10.816034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:22:10.834041 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:22:10.835042 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:22:10.835042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:11.099870 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.264 seconds
[0m16:22:11.108868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ffe75f-48e0-409a-a574-033305767694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114C567160>]}
[0m16:22:11.115873 [debug] [Thread-1  ]: Began running node model.snow_dbt.customer_rev
[0m16:22:11.116869 [info ] [Thread-1  ]: 1 of 1 START sql table model L1_LANDING.customer_rev ........................... [RUN]
[0m16:22:11.118869 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.customer_rev'
[0m16:22:11.119870 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.customer_rev
[0m16:22:11.137872 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.customer_rev"
[0m16:22:11.139876 [debug] [Thread-1  ]: Began executing node model.snow_dbt.customer_rev
[0m16:22:11.196871 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.customer_rev"
[0m16:22:11.198871 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.customer_rev"
[0m16:22:11.200870 [debug] [Thread-1  ]: On model.snow_dbt.customer_rev: create or replace transient table finance_db.L1_LANDING.customer_rev
    
    
    
    as (
select 
o.customer_id,
c.full_name,
sum(o.order_count) as total_order_count,
sum(o.Revenue) as total_revenue,
o.Revenue,
o.order_count
from finance_db.L1_LANDING.fact_orders o 
left join finance_db.L1_LANDING.customer_stg c
on o.customer_id = c.customer_id
group by 
o.customer_id,
c.full_name
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_rev"} */;
[0m16:22:11.201869 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:22:11.886372 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01bdfd82-0000-a3b5-0000-a1790004132e
[0m16:22:11.888417 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 11 at position 0
'O.REVENUE' in select clause is neither an aggregate nor in the group by clause.
[0m16:22:11.892362 [debug] [Thread-1  ]: Database Error in model customer_rev (models\customer rev\customer_rev.sql)
  001104 (42601): SQL compilation error: error line 11 at position 0
  'O.REVENUE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\customer_rev.sql
[0m16:22:11.897363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0ffe75f-48e0-409a-a574-033305767694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114C309E80>]}
[0m16:22:11.898410 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model L1_LANDING.customer_rev .................. [[31mERROR[0m in 0.77s]
[0m16:22:11.900365 [debug] [Thread-1  ]: Finished running node model.snow_dbt.customer_rev
[0m16:22:11.901362 [debug] [Thread-7  ]: Marking all children of 'model.snow_dbt.customer_rev' to be skipped because of status 'error'.  Reason: Database Error in model customer_rev (models\customer rev\customer_rev.sql)
  001104 (42601): SQL compilation error: error line 11 at position 0
  'O.REVENUE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\customer_rev.sql.
[0m16:22:11.903363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:11.903363 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:22:11.904410 [debug] [MainThread]: On list_finance_db: Close
[0m16:22:11.989297 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:22:11.989297 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:22:12.076693 [debug] [MainThread]: Connection 'model.snow_dbt.customer_rev' was left open.
[0m16:22:12.078700 [debug] [MainThread]: On model.snow_dbt.customer_rev: Close
[0m16:22:12.186714 [info ] [MainThread]: 
[0m16:22:12.187663 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m16:22:12.188662 [debug] [MainThread]: Command end result
[0m16:22:12.222662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:22:12.226663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:22:12.236664 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:22:12.236664 [info ] [MainThread]: 
[0m16:22:12.237666 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:22:12.238674 [info ] [MainThread]: 
[0m16:22:12.238674 [error] [MainThread]: [31mFailure in model customer_rev (models\customer rev\customer_rev.sql)[0m
[0m16:22:12.239675 [error] [MainThread]:   Database Error in model customer_rev (models\customer rev\customer_rev.sql)
  001104 (42601): SQL compilation error: error line 11 at position 0
  'O.REVENUE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\customer rev\customer_rev.sql
[0m16:22:12.240679 [info ] [MainThread]: 
[0m16:22:12.241674 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\customer rev\customer_rev.sql
[0m16:22:12.242674 [info ] [MainThread]: 
[0m16:22:12.243676 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:22:12.244719 [debug] [MainThread]: Command `dbt run` failed at 16:22:12.244719 after 4.05 seconds
[0m16:22:12.245720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211491722E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114A3F6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114949D0A0>]}
[0m16:22:12.246716 [debug] [MainThread]: Flushing usage events
[0m16:22:12.980420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:44.205672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D00F1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D139A370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D139A100>]}


============================== 16:31:44.209859 | 914045b1-daf2-46f2-b4b0-d5316b0dfe15 ==============================
[0m16:31:44.209859 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:31:44.210858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:31:44.934210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202CD4EB2E0>]}
[0m16:31:45.015201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D1377250>]}
[0m16:31:45.017336 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:31:45.393069 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:31:45.525024 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:31:45.526026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202CE42C610>]}
[0m16:31:47.205082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.customer_rev.marts
[0m16:31:47.219085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D13335B0>]}
[0m16:31:47.329077 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:31:47.332085 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:31:47.367048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D36E8F10>]}
[0m16:31:47.368050 [info ] [MainThread]: Found 6 models, 8 sources, 477 macros
[0m16:31:47.369049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D30B2820>]}
[0m16:31:47.371094 [info ] [MainThread]: 
[0m16:31:47.372094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:31:47.372094 [info ] [MainThread]: 
[0m16:31:47.373454 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:31:47.381464 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:31:47.476038 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:31:47.476038 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:31:47.477036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:48.327380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.850 seconds
[0m16:31:48.340245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:31:48.358234 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:31:48.358234 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:31:48.359234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:48.729215 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.371 seconds
[0m16:31:48.742216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D3797490>]}
[0m16:31:48.750215 [debug] [Thread-1  ]: Began running node model.snow_dbt.customer_stg
[0m16:31:48.751216 [debug] [Thread-2  ]: Began running node model.snow_dbt.date_stg
[0m16:31:48.752217 [debug] [Thread-3  ]: Began running node model.snow_dbt.order_item_stg
[0m16:31:48.754216 [debug] [Thread-4  ]: Began running node model.snow_dbt.order_stg
[0m16:31:48.755215 [info ] [Thread-1  ]: 1 of 6 START sql view model L1_LANDING.customer_stg ............................ [RUN]
[0m16:31:48.756218 [info ] [Thread-2  ]: 2 of 6 START sql view model L1_LANDING.date_stg ................................ [RUN]
[0m16:31:48.758214 [info ] [Thread-3  ]: 3 of 6 START sql view model L1_LANDING.order_item_stg .......................... [RUN]
[0m16:31:48.761214 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.snow_dbt.customer_stg'
[0m16:31:48.759216 [info ] [Thread-4  ]: 4 of 6 START sql table model L1_LANDING.order_stg .............................. [RUN]
[0m16:31:48.763216 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.snow_dbt.date_stg'
[0m16:31:48.764217 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.snow_dbt.order_item_stg'
[0m16:31:48.765213 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.customer_stg
[0m16:31:48.767215 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.snow_dbt.order_stg'
[0m16:31:48.768215 [debug] [Thread-2  ]: Began compiling node model.snow_dbt.date_stg
[0m16:31:48.769215 [debug] [Thread-3  ]: Began compiling node model.snow_dbt.order_item_stg
[0m16:31:48.791217 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.customer_stg"
[0m16:31:48.793217 [debug] [Thread-4  ]: Began compiling node model.snow_dbt.order_stg
[0m16:31:48.802218 [debug] [Thread-2  ]: Writing injected SQL for node "model.snow_dbt.date_stg"
[0m16:31:48.811217 [debug] [Thread-3  ]: Writing injected SQL for node "model.snow_dbt.order_item_stg"
[0m16:31:48.823225 [debug] [Thread-4  ]: Writing injected SQL for node "model.snow_dbt.order_stg"
[0m16:31:48.826217 [debug] [Thread-3  ]: Began executing node model.snow_dbt.order_item_stg
[0m16:31:48.849216 [debug] [Thread-1  ]: Began executing node model.snow_dbt.customer_stg
[0m16:31:48.868213 [debug] [Thread-3  ]: Dropping relation "FINANCE_DB"."L1_LANDING"."ORDER_ITEM_STG" because it is of type table
[0m16:31:48.872212 [debug] [Thread-1  ]: Dropping relation "FINANCE_DB"."L1_LANDING"."CUSTOMER_STG" because it is of type table
[0m16:31:48.881214 [debug] [Thread-4  ]: Began executing node model.snow_dbt.order_stg
[0m16:31:48.882215 [debug] [Thread-3  ]: Applying DROP to: "FINANCE_DB"."L1_LANDING"."ORDER_ITEM_STG"
[0m16:31:48.885213 [debug] [Thread-1  ]: Applying DROP to: "FINANCE_DB"."L1_LANDING"."CUSTOMER_STG"
[0m16:31:48.886214 [debug] [Thread-2  ]: Began executing node model.snow_dbt.date_stg
[0m16:31:48.919216 [debug] [Thread-4  ]: Writing runtime sql for node "model.snow_dbt.order_stg"
[0m16:31:48.927217 [debug] [Thread-3  ]: Using snowflake connection "model.snow_dbt.order_item_stg"
[0m16:31:48.929216 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.customer_stg"
[0m16:31:48.933215 [debug] [Thread-2  ]: Dropping relation "FINANCE_DB"."L1_LANDING"."DATE_STG" because it is of type table
[0m16:31:48.934215 [debug] [Thread-3  ]: On model.snow_dbt.order_item_stg: drop table if exists "FINANCE_DB"."L1_LANDING"."ORDER_ITEM_STG" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.order_item_stg"} */
[0m16:31:48.935214 [debug] [Thread-1  ]: On model.snow_dbt.customer_stg: drop table if exists "FINANCE_DB"."L1_LANDING"."CUSTOMER_STG" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_stg"} */
[0m16:31:48.939214 [debug] [Thread-2  ]: Applying DROP to: "FINANCE_DB"."L1_LANDING"."DATE_STG"
[0m16:31:48.939214 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:31:48.940217 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:31:48.942213 [debug] [Thread-2  ]: Using snowflake connection "model.snow_dbt.date_stg"
[0m16:31:48.947214 [debug] [Thread-2  ]: On model.snow_dbt.date_stg: drop table if exists "FINANCE_DB"."L1_LANDING"."DATE_STG" cascade
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.date_stg"} */
[0m16:31:48.949213 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:31:48.952214 [debug] [Thread-4  ]: Using snowflake connection "model.snow_dbt.order_stg"
[0m16:31:48.955214 [debug] [Thread-4  ]: On model.snow_dbt.order_stg: create or replace transient table finance_db.L1_LANDING.order_stg
    
    
    
    as (
select 
	ORDERID as order_id,
	ORDERDATE as order_date,
	CUSTOMERID as customer_id,
	EMPLOYEEID as employee_id,
	STOREID as store_id,
	STATUS as status,
    case    
        when STATUS = '01' then 'Complete'
        when STATUS = '02' then 'In Progress'
        when STATUS = '03' then 'Cancelled'
        else null
    end as order_status,
	UPDATED_AT as updated_at
from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.order_stg"} */;
[0m16:31:48.956217 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:31:49.233223 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.293 seconds
[0m16:31:49.254220 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.customer_stg"
[0m16:31:49.261214 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.customer_stg"
[0m16:31:49.261214 [debug] [Thread-1  ]: On model.snow_dbt.customer_stg: create or replace   view finance_db.L1_LANDING.customer_stg
  
  
  
  
  as (
    
select 
	CUSTOMERID as customer_id,
    FIRSTNAME as first_name,
    LASTNAME as last_name,
    concat(FIRSTNAME, ' ', LASTNAME) as full_name,
	EMAIL as email,
	PHONE as phone,
	ADDRESS as address,
	CITY as city,
	STATE as state,
	ZIPCODE as zipcode,
	UPDATED_AT as updated_at
from finance_db.L1_LANDING.CUSTOMERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_stg"} */;
[0m16:31:49.294481 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.345 seconds
[0m16:31:49.296430 [debug] [Thread-2  ]: Writing runtime sql for node "model.snow_dbt.date_stg"
[0m16:31:49.298024 [debug] [Thread-2  ]: Using snowflake connection "model.snow_dbt.date_stg"
[0m16:31:49.299034 [debug] [Thread-2  ]: On model.snow_dbt.date_stg: create or replace   view finance_db.L1_LANDING.date_stg
  
  
  
  
  as (
    

select 
	DATE,
	DAY,
	MONTH,
	YEAR,
	QUARTER,
	DAYOFWEEK,
	WEEKOFYEAR,
	UPDATED_AT 
from finance_db.L1_LANDING.DATES
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.date_stg"} */;
[0m16:31:49.321232 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.382 seconds
[0m16:31:49.323223 [debug] [Thread-3  ]: Writing runtime sql for node "model.snow_dbt.order_item_stg"
[0m16:31:49.325179 [debug] [Thread-3  ]: Using snowflake connection "model.snow_dbt.order_item_stg"
[0m16:31:49.325179 [debug] [Thread-3  ]: On model.snow_dbt.order_item_stg: create or replace   view finance_db.L1_LANDING.order_item_stg
  
  
  
  
  as (
    
 select 
	ORDERID as order_id,
	ORDERITEMID as order_item,
	PRODUCTID as product_id,
	QUANTITY as quantity,
	UNITPRICE as unit_price,
    QUANTITY * UNITPRICE as total_price,
	UPDATED_AT as updated_at
from finance_db.L1_LANDING.ORDERITEMS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.order_item_stg"} */;
[0m16:31:49.439952 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.139 seconds
[0m16:31:49.476919 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.150 seconds
[0m16:31:49.494873 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D3C96AF0>]}
[0m16:31:49.496322 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D3F156A0>]}
[0m16:31:49.495874 [info ] [Thread-2  ]: 2 of 6 OK created sql view model L1_LANDING.date_stg ........................... [[32mSUCCESS 1[0m in 0.73s]
[0m16:31:49.497908 [debug] [Thread-2  ]: Finished running node model.snow_dbt.date_stg
[0m16:31:49.497328 [info ] [Thread-3  ]: 3 of 6 OK created sql view model L1_LANDING.order_item_stg ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m16:31:49.498805 [debug] [Thread-3  ]: Finished running node model.snow_dbt.order_item_stg
[0m16:31:49.591989 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.330 seconds
[0m16:31:49.596948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D1EFAD60>]}
[0m16:31:49.597987 [info ] [Thread-1  ]: 1 of 6 OK created sql view model L1_LANDING.customer_stg ....................... [[32mSUCCESS 1[0m in 0.84s]
[0m16:31:49.598945 [debug] [Thread-1  ]: Finished running node model.snow_dbt.customer_stg
[0m16:31:51.598316 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.641 seconds
[0m16:31:51.616279 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D3EAC6A0>]}
[0m16:31:51.617278 [info ] [Thread-4  ]: 4 of 6 OK created sql table model L1_LANDING.order_stg ......................... [[32mSUCCESS 1[0m in 2.85s]
[0m16:31:51.619227 [debug] [Thread-4  ]: Finished running node model.snow_dbt.order_stg
[0m16:31:51.621227 [debug] [Thread-2  ]: Began running node model.snow_dbt.fact_orders
[0m16:31:51.622228 [info ] [Thread-2  ]: 5 of 6 START sql table model L1_LANDING.fact_orders ............................ [RUN]
[0m16:31:51.623227 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.snow_dbt.date_stg, now model.snow_dbt.fact_orders)
[0m16:31:51.624275 [debug] [Thread-2  ]: Began compiling node model.snow_dbt.fact_orders
[0m16:31:51.629223 [debug] [Thread-2  ]: Writing injected SQL for node "model.snow_dbt.fact_orders"
[0m16:31:51.637225 [debug] [Thread-2  ]: Began executing node model.snow_dbt.fact_orders
[0m16:31:51.642265 [debug] [Thread-2  ]: Writing runtime sql for node "model.snow_dbt.fact_orders"
[0m16:31:51.645267 [debug] [Thread-2  ]: Using snowflake connection "model.snow_dbt.fact_orders"
[0m16:31:51.645267 [debug] [Thread-2  ]: On model.snow_dbt.fact_orders: create or replace transient table finance_db.L1_LANDING.fact_orders
    
    
    
    as ( 
 
 select 
    oi.order_id,
    oi.order_date,
    oi.customer_id,
    oi.employee_id,
    oi.store_id,
    oi.status,
    oi.order_status,
    count(distinct oi.order_id) as order_count,
    sum(d.total_price) as Revenue,
    oi.updated_at
 from finance_db.L1_LANDING.order_stg oi
 left join finance_db.L1_LANDING.order_item_stg d 
 on oi.order_id = d.order_id
 group by 
    oi.order_id,
    oi.order_date,
    oi.customer_id,
    oi.employee_id,
    oi.store_id,
    oi.status,
    oi.order_status,
    oi.updated_at
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fact_orders"} */;
[0m16:31:53.973329 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.326 seconds
[0m16:31:53.987329 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D3F7CD00>]}
[0m16:31:53.990329 [info ] [Thread-2  ]: 5 of 6 OK created sql table model L1_LANDING.fact_orders ....................... [[32mSUCCESS 1[0m in 2.36s]
[0m16:31:53.994318 [debug] [Thread-2  ]: Finished running node model.snow_dbt.fact_orders
[0m16:31:53.996318 [debug] [Thread-1  ]: Began running node model.snow_dbt.customer_rev
[0m16:31:53.998360 [info ] [Thread-1  ]: 6 of 6 START sql table model L1_LANDING.customer_rev ........................... [RUN]
[0m16:31:53.999323 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.snow_dbt.customer_stg, now model.snow_dbt.customer_rev)
[0m16:31:54.000360 [debug] [Thread-1  ]: Began compiling node model.snow_dbt.customer_rev
[0m16:31:54.008356 [debug] [Thread-1  ]: Writing injected SQL for node "model.snow_dbt.customer_rev"
[0m16:31:54.009352 [debug] [Thread-1  ]: Began executing node model.snow_dbt.customer_rev
[0m16:31:54.016353 [debug] [Thread-1  ]: Writing runtime sql for node "model.snow_dbt.customer_rev"
[0m16:31:54.024438 [debug] [Thread-1  ]: Using snowflake connection "model.snow_dbt.customer_rev"
[0m16:31:54.025396 [debug] [Thread-1  ]: On model.snow_dbt.customer_rev: create or replace transient table finance_db.L1_LANDING.customer_rev
    
    
    
    as (

select 
o.customer_id,
c.full_name,
sum(o.order_count) as total_order_count,
sum(o.Revenue) as total_revenue
from finance_db.L1_LANDING.fact_orders o
left join finance_db.L1_LANDING.customer_stg c
on o.customer_id = c.customer_id
group by 
o.customer_id,
c.full_name
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_rev"} */;
[0m16:31:55.245111 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.219 seconds
[0m16:31:55.249065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914045b1-daf2-46f2-b4b0-d5316b0dfe15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D3F02280>]}
[0m16:31:55.250067 [info ] [Thread-1  ]: 6 of 6 OK created sql table model L1_LANDING.customer_rev ...................... [[32mSUCCESS 1[0m in 1.25s]
[0m16:31:55.251023 [debug] [Thread-1  ]: Finished running node model.snow_dbt.customer_rev
[0m16:31:55.253054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:55.253054 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:31:55.254101 [debug] [MainThread]: On list_finance_db: Close
[0m16:31:55.328250 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:31:55.329210 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:31:55.409280 [debug] [MainThread]: Connection 'model.snow_dbt.customer_rev' was left open.
[0m16:31:55.411285 [debug] [MainThread]: On model.snow_dbt.customer_rev: Close
[0m16:31:55.495164 [debug] [MainThread]: Connection 'model.snow_dbt.fact_orders' was left open.
[0m16:31:55.498097 [debug] [MainThread]: On model.snow_dbt.fact_orders: Close
[0m16:31:55.577490 [debug] [MainThread]: Connection 'model.snow_dbt.order_item_stg' was left open.
[0m16:31:55.579440 [debug] [MainThread]: On model.snow_dbt.order_item_stg: Close
[0m16:31:55.658087 [debug] [MainThread]: Connection 'model.snow_dbt.order_stg' was left open.
[0m16:31:55.659094 [debug] [MainThread]: On model.snow_dbt.order_stg: Close
[0m16:31:55.753292 [info ] [MainThread]: 
[0m16:31:55.754290 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m16:31:55.758881 [debug] [MainThread]: Command end result
[0m16:31:55.791918 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:31:55.794920 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:31:55.804875 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:31:55.804875 [info ] [MainThread]: 
[0m16:31:55.805916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:55.806875 [info ] [MainThread]: 
[0m16:31:55.806875 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:31:55.808919 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:55.807875 after 11.71 seconds
[0m16:31:55.808919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D00F1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D13400A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D3608E80>]}
[0m16:31:55.809922 [debug] [MainThread]: Flushing usage events
[0m16:31:56.697042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:33.872091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04FC8FE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B050FF3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B051DC2410>]}


============================== 17:12:33.881338 | 1bf23763-a49f-4454-bbdc-b9f3ff97e467 ==============================
[0m17:12:33.881338 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:12:33.883115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:12:34.159268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bf23763-a49f-4454-bbdc-b9f3ff97e467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B051D990C0>]}
[0m17:12:34.191409 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:12:34.193375 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:12:34.195408 [debug] [MainThread]: Command `cli deps` succeeded at 17:12:34.195408 after 0.44 seconds
[0m17:12:34.196406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04FC8FE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B051EF7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B051DC6650>]}
[0m17:12:34.197371 [debug] [MainThread]: Flushing usage events
[0m17:12:35.044199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:56.379655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484C3D22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484D67AF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484D67A1F0>]}


============================== 17:12:56.385484 | eafc7d00-6a6b-4437-a5d5-e4512049a838 ==============================
[0m17:12:56.385484 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:12:56.386484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:12:56.424452 [info ] [MainThread]: dbt version: 1.10.5
[0m17:12:56.425457 [info ] [MainThread]: python version: 3.9.6
[0m17:12:56.426424 [info ] [MainThread]: python path: c:\users\alawa\snow\dbt_env\scripts\python.exe
[0m17:12:56.426424 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:12:56.431418 [info ] [MainThread]: Using profiles dir at C:\Users\alawa\.dbt
[0m17:12:56.432420 [info ] [MainThread]: Using profiles.yml file at C:\Users\alawa\.dbt\profiles.yml
[0m17:12:56.433419 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alawa\snow\snow_dbt\dbt_project.yml
[0m17:12:56.584467 [info ] [MainThread]: Configuration:
[0m17:12:56.585468 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m17:12:56.586468 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:12:56.586468 [info ] [MainThread]: Required dependencies:
[0m17:12:56.587467 [debug] [MainThread]: Executing "git --help"
[0m17:12:56.671631 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:12:56.672677 [debug] [MainThread]: STDERR: "b''"
[0m17:12:56.673678 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:12:56.674628 [info ] [MainThread]: Connection test skipped since no profile was found
[0m17:12:56.674628 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:12:56.675675 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Profile snow_dbt in profiles.yml is empty
  


[0m17:12:56.677630 [debug] [MainThread]: Command `dbt debug` failed at 17:12:56.677630 after 0.44 seconds
[0m17:12:56.678675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484C3D22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484D6269D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002484D67A190>]}
[0m17:12:56.679681 [debug] [MainThread]: Flushing usage events
[0m17:12:57.442954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:01.075015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3B874FE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3B9AB3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3BA882410>]}


============================== 17:15:01.082034 | 91540d7b-adc3-455f-9961-76e7cb41974c ==============================
[0m17:15:01.082034 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:15:01.083066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:01.289019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91540d7b-adc3-455f-9961-76e7cb41974c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3BA85D0C0>]}
[0m17:15:01.317828 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:15:01.319832 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:15:01.321836 [debug] [MainThread]: Command `cli deps` succeeded at 17:15:01.321836 after 0.36 seconds
[0m17:15:01.322835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3B874FE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3BA9B7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3BA886650>]}
[0m17:15:01.322835 [debug] [MainThread]: Flushing usage events
[0m17:15:02.048387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:10.721383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81BBC22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81CE6A3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81CE6A160>]}


============================== 17:15:10.727397 | b4a0dba8-40d3-49e9-b389-dfb6533d8ce0 ==============================
[0m17:15:10.727397 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:15:10.728391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:10.755667 [info ] [MainThread]: dbt version: 1.10.5
[0m17:15:10.755667 [info ] [MainThread]: python version: 3.9.6
[0m17:15:10.756633 [info ] [MainThread]: python path: c:\users\alawa\snow\dbt_env\scripts\python.exe
[0m17:15:10.757631 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:15:10.762636 [info ] [MainThread]: Using profiles dir at C:\Users\alawa\.dbt
[0m17:15:10.763640 [info ] [MainThread]: Using profiles.yml file at C:\Users\alawa\.dbt\profiles.yml
[0m17:15:10.764635 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alawa\snow\snow_dbt\dbt_project.yml
[0m17:15:10.916146 [info ] [MainThread]: Configuration:
[0m17:15:10.917147 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m17:15:10.918146 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:15:10.918742 [info ] [MainThread]: Required dependencies:
[0m17:15:10.919418 [debug] [MainThread]: Executing "git --help"
[0m17:15:10.987469 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:15:10.988468 [debug] [MainThread]: STDERR: "b''"
[0m17:15:10.989468 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:15:10.989468 [info ] [MainThread]: Connection test skipped since no profile was found
[0m17:15:10.990484 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:15:10.991434 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Profile snow_dbt in profiles.yml is empty
  


[0m17:15:10.993434 [debug] [MainThread]: Command `dbt debug` failed at 17:15:10.993434 after 0.39 seconds
[0m17:15:10.994427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81BBC22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81CE6A1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D81CF11220>]}
[0m17:15:10.995429 [debug] [MainThread]: Flushing usage events
[0m17:15:11.674052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:57.335597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB2232310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB44AA3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB44AA160>]}


============================== 17:19:57.340219 | 1e771a71-5f46-43f6-9af3-343b5b9caa8a ==============================
[0m17:19:57.340219 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:19:57.341543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:19:57.373930 [info ] [MainThread]: dbt version: 1.10.5
[0m17:19:57.374929 [info ] [MainThread]: python version: 3.9.6
[0m17:19:57.375934 [info ] [MainThread]: python path: c:\users\alawa\snow\dbt_env\scripts\python.exe
[0m17:19:57.376930 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:19:57.381450 [info ] [MainThread]: Using profiles dir at C:\Users\alawa\.dbt
[0m17:19:57.382569 [info ] [MainThread]: Using profiles.yml file at C:\Users\alawa\.dbt\profiles.yml
[0m17:19:57.383583 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alawa\snow\snow_dbt\dbt_project.yml
[0m17:19:57.531621 [info ] [MainThread]: Configuration:
[0m17:19:57.532559 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m17:19:57.532559 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:19:57.533562 [info ] [MainThread]: Required dependencies:
[0m17:19:57.534560 [debug] [MainThread]: Executing "git --help"
[0m17:19:57.598569 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:19:57.598569 [debug] [MainThread]: STDERR: "b''"
[0m17:19:57.599568 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:19:57.600569 [info ] [MainThread]: Connection test skipped since no profile was found
[0m17:19:57.601160 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:19:57.601160 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Profile snow_dbt in profiles.yml is empty
  


[0m17:19:57.603168 [debug] [MainThread]: Command `dbt debug` failed at 17:19:57.603168 after 0.38 seconds
[0m17:19:57.603168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB2232310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB452FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EB35CCA00>]}
[0m17:19:57.604211 [debug] [MainThread]: Flushing usage events
[0m17:19:58.353573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:10.324977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250351412E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250363EA3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250363EA160>]}


============================== 17:20:10.329336 | c7f3156e-c48d-435a-806f-95d020d67220 ==============================
[0m17:20:10.329336 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:20:10.330334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:10.362231 [info ] [MainThread]: dbt version: 1.10.5
[0m17:20:10.363231 [info ] [MainThread]: python version: 3.9.6
[0m17:20:10.364238 [info ] [MainThread]: python path: c:\users\alawa\snow\dbt_env\scripts\python.exe
[0m17:20:10.365229 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:20:10.370226 [info ] [MainThread]: Using profiles dir at C:\Users\alawa\.dbt
[0m17:20:10.370226 [info ] [MainThread]: Using profiles.yml file at C:\Users\alawa\.dbt\profiles.yml
[0m17:20:10.371227 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alawa\snow\snow_dbt\dbt_project.yml
[0m17:20:10.522276 [info ] [MainThread]: Configuration:
[0m17:20:10.523232 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m17:20:10.524229 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:20:10.524229 [info ] [MainThread]: Required dependencies:
[0m17:20:10.525228 [debug] [MainThread]: Executing "git --help"
[0m17:20:10.587114 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:20:10.588113 [debug] [MainThread]: STDERR: "b''"
[0m17:20:10.589115 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:20:10.589115 [info ] [MainThread]: Connection test skipped since no profile was found
[0m17:20:10.590069 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:20:10.591121 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Profile snow_dbt in profiles.yml is empty
  


[0m17:20:10.592073 [debug] [MainThread]: Command `dbt debug` failed at 17:20:10.592073 after 0.38 seconds
[0m17:20:10.593112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250351412E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250363EA1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025036491220>]}
[0m17:20:10.593112 [debug] [MainThread]: Flushing usage events
[0m17:20:11.288454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:57.809946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026182E33EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026184F64DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026184F65B40>]}


============================== 17:22:57.818467 | 6ea79996-48c1-4e15-ac56-e4de844b9bc8 ==============================
[0m17:22:57.818467 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:22:57.820471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:22:57.855466 [info ] [MainThread]: dbt version: 1.9.4
[0m17:22:57.857464 [info ] [MainThread]: python version: 3.10.7
[0m17:22:57.858473 [info ] [MainThread]: python path: C:\Users\alawa\AppData\Local\Programs\Python\Python310\python.exe
[0m17:22:57.859466 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:23:02.959553 [debug] [MainThread]: Traceback (most recent call last):
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m17:23:02.960602 [error] [MainThread]: Encountered an error:
No module named 'dbt.adapters.catalogs'
[0m17:23:03.005556 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 414, in debug
    results = task.run()
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\debug.py", line 205, in _load_profile
    profile: Profile = Profile.render(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m17:23:03.007555 [debug] [MainThread]: Command `dbt debug` failed at 17:23:03.007555 after 5.38 seconds
[0m17:23:03.008553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026182E33EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261848D8AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026195BA0850>]}
[0m17:23:03.009603 [debug] [MainThread]: Flushing usage events
[0m17:23:03.702563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:12.366701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0634FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0768E080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE084824A0>]}


============================== 17:23:12.371661 | cbbe45ec-adc1-4dde-a015-957cd03d02d4 ==============================
[0m17:23:12.371661 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:23:12.372664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'c:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:23:12.578422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbbe45ec-adc1-4dde-a015-957cd03d02d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE076895A0>]}
[0m17:23:12.606432 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:23:12.609428 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:23:12.611434 [debug] [MainThread]: Command `cli deps` succeeded at 17:23:12.610435 after 0.35 seconds
[0m17:23:12.611434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0634FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE085B3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE084876D0>]}
[0m17:23:12.612433 [debug] [MainThread]: Flushing usage events
[0m17:23:13.298952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:19.722714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475C6122B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475E88AF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475E88A220>]}


============================== 17:23:19.727895 | 8a96671b-50e1-4f88-909b-474bbf8161b5 ==============================
[0m17:23:19.727895 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:23:19.728849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:23:19.762469 [info ] [MainThread]: dbt version: 1.10.5
[0m17:23:19.763876 [info ] [MainThread]: python version: 3.9.6
[0m17:23:19.764882 [info ] [MainThread]: python path: c:\users\alawa\snow\dbt_env\scripts\python.exe
[0m17:23:19.764882 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:23:20.679394 [info ] [MainThread]: Using profiles dir at C:\Users\alawa\.dbt
[0m17:23:20.680397 [info ] [MainThread]: Using profiles.yml file at C:\Users\alawa\.dbt\profiles.yml
[0m17:23:20.681352 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alawa\snow\snow_dbt\dbt_project.yml
[0m17:23:20.682617 [info ] [MainThread]: adapter type: snowflake
[0m17:23:20.683628 [info ] [MainThread]: adapter version: 1.10.0
[0m17:23:20.833672 [info ] [MainThread]: Configuration:
[0m17:23:20.834671 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:23:20.835670 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:23:20.836672 [info ] [MainThread]: Required dependencies:
[0m17:23:20.837628 [debug] [MainThread]: Executing "git --help"
[0m17:23:20.905599 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:23:20.905599 [debug] [MainThread]: STDERR: "b''"
[0m17:23:20.906605 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:23:20.907562 [info ] [MainThread]: Connection:
[0m17:23:20.907562 [info ] [MainThread]:   account: ki78787.me-central2.gcp
[0m17:23:20.908560 [info ] [MainThread]:   user: ABBAS1213
[0m17:23:20.909562 [info ] [MainThread]:   database: finance_db
[0m17:23:20.909562 [info ] [MainThread]:   warehouse: finance_wh
[0m17:23:20.910559 [info ] [MainThread]:   role: accountadmin
[0m17:23:20.911559 [info ] [MainThread]:   schema: L1_LANDING
[0m17:23:20.912559 [info ] [MainThread]:   authenticator: None
[0m17:23:20.912559 [info ] [MainThread]:   oauth_client_id: None
[0m17:23:20.913559 [info ] [MainThread]:   query_tag: None
[0m17:23:20.914565 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:23:20.915557 [info ] [MainThread]:   host: None
[0m17:23:20.915557 [info ] [MainThread]:   port: None
[0m17:23:20.916560 [info ] [MainThread]:   proxy_host: None
[0m17:23:20.917594 [info ] [MainThread]:   proxy_port: None
[0m17:23:20.918558 [info ] [MainThread]:   protocol: None
[0m17:23:20.919560 [info ] [MainThread]:   connect_retries: 1
[0m17:23:20.921566 [info ] [MainThread]:   connect_timeout: None
[0m17:23:20.922558 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:23:20.923603 [info ] [MainThread]:   retry_all: False
[0m17:23:20.924563 [info ] [MainThread]:   insecure_mode: False
[0m17:23:20.925559 [info ] [MainThread]:   reuse_connections: True
[0m17:23:20.925559 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m17:23:20.927561 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:23:21.427849 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:23:21.526786 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:23:21.526786 [debug] [MainThread]: On debug: select 1 as id
[0m17:23:21.527787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:22.604404 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.077 seconds
[0m17:23:22.605642 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:23:22.606647 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:23:22.608304 [debug] [MainThread]: Command `dbt debug` succeeded at 17:23:22.607251 after 3.00 seconds
[0m17:23:22.608304 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:23:22.609302 [debug] [MainThread]: On debug: Close
[0m17:23:22.702468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475C6122B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D988280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475F4DBD90>]}
[0m17:23:22.702468 [debug] [MainThread]: Flushing usage events
[0m17:23:23.427327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:57.352702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F16531280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F177DAFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F177DA1C0>]}


============================== 17:29:57.360703 | de8346d3-98ed-4270-b6a9-21d9849c864b ==============================
[0m17:29:57.360703 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:29:57.361709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:29:57.410703 [info ] [MainThread]: dbt version: 1.10.5
[0m17:29:57.411702 [info ] [MainThread]: python version: 3.9.6
[0m17:29:57.412714 [info ] [MainThread]: python path: c:\users\alawa\snow\dbt_env\scripts\python.exe
[0m17:29:57.413701 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:29:58.213535 [info ] [MainThread]: Using profiles dir at C:\Users\alawa\.dbt
[0m17:29:58.214540 [info ] [MainThread]: Using profiles.yml file at C:\Users\alawa\.dbt\profiles.yml
[0m17:29:58.215537 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alawa\snow\snow_dbt\dbt_project.yml
[0m17:29:58.217543 [info ] [MainThread]: adapter type: snowflake
[0m17:29:58.218536 [info ] [MainThread]: adapter version: 1.10.0
[0m17:29:58.409536 [info ] [MainThread]: Configuration:
[0m17:29:58.409536 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:29:58.410539 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:29:58.411537 [info ] [MainThread]: Required dependencies:
[0m17:29:58.412537 [debug] [MainThread]: Executing "git --help"
[0m17:29:58.505536 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:29:58.506534 [debug] [MainThread]: STDERR: "b''"
[0m17:29:58.507537 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:29:58.508536 [info ] [MainThread]: Connection:
[0m17:29:58.508536 [info ] [MainThread]:   account: ki78787.me-central2.gcp
[0m17:29:58.509536 [info ] [MainThread]:   user: ABBAS1213
[0m17:29:58.510535 [info ] [MainThread]:   database: finance_db
[0m17:29:58.511541 [info ] [MainThread]:   warehouse: finance_wh
[0m17:29:58.512536 [info ] [MainThread]:   role: accountadmin
[0m17:29:58.512536 [info ] [MainThread]:   schema: L1_LANDING
[0m17:29:58.513540 [info ] [MainThread]:   authenticator: None
[0m17:29:58.514536 [info ] [MainThread]:   oauth_client_id: None
[0m17:29:58.515537 [info ] [MainThread]:   query_tag: None
[0m17:29:58.516541 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:29:58.517537 [info ] [MainThread]:   host: None
[0m17:29:58.518542 [info ] [MainThread]:   port: None
[0m17:29:58.519537 [info ] [MainThread]:   proxy_host: None
[0m17:29:58.520537 [info ] [MainThread]:   proxy_port: None
[0m17:29:58.521537 [info ] [MainThread]:   protocol: None
[0m17:29:58.522542 [info ] [MainThread]:   connect_retries: 1
[0m17:29:58.523539 [info ] [MainThread]:   connect_timeout: None
[0m17:29:58.524545 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:29:58.526540 [info ] [MainThread]:   retry_all: False
[0m17:29:58.527538 [info ] [MainThread]:   insecure_mode: False
[0m17:29:58.527538 [info ] [MainThread]:   reuse_connections: True
[0m17:29:58.528535 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m17:29:58.529540 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:29:59.041538 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:29:59.176362 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:29:59.176362 [debug] [MainThread]: On debug: select 1 as id
[0m17:29:59.177362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:00.010905 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.833 seconds
[0m17:30:00.012903 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:30:00.013906 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:30:00.015905 [debug] [MainThread]: Command `dbt debug` succeeded at 17:30:00.014906 after 2.83 seconds
[0m17:30:00.015905 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:30:00.016905 [debug] [MainThread]: On debug: Close
[0m17:30:00.104417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F16531280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F178825E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F19947FD0>]}
[0m17:30:00.105418 [debug] [MainThread]: Flushing usage events
[0m17:30:00.762363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:07.424036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E441D716C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E443FD8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E443FD8520>]}


============================== 17:49:07.430045 | 260325d8-1016-47d2-bdef-caf96a898cbb ==============================
[0m17:49:07.430045 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:49:07.434044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:49:07.957039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '260325d8-1016-47d2-bdef-caf96a898cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E443F81ED0>]}
[0m17:49:08.034039 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:49:08.039037 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:49:08.042040 [debug] [MainThread]: Command `cli deps` succeeded at 17:49:08.042040 after 0.78 seconds
[0m17:49:08.044041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E441D716C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E443F805B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E443F80310>]}
[0m17:49:08.046039 [debug] [MainThread]: Flushing usage events
[0m17:49:08.790368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:26.661270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E9156C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3FBA0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3FBA02B0>]}


============================== 18:05:26.665272 | d577dce1-f041-43a0-9c9c-ab7a9e6c8d99 ==============================
[0m18:05:26.665272 [info ] [MainThread]: Running with dbt=1.10.5
[0m18:05:26.666267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:26.686269 [info ] [MainThread]: dbt version: 1.10.5
[0m18:05:26.687267 [info ] [MainThread]: python version: 3.10.7
[0m18:05:26.689273 [info ] [MainThread]: python path: C:\Users\alawa\snow\snow_dbt\.venv\Scripts\python.exe
[0m18:05:26.690270 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m18:05:27.146315 [info ] [MainThread]: Using profiles dir at C:\Users\alawa\.dbt
[0m18:05:27.147318 [info ] [MainThread]: Using profiles.yml file at C:\Users\alawa\.dbt\profiles.yml
[0m18:05:27.148268 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alawa\snow\snow_dbt\dbt_project.yml
[0m18:05:27.149409 [info ] [MainThread]: adapter type: snowflake
[0m18:05:27.150418 [info ] [MainThread]: adapter version: 1.10.0
[0m18:05:27.304459 [info ] [MainThread]: Configuration:
[0m18:05:27.305415 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:05:27.306419 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:05:27.307418 [info ] [MainThread]: Required dependencies:
[0m18:05:27.307418 [debug] [MainThread]: Executing "git --help"
[0m18:05:27.370834 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:05:27.371837 [debug] [MainThread]: STDERR: "b''"
[0m18:05:27.372828 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:05:27.373829 [info ] [MainThread]: Connection:
[0m18:05:27.373829 [info ] [MainThread]:   account: ki78787.me-central2.gcp
[0m18:05:27.374831 [info ] [MainThread]:   user: ABBAS1213
[0m18:05:27.375861 [info ] [MainThread]:   database: finance_db
[0m18:05:27.376827 [info ] [MainThread]:   warehouse: finance_wh
[0m18:05:27.377828 [info ] [MainThread]:   role: accountadmin
[0m18:05:27.378827 [info ] [MainThread]:   schema: L1_LANDING
[0m18:05:27.379832 [info ] [MainThread]:   authenticator: None
[0m18:05:27.380319 [info ] [MainThread]:   oauth_client_id: None
[0m18:05:27.381327 [info ] [MainThread]:   query_tag: None
[0m18:05:27.382329 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:05:27.382329 [info ] [MainThread]:   host: None
[0m18:05:27.383326 [info ] [MainThread]:   port: None
[0m18:05:27.384357 [info ] [MainThread]:   proxy_host: None
[0m18:05:27.386331 [info ] [MainThread]:   proxy_port: None
[0m18:05:27.387342 [info ] [MainThread]:   protocol: None
[0m18:05:27.388325 [info ] [MainThread]:   connect_retries: 1
[0m18:05:27.389326 [info ] [MainThread]:   connect_timeout: None
[0m18:05:27.390328 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:05:27.391325 [info ] [MainThread]:   retry_all: False
[0m18:05:27.393325 [info ] [MainThread]:   insecure_mode: False
[0m18:05:27.394325 [info ] [MainThread]:   reuse_connections: True
[0m18:05:27.395377 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m18:05:27.396317 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:05:27.832090 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:05:30.444826 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:05:30.445826 [debug] [MainThread]: On debug: select 1 as id
[0m18:05:30.446827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:31.334424 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.888 seconds
[0m18:05:31.335425 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:05:31.336424 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:05:31.338426 [debug] [MainThread]: Command `dbt debug` succeeded at 18:05:31.338426 after 4.79 seconds
[0m18:05:31.339426 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:05:31.339426 [debug] [MainThread]: On debug: Close
[0m18:05:31.428431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3E9156C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3FBA0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3EBC8F70>]}
[0m18:05:31.429427 [debug] [MainThread]: Flushing usage events
[0m18:05:32.126587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:50.317694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4695156C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46B77C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46B77C250>]}


============================== 18:33:50.321704 | fefba909-cb75-49ca-af8e-20e3b14d40dc ==============================
[0m18:33:50.321704 [info ] [MainThread]: Running with dbt=1.10.5
[0m18:33:50.324652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s customer_rev.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:33:51.261837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fefba909-cb75-49ca-af8e-20e3b14d40dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D467852E60>]}
[0m18:33:51.348882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fefba909-cb75-49ca-af8e-20e3b14d40dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46AE93010>]}
[0m18:33:51.350839 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:33:51.837113 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m18:33:52.067112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:33:52.068064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:33:52.077108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.customer_rev.marts
[0m18:33:52.130108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fefba909-cb75-49ca-af8e-20e3b14d40dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D804130>]}
[0m18:33:52.252118 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m18:33:52.330246 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m18:33:52.355550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fefba909-cb75-49ca-af8e-20e3b14d40dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D7B9B10>]}
[0m18:33:52.357550 [info ] [MainThread]: Found 6 models, 8 sources, 477 macros
[0m18:33:52.358550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fefba909-cb75-49ca-af8e-20e3b14d40dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D7BB5E0>]}
[0m18:33:52.361555 [info ] [MainThread]: 
[0m18:33:52.362550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:33:52.363553 [info ] [MainThread]: 
[0m18:33:52.365550 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:33:52.368550 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m18:33:52.491985 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m18:33:52.491985 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m18:33:52.492984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:53.133315 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.640 seconds
[0m18:33:53.149340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m18:33:53.171345 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m18:33:53.172346 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m18:33:53.173368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:53.660475 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.487 seconds
[0m18:33:53.676478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fefba909-cb75-49ca-af8e-20e3b14d40dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D789120>]}
[0m18:33:53.699857 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_rev
[0m18:33:53.701855 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.customer_rev ........................... [RUN]
[0m18:33:53.703856 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_rev'
[0m18:33:53.704856 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_rev
[0m18:33:53.717896 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_rev"
[0m18:33:53.719853 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_rev
[0m18:33:53.763895 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_rev"
[0m18:33:53.765852 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_rev"
[0m18:33:53.766851 [debug] [Thread-1 (]: On model.snow_dbt.customer_rev: create or replace transient table finance_db.L1_LANDING.customer_rev
    
    
    
    as (

select 
o.customer_id,
c.full_name,
sum(o.order_count) as total_order_count,
sum(o.Revenue) as total_revenue
from finance_db.L1_LANDING.fact_orders o
left join finance_db.L1_LANDING.customer_stg c
on o.customer_id = c.customer_id
group by 
o.customer_id,
c.full_name
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_rev"} */;
[0m18:33:53.767851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:33:55.145935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.378 seconds
[0m18:33:55.189903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefba909-cb75-49ca-af8e-20e3b14d40dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D842080>]}
[0m18:33:55.191877 [info ] [Thread-1 (]: 1 of 1 OK created sql table model L1_LANDING.customer_rev ...................... [[32mSUCCESS 1[0m in 1.48s]
[0m18:33:55.192876 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_rev
[0m18:33:55.194874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:55.195919 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m18:33:55.195919 [debug] [MainThread]: On list_finance_db: Close
[0m18:33:55.293308 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m18:33:55.294343 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m18:33:55.379448 [debug] [MainThread]: Connection 'model.snow_dbt.customer_rev' was left open.
[0m18:33:55.380445 [debug] [MainThread]: On model.snow_dbt.customer_rev: Close
[0m18:33:55.470259 [info ] [MainThread]: 
[0m18:33:55.471213 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m18:33:55.474216 [debug] [MainThread]: Command end result
[0m18:33:55.515257 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m18:33:55.518260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m18:33:55.530224 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m18:33:55.530224 [info ] [MainThread]: 
[0m18:33:55.532211 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:33:55.533211 [info ] [MainThread]: 
[0m18:33:55.533781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:33:55.534791 [debug] [MainThread]: Command `dbt run` succeeded at 18:33:55.534791 after 5.33 seconds
[0m18:33:55.535834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4695156C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46D7E1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46AE93010>]}
[0m18:33:55.536832 [debug] [MainThread]: Flushing usage events
[0m18:33:56.201044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:06:47.180993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB90F56C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEBA380490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEBA3802B0>]}


============================== 22:06:47.195495 | e1a01fef-781b-4572-b701-245f28997302 ==============================
[0m22:06:47.195495 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:06:47.198481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.254751 [info ] [MainThread]: dbt version: 1.10.5
[0m22:06:47.256740 [info ] [MainThread]: python version: 3.10.7
[0m22:06:47.259757 [info ] [MainThread]: python path: C:\Users\alawa\snow\snow_dbt\.venv\Scripts\python.exe
[0m22:06:47.263285 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m22:06:48.787083 [info ] [MainThread]: Using profiles dir at C:\Users\alawa\.dbt
[0m22:06:48.789084 [info ] [MainThread]: Using profiles.yml file at C:\Users\alawa\.dbt\profiles.yml
[0m22:06:48.792150 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alawa\snow\snow_dbt\dbt_project.yml
[0m22:06:48.797174 [info ] [MainThread]: adapter type: snowflake
[0m22:06:48.800692 [info ] [MainThread]: adapter version: 1.10.0
[0m22:06:49.382560 [info ] [MainThread]: Configuration:
[0m22:06:49.383609 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:06:49.385615 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:06:49.387615 [info ] [MainThread]: Required dependencies:
[0m22:06:49.388614 [debug] [MainThread]: Executing "git --help"
[0m22:06:49.549261 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:06:49.552337 [debug] [MainThread]: STDERR: "b''"
[0m22:06:49.554682 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:06:49.557676 [info ] [MainThread]: Connection:
[0m22:06:49.559675 [info ] [MainThread]:   account: ki78787.me-central2.gcp
[0m22:06:49.562723 [info ] [MainThread]:   user: ABBAS1213
[0m22:06:49.565740 [info ] [MainThread]:   database: finance_db
[0m22:06:49.568747 [info ] [MainThread]:   warehouse: finance_wh
[0m22:06:49.571255 [info ] [MainThread]:   role: accountadmin
[0m22:06:49.573108 [info ] [MainThread]:   schema: L1_LANDING
[0m22:06:49.576276 [info ] [MainThread]:   authenticator: None
[0m22:06:49.579279 [info ] [MainThread]:   oauth_client_id: None
[0m22:06:49.584434 [info ] [MainThread]:   query_tag: None
[0m22:06:49.586431 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:06:49.588431 [info ] [MainThread]:   host: None
[0m22:06:49.590944 [info ] [MainThread]:   port: None
[0m22:06:49.593524 [info ] [MainThread]:   proxy_host: None
[0m22:06:49.596526 [info ] [MainThread]:   proxy_port: None
[0m22:06:49.599531 [info ] [MainThread]:   protocol: None
[0m22:06:49.602593 [info ] [MainThread]:   connect_retries: 1
[0m22:06:49.605610 [info ] [MainThread]:   connect_timeout: None
[0m22:06:49.608609 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:06:49.613678 [info ] [MainThread]:   retry_all: False
[0m22:06:49.618413 [info ] [MainThread]:   insecure_mode: False
[0m22:06:49.623526 [info ] [MainThread]:   reuse_connections: True
[0m22:06:49.627529 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m22:06:49.634603 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:06:50.646545 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:06:50.833093 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:06:50.834542 [debug] [MainThread]: On debug: select 1 as id
[0m22:06:50.835540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:51.605650 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.769 seconds
[0m22:06:51.611161 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:06:51.616834 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:06:51.624359 [debug] [MainThread]: Command `dbt debug` succeeded at 22:06:51.623363 after 4.72 seconds
[0m22:06:51.628357 [debug] [MainThread]: Connection 'debug' was left open.
[0m22:06:51.634527 [debug] [MainThread]: On debug: Close
[0m22:06:51.755047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB90F56C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEBA380250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB93A4F70>]}
[0m22:06:51.758071 [debug] [MainThread]: Flushing usage events
[0m22:06:52.466509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:24.356683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530E275780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253104DC400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253104DC220>]}


============================== 22:15:24.369726 | 2ebcaeca-393e-490d-bbe0-6b38cda63f7d ==============================
[0m22:15:24.369726 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:15:24.373276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_customers.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:15:26.760721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ebcaeca-393e-490d-bbe0-6b38cda63f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530F51D3F0>]}
[0m22:15:26.960683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ebcaeca-393e-490d-bbe0-6b38cda63f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530F5DE5F0>]}
[0m22:15:26.963929 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:15:27.880962 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:15:28.392583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:28.394535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:28.416662 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.snow_dbt.customer_rev.marts
- models.snow_dbt.customer_rev
[0m22:15:28.536599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ebcaeca-393e-490d-bbe0-6b38cda63f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531255D4B0>]}
[0m22:15:28.791660 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:15:28.805002 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:15:28.853183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ebcaeca-393e-490d-bbe0-6b38cda63f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253124FC7C0>]}
[0m22:15:28.855189 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:15:28.857191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ebcaeca-393e-490d-bbe0-6b38cda63f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253124FC850>]}
[0m22:15:28.860788 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:15:28.868431 [debug] [MainThread]: Command end result
[0m22:15:28.940545 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:15:28.946681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:15:28.957301 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:15:28.960852 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:28.959294 after 4.85 seconds
[0m22:15:28.961438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530E275780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530F5DE5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002530F51F280>]}
[0m22:15:28.963455 [debug] [MainThread]: Flushing usage events
[0m22:15:29.720001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:16:20.096561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2C5956F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2E808490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2E8082B0>]}


============================== 22:16:20.104764 | ff6b6882-eace-4a4d-8571-94d6d52df0e8 ==============================
[0m22:16:20.104764 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:16:20.107175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_customers.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:16:21.633469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff6b6882-eace-4a4d-8571-94d6d52df0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2D839090>]}
[0m22:16:21.853204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff6b6882-eace-4a4d-8571-94d6d52df0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2F2A4400>]}
[0m22:16:21.856205 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:16:22.941236 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:16:23.441337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:23.442351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:23.464010 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.stagin.legacy
[0m22:16:23.577470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff6b6882-eace-4a4d-8571-94d6d52df0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF30889420>]}
[0m22:16:23.834345 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:16:23.839387 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:16:23.888598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff6b6882-eace-4a4d-8571-94d6d52df0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF308057B0>]}
[0m22:16:23.891111 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:16:23.892642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff6b6882-eace-4a4d-8571-94d6d52df0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF30806A40>]}
[0m22:16:23.896687 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:16:23.906827 [debug] [MainThread]: Command end result
[0m22:16:23.979644 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:16:23.986719 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:16:23.997669 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:16:24.000683 [debug] [MainThread]: Command `dbt run` succeeded at 22:16:24.000683 after 4.13 seconds
[0m22:16:24.002867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2C5956F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2D81A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2D839090>]}
[0m22:16:24.004866 [debug] [MainThread]: Flushing usage events
[0m22:16:24.713702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:39.298083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021983CA5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021985F0C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021985F0C250>]}


============================== 22:17:39.307082 | f5c14da2-d354-4133-bdec-e9ba2d372766 ==============================
[0m22:17:39.307082 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:17:39.309086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_customers.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:17:41.262936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5c14da2-d354-4133-bdec-e9ba2d372766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021985622980>]}
[0m22:17:41.459937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5c14da2-d354-4133-bdec-e9ba2d372766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219869A4250>]}
[0m22:17:41.462889 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:17:42.696901 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:17:43.338201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:43.340150 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:43.365153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.stagin.legacy
[0m22:17:43.508200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5c14da2-d354-4133-bdec-e9ba2d372766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021987F89450>]}
[0m22:17:44.001155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:17:44.009149 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:17:44.062153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5c14da2-d354-4133-bdec-e9ba2d372766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021987F04FA0>]}
[0m22:17:44.066151 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:17:44.068159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5c14da2-d354-4133-bdec-e9ba2d372766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021987F19BA0>]}
[0m22:17:44.072197 [info ] [MainThread]: 
[0m22:17:44.074172 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:44.076161 [info ] [MainThread]: 
[0m22:17:44.078154 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:17:44.088152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:17:44.419155 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:17:44.421168 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:17:44.424151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:45.241354 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.817 seconds
[0m22:17:45.253365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance_db, now create_finance_db_L1_LANDING_staging)
[0m22:17:45.261225 [debug] [ThreadPool]: Creating schema "database: "finance_db"
schema: "L1_LANDING_staging"
"
[0m22:17:45.295326 [debug] [ThreadPool]: Using snowflake connection "create_finance_db_L1_LANDING_staging"
[0m22:17:45.303252 [debug] [ThreadPool]: On create_finance_db_L1_LANDING_staging: create schema if not exists finance_db.L1_LANDING_staging
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "create_finance_db_L1_LANDING_staging"} */
[0m22:17:45.402251 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m22:17:45.445317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:17:45.453322 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:17:45.563255 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:17:45.590275 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:17:45.594269 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:17:45.599274 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:17:45.602277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:45.605250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:46.146582 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.541 seconds
[0m22:17:46.218759 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.617 seconds
[0m22:17:46.236768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5c14da2-d354-4133-bdec-e9ba2d372766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219869C2740>]}
[0m22:17:46.271094 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m22:17:46.276089 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING_staging.stg_customers ................... [RUN]
[0m22:17:46.280556 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m22:17:46.284626 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m22:17:46.370264 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m22:17:46.378212 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m22:17:46.570260 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m22:17:46.578197 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m22:17:46.584283 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace   view finance_db.L1_LANDING_staging.stg_customers
  
  
  
  
  as (
    
select id,
    first_name || ' ' || last_name as full_name 
 from finance_db.L1_LANDING.CUSTOMERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m22:17:46.587270 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:17:47.086275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m22:17:47.235282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5c14da2-d354-4133-bdec-e9ba2d372766', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219829B0E20>]}
[0m22:17:47.240270 [info ] [Thread-1 (]: 1 of 1 OK created sql view model L1_LANDING_staging.stg_customers .............. [[32mSUCCESS 1[0m in 0.94s]
[0m22:17:47.247272 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m22:17:47.256276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:47.260283 [debug] [MainThread]: Connection 'create_finance_db_L1_LANDING_staging' was left open.
[0m22:17:47.264280 [debug] [MainThread]: On create_finance_db_L1_LANDING_staging: Close
[0m22:17:47.394328 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:17:47.397278 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:17:47.505279 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:17:47.508270 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:17:47.620293 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m22:17:47.622282 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m22:17:47.767449 [info ] [MainThread]: 
[0m22:17:47.774445 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m22:17:47.783442 [debug] [MainThread]: Command end result
[0m22:17:47.944446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:17:47.957444 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:17:48.004442 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:17:48.008444 [info ] [MainThread]: 
[0m22:17:48.013451 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:48.018452 [info ] [MainThread]: 
[0m22:17:48.022460 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:17:48.028446 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:48.026468 after 8.98 seconds
[0m22:17:48.032442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021983CA5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021985623B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021984F45810>]}
[0m22:17:48.035441 [debug] [MainThread]: Flushing usage events
[0m22:17:48.740556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:06.903080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B97835720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B98AC4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B98AC4250>]}


============================== 22:21:06.907076 | 991cbd99-8026-4c2b-878d-0154181d44b1 ==============================
[0m22:21:06.907076 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:21:06.908078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_orders.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:21:07.591467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '991cbd99-8026-4c2b-878d-0154181d44b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B995966E0>]}
[0m22:21:07.676764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '991cbd99-8026-4c2b-878d-0154181d44b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B99564400>]}
[0m22:21:07.679368 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:21:08.088944 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:21:08.321154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:21:08.321154 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:21:08.331668 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.stagin.legacy
[0m22:21:08.381348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '991cbd99-8026-4c2b-878d-0154181d44b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B9AB49420>]}
[0m22:21:08.505990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:21:08.510101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:21:08.535831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '991cbd99-8026-4c2b-878d-0154181d44b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B9AAC4B50>]}
[0m22:21:08.536832 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:21:08.537830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '991cbd99-8026-4c2b-878d-0154181d44b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B9AADB130>]}
[0m22:21:08.539870 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:21:08.543620 [debug] [MainThread]: Command end result
[0m22:21:08.584075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:21:08.587076 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:21:08.594573 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:21:08.595586 [debug] [MainThread]: Command `dbt run` succeeded at 22:21:08.595586 after 1.83 seconds
[0m22:21:08.596582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B97835720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B94BA2EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B97B083A0>]}
[0m22:21:08.597584 [debug] [MainThread]: Flushing usage events
[0m22:21:09.284700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:20.002786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C915750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170DBAC430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170DBAC250>]}


============================== 22:21:20.007784 | 6328bfd8-d562-4288-8d9b-978875236544 ==============================
[0m22:21:20.007784 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:21:20.009808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s stg_orders.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:21:20.718264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6328bfd8-d562-4288-8d9b-978875236544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170D30E140>]}
[0m22:21:20.823753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6328bfd8-d562-4288-8d9b-978875236544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170E644250>]}
[0m22:21:20.825756 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:21:21.374923 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:21:21.639197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:21:21.640203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:21:21.652277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.stagin.legacy
[0m22:21:21.706840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6328bfd8-d562-4288-8d9b-978875236544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170FC29450>]}
[0m22:21:21.839251 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:21:21.843647 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:21:21.873738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6328bfd8-d562-4288-8d9b-978875236544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170FBA4F70>]}
[0m22:21:21.874736 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:21:21.875737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6328bfd8-d562-4288-8d9b-978875236544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170FBD6AA0>]}
[0m22:21:21.877737 [info ] [MainThread]: 
[0m22:21:21.880252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:21.882783 [info ] [MainThread]: 
[0m22:21:21.884782 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:21:21.887784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:21:22.019333 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:21:22.019855 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:21:22.020873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:22.933450 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.912 seconds
[0m22:21:22.951900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:21:22.971804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:21:22.985049 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:21:22.990017 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:21:22.991120 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:21:22.992139 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:21:22.992803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:22.993517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:23.404245 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.410 seconds
[0m22:21:23.457723 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.465 seconds
[0m22:21:23.470775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6328bfd8-d562-4288-8d9b-978875236544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170DB58940>]}
[0m22:21:23.492145 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_orders
[0m22:21:23.496243 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING_staging.stg_orders ...................... [RUN]
[0m22:21:23.500421 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m22:21:23.503655 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_orders
[0m22:21:23.544453 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m22:21:23.546452 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_orders
[0m22:21:23.589874 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m22:21:23.591883 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m22:21:23.592888 [debug] [Thread-1 (]: On model.snow_dbt.stg_orders: create or replace   view finance_db.L1_LANDING_staging.stg_orders
  
  
  
  
  as (
    

select * from finance_db.L1_LANDING.ORDERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m22:21:23.592888 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:21:23.947952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m22:21:24.011922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6328bfd8-d562-4288-8d9b-978875236544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021709E50E50>]}
[0m22:21:24.012922 [info ] [Thread-1 (]: 1 of 1 OK created sql view model L1_LANDING_staging.stg_orders ................. [[32mSUCCESS 1[0m in 0.51s]
[0m22:21:24.013922 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_orders
[0m22:21:24.016925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:24.016925 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:21:24.018019 [debug] [MainThread]: On list_finance_db: Close
[0m22:21:24.100193 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:21:24.101204 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:21:24.192925 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:21:24.193919 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:21:24.284503 [debug] [MainThread]: Connection 'model.snow_dbt.stg_orders' was left open.
[0m22:21:24.287449 [debug] [MainThread]: On model.snow_dbt.stg_orders: Close
[0m22:21:24.402175 [info ] [MainThread]: 
[0m22:21:24.403175 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m22:21:24.406174 [debug] [MainThread]: Command end result
[0m22:21:24.489314 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:21:24.493855 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:21:24.507264 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:21:24.508262 [info ] [MainThread]: 
[0m22:21:24.510378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:21:24.511389 [info ] [MainThread]: 
[0m22:21:24.512387 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:21:24.514388 [debug] [MainThread]: Command `dbt run` succeeded at 22:21:24.514388 after 4.62 seconds
[0m22:21:24.515386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C915750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170CBE6C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170E644250>]}
[0m22:21:24.515386 [debug] [MainThread]: Flushing usage events
[0m22:21:25.184037 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:50.262204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0B0F5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0D35C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0D35C1F0>]}


============================== 22:22:50.267202 | ce35fea2-1d34-4b20-b950-189ccfb2ad45 ==============================
[0m22:22:50.267202 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:22:50.268201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s stg_payments.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:51.089273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce35fea2-1d34-4b20-b950-189ccfb2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D09462F50>]}
[0m22:22:51.215241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce35fea2-1d34-4b20-b950-189ccfb2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0D192110>]}
[0m22:22:51.217243 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:22:51.703107 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:22:51.958452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:51.958452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:51.969982 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.stagin.legacy
[0m22:22:52.035092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce35fea2-1d34-4b20-b950-189ccfb2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0F3D9480>]}
[0m22:22:52.209841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:22:52.213853 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:22:52.243251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce35fea2-1d34-4b20-b950-189ccfb2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0F3557E0>]}
[0m22:22:52.244250 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:22:52.245249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce35fea2-1d34-4b20-b950-189ccfb2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0F354040>]}
[0m22:22:52.251279 [info ] [MainThread]: 
[0m22:22:52.252289 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:22:52.253300 [info ] [MainThread]: 
[0m22:22:52.255287 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:22:52.257288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:22:52.377007 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:22:52.378007 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:22:52.379001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:52.957661 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.579 seconds
[0m22:22:52.966605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:22:52.985270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:22:52.984267 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:22:52.989816 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:22:52.990826 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:22:52.991544 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:22:52.991544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:52.992552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:53.387637 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.395 seconds
[0m22:22:53.438314 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.447 seconds
[0m22:22:53.443570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce35fea2-1d34-4b20-b950-189ccfb2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0DE1A770>]}
[0m22:22:53.449076 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_payments
[0m22:22:53.450083 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING_staging.stg_payments .................... [RUN]
[0m22:22:53.451156 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m22:22:53.452153 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_payments
[0m22:22:53.462830 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m22:22:53.464829 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_payments
[0m22:22:53.509069 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m22:22:53.512256 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m22:22:53.512256 [debug] [Thread-1 (]: On model.snow_dbt.stg_payments: create or replace   view finance_db.L1_LANDING_staging.stg_payments
  
  
  
  
  as (
    

select * from finance_db.L1_LANDING.PAYMENTS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m22:22:53.513291 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:53.846983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m22:22:53.896302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce35fea2-1d34-4b20-b950-189ccfb2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D09600E50>]}
[0m22:22:53.897430 [info ] [Thread-1 (]: 1 of 1 OK created sql view model L1_LANDING_staging.stg_payments ............... [[32mSUCCESS 1[0m in 0.44s]
[0m22:22:53.898219 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_payments
[0m22:22:53.900235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:53.901351 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:22:53.902350 [debug] [MainThread]: On list_finance_db: Close
[0m22:22:53.978275 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:22:53.979273 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:22:54.067052 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:22:54.068055 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:22:54.142331 [debug] [MainThread]: Connection 'model.snow_dbt.stg_payments' was left open.
[0m22:22:54.143334 [debug] [MainThread]: On model.snow_dbt.stg_payments: Close
[0m22:22:54.242885 [info ] [MainThread]: 
[0m22:22:54.244887 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m22:22:54.245886 [debug] [MainThread]: Command end result
[0m22:22:54.280635 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:22:54.287641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:22:54.304704 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:22:54.305705 [info ] [MainThread]: 
[0m22:22:54.306707 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:22:54.307705 [info ] [MainThread]: 
[0m22:22:54.309212 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:22:54.311406 [debug] [MainThread]: Command `dbt run` succeeded at 22:22:54.310221 after 4.18 seconds
[0m22:22:54.311406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0B0F5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0C396C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0D192110>]}
[0m22:22:54.312403 [debug] [MainThread]: Flushing usage events
[0m22:22:55.073905 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:26.078909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81F759690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8209EC490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8209EC2B0>]}


============================== 22:29:26.083274 | 21f87e74-b811-452d-8a0c-99a8f2fb1f5c ==============================
[0m22:29:26.083274 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:29:26.084386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s customer_orders.sql', 'send_anonymous_usage_stats': 'True'}
[0m22:29:26.753147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21f87e74-b811-452d-8a0c-99a8f2fb1f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F820103F10>]}
[0m22:29:26.848817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21f87e74-b811-452d-8a0c-99a8f2fb1f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82014FAF0>]}
[0m22:29:26.851615 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:29:27.306562 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:29:27.568602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:29:27.569611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:29:27.580344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.stagin.legacy
[0m22:29:27.634761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21f87e74-b811-452d-8a0c-99a8f2fb1f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F822A697E0>]}
[0m22:29:27.753513 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:29:27.765579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:29:27.788885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21f87e74-b811-452d-8a0c-99a8f2fb1f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8229E5D20>]}
[0m22:29:27.790164 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:29:27.790702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21f87e74-b811-452d-8a0c-99a8f2fb1f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8229E5960>]}
[0m22:29:27.792759 [info ] [MainThread]: 
[0m22:29:27.793749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:29:27.794756 [info ] [MainThread]: 
[0m22:29:27.795744 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:27.798840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:29:27.908138 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:29:27.908657 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:29:27.909666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:28.734732 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.825 seconds
[0m22:29:28.755908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:29:28.777892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:29:28.794662 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:29:28.800708 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:29:28.801708 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:29:28.802708 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:29:28.803708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:28.804710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:29.115986 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.311 seconds
[0m22:29:29.287935 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.484 seconds
[0m22:29:29.293101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21f87e74-b811-452d-8a0c-99a8f2fb1f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8214A26B0>]}
[0m22:29:29.298645 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m22:29:29.300269 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m22:29:29.301278 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:29:29.302277 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:29:29.316491 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:29:29.324098 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m22:29:29.380023 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:29:29.384023 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:29:29.385019 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from finance_db.L1_LANDING_staging.stg_orders orders
left join finance_db.L1_LANDING_staging.stg_customers customers
on orders.user_id = customers.id
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:29:29.386020 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:29:29.813942 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdfef1-0000-a3b5-0000-a17900041a72
[0m22:29:29.815449 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'LAST_NAME'
[0m22:29:29.832865 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'LAST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:29:29.835864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21f87e74-b811-452d-8a0c-99a8f2fb1f5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8231B3730>]}
[0m22:29:29.837909 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.53s]
[0m22:29:29.838978 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m22:29:29.839987 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'LAST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:29:29.841685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:29.842728 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:29:29.843683 [debug] [MainThread]: On list_finance_db: Close
[0m22:29:29.947139 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:29:29.949811 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:29:30.045708 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:29:30.046707 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:29:30.155026 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:29:30.156029 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:29:30.273997 [info ] [MainThread]: 
[0m22:29:30.277986 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m22:29:30.282660 [debug] [MainThread]: Command end result
[0m22:29:30.370442 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:29:30.373496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:29:30.389858 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:29:30.390407 [info ] [MainThread]: 
[0m22:29:30.391414 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:29:30.392415 [info ] [MainThread]: 
[0m22:29:30.393413 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:29:30.394417 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'LAST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:29:30.394417 [info ] [MainThread]: 
[0m22:29:30.396414 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:29:30.396414 [info ] [MainThread]: 
[0m22:29:30.398975 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:29:30.400492 [debug] [MainThread]: Command `dbt run` failed at 22:29:30.400492 after 4.45 seconds
[0m22:29:30.401492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81F759690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8209EC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81FA27AC0>]}
[0m22:29:30.401492 [debug] [MainThread]: Flushing usage events
[0m22:29:31.109971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:39:08.281719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022646865750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022648ACC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022648ACC1F0>]}


============================== 22:39:08.288261 | 78bf05c9-57c4-4499-bdc1-c0660ecf0cb7 ==============================
[0m22:39:08.288261 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:39:08.289267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s customer_orders.sql', 'send_anonymous_usage_stats': 'True'}
[0m22:39:09.203713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78bf05c9-57c4-4499-bdc1-c0660ecf0cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022644BA2F50>]}
[0m22:39:09.289712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78bf05c9-57c4-4499-bdc1-c0660ecf0cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022648902110>]}
[0m22:39:09.291714 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:39:09.701024 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:39:09.923025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:39:09.924025 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:39:09.934024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.stagin.legacy
[0m22:39:09.985024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78bf05c9-57c4-4499-bdc1-c0660ecf0cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264AB49A20>]}
[0m22:39:10.104028 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:39:10.108030 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:39:10.156415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78bf05c9-57c4-4499-bdc1-c0660ecf0cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264AAC58A0>]}
[0m22:39:10.156415 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:39:10.157412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78bf05c9-57c4-4499-bdc1-c0660ecf0cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264AAC70A0>]}
[0m22:39:10.159410 [info ] [MainThread]: 
[0m22:39:10.160410 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:39:10.161411 [info ] [MainThread]: 
[0m22:39:10.162410 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:39:10.165415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:39:10.308325 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:39:10.308846 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:39:10.309365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:11.235627 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.927 seconds
[0m22:39:11.245669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:39:11.259666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:39:11.265674 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:39:11.269622 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:39:11.270623 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:39:11.271659 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:39:11.272623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:11.272623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:11.556981 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.284 seconds
[0m22:39:11.565956 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.293 seconds
[0m22:39:11.571954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78bf05c9-57c4-4499-bdc1-c0660ecf0cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264AAC44F0>]}
[0m22:39:11.586851 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m22:39:11.587847 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m22:39:11.588851 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:39:11.589848 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:39:11.601849 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:39:11.603850 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m22:39:11.640846 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:39:11.644845 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:39:11.645846 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from finance_db.L1_LANDING_staging.stg_orders orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from finance_db.L1_LANDING_staging.stg_customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left outer join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:39:11.645846 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:39:12.033731 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdfefb-0000-a3b5-0000-a17900041a8a
[0m22:39:12.034766 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 8
invalid identifier 'FIRST_NAME'
[0m22:39:12.038938 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:39:12.042439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78bf05c9-57c4-4499-bdc1-c0660ecf0cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264B2579D0>]}
[0m22:39:12.043501 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.45s]
[0m22:39:12.045500 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m22:39:12.046446 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:39:12.048450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:12.049494 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:39:12.050495 [debug] [MainThread]: On list_finance_db: Close
[0m22:39:12.145977 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:39:12.147941 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:39:12.238428 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:39:12.239427 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:39:12.319236 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:39:12.320238 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:39:12.404751 [info ] [MainThread]: 
[0m22:39:12.406750 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m22:39:12.407752 [debug] [MainThread]: Command end result
[0m22:39:12.440751 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:39:12.444752 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:39:12.454755 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:39:12.456753 [info ] [MainThread]: 
[0m22:39:12.457750 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:39:12.458750 [info ] [MainThread]: 
[0m22:39:12.459751 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:39:12.460752 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 22 at position 8
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:39:12.461750 [info ] [MainThread]: 
[0m22:39:12.461750 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:39:12.463751 [info ] [MainThread]: 
[0m22:39:12.464753 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:39:12.465754 [debug] [MainThread]: Command `dbt run` failed at 22:39:12.465754 after 4.31 seconds
[0m22:39:12.466757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022646865750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264822A140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264AB2D7E0>]}
[0m22:39:12.467751 [debug] [MainThread]: Flushing usage events
[0m22:39:13.193343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:22.289300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A98E5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217AAB7C400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217AAB7C220>]}


============================== 22:43:22.294301 | 7dbf358b-6d16-4565-8855-05e6a0f9f660 ==============================
[0m22:43:22.294301 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:43:22.296301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s customer_orders.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:43:22.918487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dbf358b-6d16-4565-8855-05e6a0f9f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A9BBD3F0>]}
[0m22:43:23.002488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dbf358b-6d16-4565-8855-05e6a0f9f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A9C7E5F0>]}
[0m22:43:23.003441 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:43:23.379482 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:43:23.606955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:43:23.606955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:43:23.616965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m22:43:23.668885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dbf358b-6d16-4565-8855-05e6a0f9f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ACBF9A50>]}
[0m22:43:23.789840 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:43:23.793841 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:43:23.816847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dbf358b-6d16-4565-8855-05e6a0f9f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ACB75990>]}
[0m22:43:23.817892 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:43:23.818846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbf358b-6d16-4565-8855-05e6a0f9f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217ACB77040>]}
[0m22:43:23.820846 [info ] [MainThread]: 
[0m22:43:23.822843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:23.823842 [info ] [MainThread]: 
[0m22:43:23.825845 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:43:23.827848 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:43:23.924890 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:43:23.925848 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:43:23.926888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:24.886971 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.960 seconds
[0m22:43:24.910892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:43:24.925933 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:43:24.932940 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:43:24.936623 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:43:24.937191 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:43:24.937956 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:43:24.937956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:24.939303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:25.261594 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.323 seconds
[0m22:43:25.398007 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.459 seconds
[0m22:43:25.404015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbf358b-6d16-4565-8855-05e6a0f9f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217AC728C70>]}
[0m22:43:25.413559 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m22:43:25.414558 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m22:43:25.416561 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:43:25.417567 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:43:25.435560 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:43:25.436558 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m22:43:25.473607 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:43:25.484141 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:43:25.485142 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from finance_db.L1_LANDING_staging.stg_orders orders

join finance_db.L1_LANDING_staging.stg_customers customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join ( 
      select * 
      from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left outer join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:43:25.485142 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:43:25.877866 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdfeff-0000-a353-0000-a1790003dcd2
[0m22:43:25.878863 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 8
invalid identifier 'B.NAME'
[0m22:43:25.881863 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'B.NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:43:25.885905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbf358b-6d16-4565-8855-05e6a0f9f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217AD3979A0>]}
[0m22:43:25.887907 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.47s]
[0m22:43:25.888853 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m22:43:25.889903 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'B.NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:43:25.892897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:25.892897 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:43:25.893856 [debug] [MainThread]: On list_finance_db: Close
[0m22:43:25.976011 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:43:25.977060 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:43:26.093558 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:43:26.094554 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:43:26.200863 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:43:26.201860 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:43:26.285667 [info ] [MainThread]: 
[0m22:43:26.286627 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m22:43:26.287628 [debug] [MainThread]: Command end result
[0m22:43:26.321626 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:43:26.325628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:43:26.336623 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:43:26.337624 [info ] [MainThread]: 
[0m22:43:26.337624 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:43:26.338623 [info ] [MainThread]: 
[0m22:43:26.339627 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:43:26.340624 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'B.NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:43:26.342630 [info ] [MainThread]: 
[0m22:43:26.344627 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:43:26.345622 [info ] [MainThread]: 
[0m22:43:26.346622 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:43:26.347625 [debug] [MainThread]: Command `dbt run` failed at 22:43:26.347625 after 4.16 seconds
[0m22:43:26.348664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A98E5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A9C7E5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A9BBD3F0>]}
[0m22:43:26.349626 [debug] [MainThread]: Flushing usage events
[0m22:43:27.080658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:46:17.340127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7B6B56F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7D91C490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7D91C2B0>]}


============================== 22:46:17.345172 | 77b683a0-8016-4c02-9f37-66281e2a8919 ==============================
[0m22:46:17.345172 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:46:17.346127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_customers.sql', 'send_anonymous_usage_stats': 'True'}
[0m22:46:17.995673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77b683a0-8016-4c02-9f37-66281e2a8919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7C949090>]}
[0m22:46:18.080665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77b683a0-8016-4c02-9f37-66281e2a8919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7E3B4400>]}
[0m22:46:18.081616 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:46:18.504093 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:46:18.721098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:46:18.721098 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:46:18.731094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m22:46:18.781096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77b683a0-8016-4c02-9f37-66281e2a8919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7F9999C0>]}
[0m22:46:18.897098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:46:18.901269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:46:18.925279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77b683a0-8016-4c02-9f37-66281e2a8919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7F915720>]}
[0m22:46:18.926277 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:46:18.927277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77b683a0-8016-4c02-9f37-66281e2a8919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7F915D20>]}
[0m22:46:18.930278 [info ] [MainThread]: 
[0m22:46:18.930278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:18.931279 [info ] [MainThread]: 
[0m22:46:18.932279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:46:18.934283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:46:19.036813 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:46:19.037814 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:46:19.038812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:19.568659 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.530 seconds
[0m22:46:19.593042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:46:19.608030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:46:19.613033 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:46:19.616041 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:46:19.617013 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:46:19.617986 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:46:19.618981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:19.618981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:19.927590 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.308 seconds
[0m22:46:20.010645 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.392 seconds
[0m22:46:20.022634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77b683a0-8016-4c02-9f37-66281e2a8919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7E3D2710>]}
[0m22:46:20.037436 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m22:46:20.039446 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING_staging.stg_customers ................... [RUN]
[0m22:46:20.042384 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m22:46:20.045378 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m22:46:20.061378 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m22:46:20.064372 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m22:46:20.101419 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m22:46:20.103369 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m22:46:20.104432 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace   view finance_db.L1_LANDING_staging.stg_customers
  
  
  
  
  as (
    
select id,
    first_name || ' ' || last_name as full_name,
    first_name,
    last_name
 from finance_db.L1_LANDING.CUSTOMERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m22:46:20.105371 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:20.571246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m22:46:20.613194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77b683a0-8016-4c02-9f37-66281e2a8919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF79BC0DF0>]}
[0m22:46:20.614197 [info ] [Thread-1 (]: 1 of 1 OK created sql view model L1_LANDING_staging.stg_customers .............. [[32mSUCCESS 1[0m in 0.57s]
[0m22:46:20.615201 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m22:46:20.617193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:20.618241 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:46:20.618241 [debug] [MainThread]: On list_finance_db: Close
[0m22:46:20.700461 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:46:20.701504 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:46:20.782085 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:46:20.783084 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:46:20.861099 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m22:46:20.862098 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m22:46:20.941390 [info ] [MainThread]: 
[0m22:46:20.942392 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m22:46:20.944440 [debug] [MainThread]: Command end result
[0m22:46:20.975393 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:46:20.978436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:46:20.987434 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:46:20.988394 [info ] [MainThread]: 
[0m22:46:20.990395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:20.991395 [info ] [MainThread]: 
[0m22:46:20.992394 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:46:20.994290 [debug] [MainThread]: Command `dbt run` succeeded at 22:46:20.993238 after 3.76 seconds
[0m22:46:20.994290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7B6B56F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7C949090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EF7E3B4400>]}
[0m22:46:20.995290 [debug] [MainThread]: Flushing usage events
[0m22:46:21.675973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:24.957703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E4BD5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E5E6C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E5E6C1F0>]}


============================== 22:47:24.961749 | ccb8926f-9208-44f0-83ec-bc9c93c2de72 ==============================
[0m22:47:24.961749 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:47:24.962747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s customer_orders.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:47:25.591355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccb8926f-9208-44f0-83ec-bc9c93c2de72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E1F42F50>]}
[0m22:47:25.678920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccb8926f-9208-44f0-83ec-bc9c93c2de72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E5CA2110>]}
[0m22:47:25.679923 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:47:26.057974 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:47:26.315915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:26.316915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:26.325917 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m22:47:26.380921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccb8926f-9208-44f0-83ec-bc9c93c2de72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E7EE9A20>]}
[0m22:47:26.499958 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:47:26.502917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:47:26.527917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccb8926f-9208-44f0-83ec-bc9c93c2de72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E7E658A0>]}
[0m22:47:26.527917 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:47:26.528917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccb8926f-9208-44f0-83ec-bc9c93c2de72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E7E670A0>]}
[0m22:47:26.531964 [info ] [MainThread]: 
[0m22:47:26.532917 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:26.532917 [info ] [MainThread]: 
[0m22:47:26.534921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:47:26.536924 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:47:26.632964 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:47:26.632964 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:47:26.633969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:27.535952 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.902 seconds
[0m22:47:27.544954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:47:27.555985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:47:27.563003 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:47:27.566952 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:47:27.567594 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:47:27.568413 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:47:27.568413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:27.569426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:27.847910 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.279 seconds
[0m22:47:27.998834 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.429 seconds
[0m22:47:28.014813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccb8926f-9208-44f0-83ec-bc9c93c2de72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E7E644F0>]}
[0m22:47:28.028753 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m22:47:28.030748 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m22:47:28.033750 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:47:28.034747 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:47:28.051750 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:47:28.053750 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m22:47:28.089747 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:47:28.093746 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:47:28.093746 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from finance_db.L1_LANDING_staging.stg_orders orders

join finance_db.L1_LANDING_staging.stg_customers customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join ( 
      select * 
      from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left outer join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:47:28.094748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:28.491966 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff03-0000-a3b5-0000-a17900041b06
[0m22:47:28.491966 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 57 at position 19
invalid identifier 'B.NAME'
[0m22:47:28.494930 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 57 at position 19
  invalid identifier 'B.NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:47:28.498929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb8926f-9208-44f0-83ec-bc9c93c2de72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E8667970>]}
[0m22:47:28.499928 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.46s]
[0m22:47:28.500934 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m22:47:28.501934 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 57 at position 19
  invalid identifier 'B.NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:47:28.503931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:28.504929 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:47:28.505929 [debug] [MainThread]: On list_finance_db: Close
[0m22:47:28.590181 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:47:28.592187 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:47:28.687158 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:47:28.687158 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:47:28.767733 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:47:28.768734 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:47:28.857353 [info ] [MainThread]: 
[0m22:47:28.858124 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m22:47:28.859134 [debug] [MainThread]: Command end result
[0m22:47:28.892135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:47:28.895176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:47:28.906139 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:47:28.906139 [info ] [MainThread]: 
[0m22:47:28.907133 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:47:28.908370 [info ] [MainThread]: 
[0m22:47:28.909379 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:47:28.910381 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 57 at position 19
  invalid identifier 'B.NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:47:28.911381 [info ] [MainThread]: 
[0m22:47:28.912384 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:47:28.913385 [info ] [MainThread]: 
[0m22:47:28.915380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:47:28.917378 [debug] [MainThread]: Command `dbt run` failed at 22:47:28.917378 after 4.07 seconds
[0m22:47:28.918417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E4BD5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E55CE140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E7ECD7E0>]}
[0m22:47:28.919411 [debug] [MainThread]: Flushing usage events
[0m22:47:29.631047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:50:17.821708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED376A5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED38930400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED38930220>]}


============================== 22:50:17.825708 | c24e7a17-a128-4bd1-806b-f3601869e96a ==============================
[0m22:50:17.825708 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:50:17.826663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:50:18.466688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3809EFE0>]}
[0m22:50:18.550711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED393C9690>]}
[0m22:50:18.552766 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:50:18.945281 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:50:19.166292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:50:19.167234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:50:19.177273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m22:50:19.229231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3A9B99F0>]}
[0m22:50:19.345237 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:50:19.348238 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:50:19.372233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3A939BA0>]}
[0m22:50:19.377235 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:50:19.379233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3A939C30>]}
[0m22:50:19.382232 [info ] [MainThread]: 
[0m22:50:19.383232 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:50:19.384233 [info ] [MainThread]: 
[0m22:50:19.386242 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:50:19.394702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:50:19.403706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:50:19.493708 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:50:19.494708 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:50:19.495708 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:50:19.496222 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:50:19.496222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:19.497229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:20.470940 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.974 seconds
[0m22:50:20.485938 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.989 seconds
[0m22:50:20.491936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:50:20.504934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:50:20.512936 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:50:20.516934 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:50:20.517935 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:50:20.518936 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:50:20.519941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:20.520936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:20.932179 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.412 seconds
[0m22:50:21.194889 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.675 seconds
[0m22:50:21.199604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED36502680>]}
[0m22:50:21.206614 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m22:50:21.207641 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m22:50:21.208616 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m22:50:21.209641 [info ] [Thread-1 (]: 1 of 4 START sql view model L1_LANDING_staging.stg_customers ................... [RUN]
[0m22:50:21.210613 [info ] [Thread-2 (]: 2 of 4 START sql view model L1_LANDING_staging.stg_orders ...................... [RUN]
[0m22:50:21.211617 [info ] [Thread-3 (]: 3 of 4 START sql view model L1_LANDING_staging.stg_payments .................... [RUN]
[0m22:50:21.213612 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m22:50:21.214610 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m22:50:21.215616 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m22:50:21.216937 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m22:50:21.217888 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m22:50:21.218719 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m22:50:21.231610 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m22:50:21.236612 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m22:50:21.243611 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m22:50:21.245145 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m22:50:21.246152 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m22:50:21.283196 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m22:50:21.284156 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m22:50:21.288198 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m22:50:21.293151 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m22:50:21.295154 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m22:50:21.296154 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace   view finance_db.L1_LANDING_staging.stg_customers
  
  
  
  
  as (
    
select id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m22:50:21.297153 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m22:50:21.297842 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m22:50:21.298883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:21.299438 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace   view finance_db.L1_LANDING_staging.stg_orders
  
  
  
  
  as (
    

select * from finance_db.L1_LANDING.ORDERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m22:50:21.300489 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace   view finance_db.L1_LANDING_staging.stg_payments
  
  
  
  
  as (
    

select * from finance_db.L1_LANDING.PAYMENTS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m22:50:21.303488 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:50:21.305445 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:50:21.950550 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m22:50:22.009538 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3B1BB3A0>]}
[0m22:50:22.011537 [info ] [Thread-3 (]: 3 of 4 OK created sql view model L1_LANDING_staging.stg_payments ............... [[32mSUCCESS 1[0m in 0.79s]
[0m22:50:22.013537 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m22:50:22.116539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.817 seconds
[0m22:50:22.119537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3B1BBA60>]}
[0m22:50:22.120534 [info ] [Thread-1 (]: 1 of 4 OK created sql view model L1_LANDING_staging.stg_customers .............. [[32mSUCCESS 1[0m in 0.91s]
[0m22:50:22.122536 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m22:50:22.138776 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.834 seconds
[0m22:50:22.151776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3B1BB1C0>]}
[0m22:50:22.156776 [info ] [Thread-2 (]: 2 of 4 OK created sql view model L1_LANDING_staging.stg_orders ................. [[32mSUCCESS 1[0m in 0.94s]
[0m22:50:22.164833 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m22:50:22.169847 [debug] [Thread-4 (]: Began running node model.snow_dbt.customer_orders
[0m22:50:22.172799 [info ] [Thread-4 (]: 4 of 4 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m22:50:22.177820 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:50:22.180814 [debug] [Thread-4 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:50:22.203840 [debug] [Thread-4 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:50:22.208793 [debug] [Thread-4 (]: Began executing node model.snow_dbt.customer_orders
[0m22:50:22.218830 [debug] [Thread-4 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:50:22.228828 [debug] [Thread-4 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:50:22.229825 [debug] [Thread-4 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from finance_db.L1_LANDING_staging.stg_orders orders

join finance_db.L1_LANDING_staging.stg_customers customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join ( 
      select * 
      from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left outer join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:50:22.230823 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:50:22.840368 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bdff06-0000-a3b5-0000-a17900041b16
[0m22:50:22.842372 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 28 at position 8
invalid identifier 'B.LAST_NAME'
[0m22:50:22.846371 [debug] [Thread-4 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'B.LAST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:50:22.848371 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c24e7a17-a128-4bd1-806b-f3601869e96a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3B0D9630>]}
[0m22:50:22.850381 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.67s]
[0m22:50:22.852373 [debug] [Thread-4 (]: Finished running node model.snow_dbt.customer_orders
[0m22:50:22.854369 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'B.LAST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:50:22.857373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:22.858369 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:50:22.859371 [debug] [MainThread]: On list_finance_db: Close
[0m22:50:22.953408 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:50:22.956426 [debug] [MainThread]: On list_finance_db: Close
[0m22:50:23.075204 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:50:23.076202 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:50:23.173205 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:50:23.174204 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:50:23.251202 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m22:50:23.252204 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m22:50:23.351392 [debug] [MainThread]: Connection 'model.snow_dbt.stg_orders' was left open.
[0m22:50:23.352393 [debug] [MainThread]: On model.snow_dbt.stg_orders: Close
[0m22:50:23.451389 [debug] [MainThread]: Connection 'model.snow_dbt.stg_payments' was left open.
[0m22:50:23.452390 [debug] [MainThread]: On model.snow_dbt.stg_payments: Close
[0m22:50:23.543009 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:50:23.544008 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:50:23.674007 [info ] [MainThread]: 
[0m22:50:23.675005 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m22:50:23.680004 [debug] [MainThread]: Command end result
[0m22:50:23.794006 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:50:23.798004 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:50:23.808800 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:50:23.808800 [info ] [MainThread]: 
[0m22:50:23.809808 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:50:23.810851 [info ] [MainThread]: 
[0m22:50:23.811851 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:50:23.812856 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'B.LAST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:50:23.813843 [info ] [MainThread]: 
[0m22:50:23.814808 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:50:23.816810 [info ] [MainThread]: 
[0m22:50:23.817814 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m22:50:23.818811 [debug] [MainThread]: Command `dbt run` failed at 22:50:23.818811 after 6.11 seconds
[0m22:50:23.820811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED376A5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED379787F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3B26F430>]}
[0m22:50:23.820811 [debug] [MainThread]: Flushing usage events
[0m22:50:24.545226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:51:15.294430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EA2D5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EC53C400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EC53C220>]}


============================== 22:51:15.298469 | a86677e7-49bf-4513-ad44-4015d78ab564 ==============================
[0m22:51:15.298469 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:51:15.299428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s customer_orders.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:51:15.912433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a86677e7-49bf-4513-ad44-4015d78ab564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EB57B670>]}
[0m22:51:15.998434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a86677e7-49bf-4513-ad44-4015d78ab564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EB63E5F0>]}
[0m22:51:15.999436 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:51:16.381908 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:51:16.601908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:51:16.601908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:51:16.611860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m22:51:16.666858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a86677e7-49bf-4513-ad44-4015d78ab564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EE5B9A50>]}
[0m22:51:16.782862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:51:16.786860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:51:16.809826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a86677e7-49bf-4513-ad44-4015d78ab564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EE535990>]}
[0m22:51:16.810827 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:51:16.811820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86677e7-49bf-4513-ad44-4015d78ab564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EE537040>]}
[0m22:51:16.813863 [info ] [MainThread]: 
[0m22:51:16.814822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:51:16.815826 [info ] [MainThread]: 
[0m22:51:16.817827 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:51:16.819828 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:51:16.915818 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:51:16.915818 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:51:16.916819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:51:17.464501 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m22:51:17.475449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:51:17.482493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:51:17.493492 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:51:17.496188 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:51:17.497219 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:51:17.498189 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:51:17.499192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:51:17.500190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:51:17.848189 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.348 seconds
[0m22:51:17.855107 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.355 seconds
[0m22:51:17.877020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86677e7-49bf-4513-ad44-4015d78ab564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285ECFF27A0>]}
[0m22:51:17.888427 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m22:51:17.891428 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m22:51:17.893425 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:51:17.894427 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:51:17.911422 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:51:17.913425 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m22:51:17.949476 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:51:17.953428 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:51:17.954481 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from finance_db.L1_LANDING_staging.stg_orders orders

join finance_db.L1_LANDING_staging.stg_customers customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join ( 
      select * 
      from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left outer join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:51:17.955473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:51:18.446053 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff07-0000-a3b5-0000-a17900041b1a
[0m22:51:18.447054 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 28 at position 8
invalid identifier 'B.LAST_NAME'
[0m22:51:18.451054 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'B.LAST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:51:18.455021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a86677e7-49bf-4513-ad44-4015d78ab564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EECE7A00>]}
[0m22:51:18.456029 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.56s]
[0m22:51:18.458029 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m22:51:18.459028 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'B.LAST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:51:18.463030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:51:18.464029 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:51:18.464029 [debug] [MainThread]: On list_finance_db: Close
[0m22:51:18.556840 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:51:18.557841 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:51:18.646606 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:51:18.646606 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:51:18.726819 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:51:18.726819 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:51:18.814118 [info ] [MainThread]: 
[0m22:51:18.815072 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m22:51:18.815828 [debug] [MainThread]: Command end result
[0m22:51:18.847839 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:51:18.852068 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:51:18.862075 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:51:18.863075 [info ] [MainThread]: 
[0m22:51:18.864076 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:51:18.865080 [info ] [MainThread]: 
[0m22:51:18.866075 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:51:18.867078 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 28 at position 8
  invalid identifier 'B.LAST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:51:18.868075 [info ] [MainThread]: 
[0m22:51:18.869092 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:51:18.871075 [info ] [MainThread]: 
[0m22:51:18.872077 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:51:18.874076 [debug] [MainThread]: Command `dbt run` failed at 22:51:18.873077 after 3.68 seconds
[0m22:51:18.874076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EA2D5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EB63E5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285EB57B670>]}
[0m22:51:18.875076 [debug] [MainThread]: Flushing usage events
[0m22:51:19.560806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:07.710910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064E9C5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020650C2C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020650C2C250>]}


============================== 22:54:07.714942 | 9d10522c-a34a-4df4-8d69-ab50673e105e ==============================
[0m22:54:07.714942 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:54:07.715852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s customer_orders.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:54:08.343504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d10522c-a34a-4df4-8d69-ab50673e105e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020650342980>]}
[0m22:54:08.429506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d10522c-a34a-4df4-8d69-ab50673e105e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206516C4250>]}
[0m22:54:08.431456 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:54:08.806503 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:54:09.028506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:54:09.029504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:54:09.038501 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m22:54:09.088496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d10522c-a34a-4df4-8d69-ab50673e105e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020652CA99F0>]}
[0m22:54:09.205459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:54:09.208459 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:54:09.231567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d10522c-a34a-4df4-8d69-ab50673e105e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020652C27070>]}
[0m22:54:09.232574 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:54:09.233575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d10522c-a34a-4df4-8d69-ab50673e105e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020652C25870>]}
[0m22:54:09.235609 [info ] [MainThread]: 
[0m22:54:09.236568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:54:09.237566 [info ] [MainThread]: 
[0m22:54:09.239567 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:54:09.241571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:54:09.342611 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:54:09.342611 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:54:09.343611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:09.906051 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.562 seconds
[0m22:54:09.924514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:54:09.926538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:54:09.945158 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:54:09.948135 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:54:09.949136 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:54:09.950295 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:54:09.950943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:09.951612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:10.288666 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.337 seconds
[0m22:54:10.293616 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.343 seconds
[0m22:54:10.312586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d10522c-a34a-4df4-8d69-ab50673e105e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020652C26DA0>]}
[0m22:54:10.321357 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m22:54:10.322394 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m22:54:10.324351 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:54:10.325397 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:54:10.338348 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:54:10.340396 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m22:54:10.377350 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:54:10.381347 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:54:10.382350 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from finance_db.L1_LANDING_staging.stg_orders orders

join finance_db.L1_LANDING_staging.stg_customers customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.full_name,
        b.surname,
        b.givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join ( 
      select
    id,
    first_name || ' ' || last_name as full_name,
    givenname,
    surname
      from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left outer join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:54:10.383348 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:54:11.086485 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff0a-0000-a3b5-0000-a17900041b1e
[0m22:54:11.087520 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 49 at position 4
invalid identifier 'FIRST_NAME'
[0m22:54:11.090522 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 49 at position 4
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:54:11.093484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d10522c-a34a-4df4-8d69-ab50673e105e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206533B79A0>]}
[0m22:54:11.094488 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.77s]
[0m22:54:11.096486 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m22:54:11.097530 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 49 at position 4
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:54:11.099484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:11.100484 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:54:11.100484 [debug] [MainThread]: On list_finance_db: Close
[0m22:54:11.186542 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:54:11.188539 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:54:11.277166 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:54:11.278156 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:54:11.372278 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:54:11.372278 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:54:11.459831 [info ] [MainThread]: 
[0m22:54:11.460831 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m22:54:11.462788 [debug] [MainThread]: Command end result
[0m22:54:11.495788 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:54:11.498786 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:54:11.510749 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:54:11.511756 [info ] [MainThread]: 
[0m22:54:11.512759 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:54:11.513755 [info ] [MainThread]: 
[0m22:54:11.514755 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:54:11.515757 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 49 at position 4
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:54:11.516756 [info ] [MainThread]: 
[0m22:54:11.517756 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:54:11.519758 [info ] [MainThread]: 
[0m22:54:11.520761 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:54:11.521761 [debug] [MainThread]: Command `dbt run` failed at 22:54:11.521761 after 3.92 seconds
[0m22:54:11.522800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064E9C5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020650343B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064FC6D4E0>]}
[0m22:54:11.523802 [debug] [MainThread]: Flushing usage events
[0m22:54:12.226819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:36.448385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E3135780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E43CC400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E43CC220>]}


============================== 22:55:36.452394 | 2795d309-bcf0-4c1e-bc0d-6c652af99ad3 ==============================
[0m22:55:36.452394 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:55:36.453441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s customer_orders.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:55:37.084077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2795d309-bcf0-4c1e-bc0d-6c652af99ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E340D3F0>]}
[0m22:55:37.168074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2795d309-bcf0-4c1e-bc0d-6c652af99ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E34CE5F0>]}
[0m22:55:37.170026 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:55:37.552074 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:55:37.806025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:37.807028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:37.817026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m22:55:37.872070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2795d309-bcf0-4c1e-bc0d-6c652af99ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E6449A50>]}
[0m22:55:37.999145 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:55:38.006147 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:55:38.033143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2795d309-bcf0-4c1e-bc0d-6c652af99ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E63C5990>]}
[0m22:55:38.034194 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:55:38.035143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2795d309-bcf0-4c1e-bc0d-6c652af99ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E63C7040>]}
[0m22:55:38.037191 [info ] [MainThread]: 
[0m22:55:38.038185 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:38.039141 [info ] [MainThread]: 
[0m22:55:38.041148 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:38.043144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:55:38.140144 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:55:38.140144 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:55:38.141149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:38.803749 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.662 seconds
[0m22:55:38.813691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_finance_db, now create_finance_db_L1_LANDING_legacy)
[0m22:55:38.821679 [debug] [ThreadPool]: Creating schema "database: "finance_db"
schema: "L1_LANDING_legacy"
"
[0m22:55:38.832673 [debug] [ThreadPool]: Using snowflake connection "create_finance_db_L1_LANDING_legacy"
[0m22:55:38.833676 [debug] [ThreadPool]: On create_finance_db_L1_LANDING_legacy: create schema if not exists finance_db.L1_LANDING_legacy
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "create_finance_db_L1_LANDING_legacy"} */
[0m22:55:38.926734 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.092 seconds
[0m22:55:38.935743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:55:38.936743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_legacy'
[0m22:55:38.951784 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:55:38.955839 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_legacy"
[0m22:55:38.956791 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:55:38.956791 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_legacy: show objects in finance_db.L1_LANDING_legacy
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_legacy"} */;
[0m22:55:38.957813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:38.958792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:39.382813 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.424 seconds
[0m22:55:39.398763 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.441 seconds
[0m22:55:39.403752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2795d309-bcf0-4c1e-bc0d-6c652af99ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E4E827A0>]}
[0m22:55:39.409541 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m22:55:39.410570 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING_legacy.customer_orders .................. [RUN]
[0m22:55:39.411572 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:55:39.412543 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:55:39.424537 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:55:39.426536 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m22:55:39.465581 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:55:39.469585 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:55:39.470581 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING_legacy.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.last_name as surname,
    customers.first_name as givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status

from finance_db.L1_LANDING_staging.stg_orders orders

-- Clean join: customers table, select only necessary fields
join (
    select 
        id,
        first_name,
        last_name,
        first_name || ' ' || last_name as name
    from finance_db.L1_LANDING_staging.stg_customers
) customers
on orders.user_id = customers.id

-- customer order history CTE - cleaned to avoid * and ambiguous fields
join (
    select 
        b.id as customer_id,
        b.first_name,
        b.last_name,
        b.first_name || ' ' || b.last_name as full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
            nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
        select 
            row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
        from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join (
        select 
            id,
            first_name,
            last_name
        from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.first_name, b.last_name
) customer_order_history
on orders.user_id = customer_order_history.customer_id

left join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'


  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:55:39.471539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:39.801864 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff0b-0000-a353-0000-a1790003dd9a
[0m22:55:39.803852 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 8
invalid identifier 'FIRST_NAME'
[0m22:55:39.807803 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 25 at position 8
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:55:39.812849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2795d309-bcf0-4c1e-bc0d-6c652af99ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E69F72E0>]}
[0m22:55:39.814847 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING_legacy.customer_orders ......... [[31mERROR[0m in 0.40s]
[0m22:55:39.815847 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m22:55:39.817803 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 25 at position 8
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:55:39.819799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:39.820861 [debug] [MainThread]: Connection 'create_finance_db_L1_LANDING_legacy' was left open.
[0m22:55:39.821801 [debug] [MainThread]: On create_finance_db_L1_LANDING_legacy: Close
[0m22:55:39.900130 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:55:39.901127 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:55:39.987448 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_legacy' was left open.
[0m22:55:39.988448 [debug] [MainThread]: On list_finance_db_L1_LANDING_legacy: Close
[0m22:55:40.069777 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:55:40.071777 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:55:40.165946 [info ] [MainThread]: 
[0m22:55:40.166948 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m22:55:40.168899 [debug] [MainThread]: Command end result
[0m22:55:40.199939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:55:40.202900 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:55:40.213900 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:55:40.214901 [info ] [MainThread]: 
[0m22:55:40.215902 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:55:40.216900 [info ] [MainThread]: 
[0m22:55:40.217899 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:55:40.218899 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 25 at position 8
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:55:40.219899 [info ] [MainThread]: 
[0m22:55:40.220900 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:55:40.221901 [info ] [MainThread]: 
[0m22:55:40.222897 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:55:40.225899 [debug] [MainThread]: Command `dbt run` failed at 22:55:40.224898 after 3.90 seconds
[0m22:55:40.226901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E3135780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E3B2AFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E642D7B0>]}
[0m22:55:40.227898 [debug] [MainThread]: Flushing usage events
[0m22:55:40.941220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:49.800976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029251C35720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029253E9C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029253E9C250>]}


============================== 22:55:49.805981 | 5fca8cf8-eba4-49a6-b607-40b7c1cf3461 ==============================
[0m22:55:49.805981 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:55:49.806983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s customer_orders.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:55:50.478917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fca8cf8-eba4-49a6-b607-40b7c1cf3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292535B6980>]}
[0m22:55:50.562920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fca8cf8-eba4-49a6-b607-40b7c1cf3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029254934250>]}
[0m22:55:50.564871 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:55:51.031917 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:55:51.265870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:51.265870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:51.277868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m22:55:51.343869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fca8cf8-eba4-49a6-b607-40b7c1cf3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029255F199F0>]}
[0m22:55:51.474873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:55:51.478873 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:55:51.504869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fca8cf8-eba4-49a6-b607-40b7c1cf3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029255E97070>]}
[0m22:55:51.505872 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:55:51.506870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fca8cf8-eba4-49a6-b607-40b7c1cf3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029255E95870>]}
[0m22:55:51.509871 [info ] [MainThread]: 
[0m22:55:51.510873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:51.511872 [info ] [MainThread]: 
[0m22:55:51.513874 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:51.515871 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:55:51.635876 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:55:51.636870 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:55:51.637875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:52.474395 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.836 seconds
[0m22:55:52.513394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:55:52.516399 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:55:52.542379 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:55:52.546383 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:55:52.547381 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:55:52.547381 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:55:52.548384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:52.549386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:52.816387 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.267 seconds
[0m22:55:52.825388 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.276 seconds
[0m22:55:52.829380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fca8cf8-eba4-49a6-b607-40b7c1cf3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029254952740>]}
[0m22:55:52.835387 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m22:55:52.836385 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m22:55:52.837381 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:55:52.838384 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:55:52.852385 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:55:52.854384 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m22:55:52.898382 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:55:52.902380 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:55:52.903380 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.last_name as surname,
    customers.first_name as givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status

from finance_db.L1_LANDING_staging.stg_orders orders

-- Clean join: customers table, select only necessary fields
join (
    select 
        id,
        first_name,
        last_name,
        first_name || ' ' || last_name as name
    from finance_db.L1_LANDING_staging.stg_customers
) customers
on orders.user_id = customers.id

-- customer order history CTE - cleaned to avoid * and ambiguous fields
join (
    select 
        b.id as customer_id,
        b.first_name,
        b.last_name,
        b.first_name || ' ' || b.last_name as full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
            nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
        select 
            row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
        from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join (
        select 
            id,
            first_name,
            last_name
        from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.first_name, b.last_name
) customer_order_history
on orders.user_id = customer_order_history.customer_id

left join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:55:52.904381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:53.347205 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff0c-0000-a353-0000-a1790003dd9e
[0m22:55:53.349203 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 8
invalid identifier 'FIRST_NAME'
[0m22:55:53.353208 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 25 at position 8
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:55:53.358201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fca8cf8-eba4-49a6-b607-40b7c1cf3461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292566679A0>]}
[0m22:55:53.360199 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.52s]
[0m22:55:53.364202 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m22:55:53.366200 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 25 at position 8
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:55:53.371203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:53.373201 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:55:53.374201 [debug] [MainThread]: On list_finance_db: Close
[0m22:55:53.465199 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:55:53.467200 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:55:53.543203 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:55:53.544199 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:55:53.621207 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:55:53.622207 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:55:53.705202 [info ] [MainThread]: 
[0m22:55:53.706204 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m22:55:53.709201 [debug] [MainThread]: Command end result
[0m22:55:53.765205 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:55:53.769205 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:55:53.785205 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:55:53.786201 [info ] [MainThread]: 
[0m22:55:53.788200 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:55:53.789203 [info ] [MainThread]: 
[0m22:55:53.791200 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:55:53.793212 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 25 at position 8
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:55:53.794199 [info ] [MainThread]: 
[0m22:55:53.796214 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:55:53.797201 [info ] [MainThread]: 
[0m22:55:53.798199 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:55:53.800201 [debug] [MainThread]: Command `dbt run` failed at 22:55:53.800201 after 4.12 seconds
[0m22:55:53.801201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029251C35720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292535B7B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029252ED54E0>]}
[0m22:55:53.802206 [debug] [MainThread]: Flushing usage events
[0m22:55:54.520127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:01.031932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020133805780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020135A6C400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020135A6C220>]}


============================== 22:58:01.036932 | 96145994-8224-439c-a6c6-986e3afb2317 ==============================
[0m22:58:01.036932 [info ] [MainThread]: Running with dbt=1.10.5
[0m22:58:01.038935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s customer_orders.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:58:01.748073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96145994-8224-439c-a6c6-986e3afb2317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020134AB3670>]}
[0m22:58:01.868071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96145994-8224-439c-a6c6-986e3afb2317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020134B725F0>]}
[0m22:58:01.870075 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:58:02.305073 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m22:58:02.597116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:02.597116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:02.607119 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m22:58:02.659072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96145994-8224-439c-a6c6-986e3afb2317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020137AE9A50>]}
[0m22:58:02.803079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:58:02.807074 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:58:02.831072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96145994-8224-439c-a6c6-986e3afb2317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020137A65990>]}
[0m22:58:02.832074 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m22:58:02.833119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96145994-8224-439c-a6c6-986e3afb2317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020137A67040>]}
[0m22:58:02.835072 [info ] [MainThread]: 
[0m22:58:02.836071 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:58:02.837073 [info ] [MainThread]: 
[0m22:58:02.838099 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:58:02.840077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m22:58:02.938121 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m22:58:02.938121 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m22:58:02.939123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:03.493707 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.554 seconds
[0m22:58:03.526707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m22:58:03.529700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m22:58:03.556695 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m22:58:03.561697 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m22:58:03.562698 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m22:58:03.563694 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m22:58:03.564697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:03.565697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:03.869987 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.305 seconds
[0m22:58:03.877034 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.311 seconds
[0m22:58:03.908989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96145994-8224-439c-a6c6-986e3afb2317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020137A64190>]}
[0m22:58:03.930970 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m22:58:03.933977 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m22:58:03.936958 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m22:58:03.939955 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m22:58:03.960958 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m22:58:03.962952 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m22:58:04.053953 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m22:58:04.058949 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m22:58:04.060953 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status

from finance_db.L1_LANDING_staging.stg_orders orders

-- Clean join: customers table, select only necessary fields
join (
    select 
        id,
        givenname,
        surname,
        full_name
    from finance_db.L1_LANDING_staging.stg_customers
) customers
on orders.user_id = customers.id

-- customer order history CTE - cleaned to avoid * and ambiguous fields
join (
    select 
        b.id as customer_id,
        b.first_name,
        b.last_name,
        b.first_name || ' ' || b.last_name as full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
            nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
        select 
            row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
        from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join (
        select 
            id,
            first_name,
            last_name
        from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.first_name, b.last_name
) customer_order_history
on orders.user_id = customer_order_history.customer_id

left join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m22:58:04.061954 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:58:04.522688 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff0e-0000-a353-0000-a1790003dda2
[0m22:58:04.523690 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 62 at position 12
invalid identifier 'FIRST_NAME'
[0m22:58:04.527693 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 62 at position 12
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:58:04.531688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96145994-8224-439c-a6c6-986e3afb2317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201381F7A00>]}
[0m22:58:04.533689 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.59s]
[0m22:58:04.535691 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m22:58:04.537694 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 62 at position 12
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m22:58:04.540690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:04.541689 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m22:58:04.542689 [debug] [MainThread]: On list_finance_db: Close
[0m22:58:04.632688 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m22:58:04.633690 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m22:58:04.710690 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m22:58:04.712689 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m22:58:04.795688 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m22:58:04.796688 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m22:58:04.881236 [info ] [MainThread]: 
[0m22:58:04.883234 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m22:58:04.885238 [debug] [MainThread]: Command end result
[0m22:58:04.922236 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m22:58:04.925242 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m22:58:04.935240 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m22:58:04.936241 [info ] [MainThread]: 
[0m22:58:04.937163 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:58:04.939171 [info ] [MainThread]: 
[0m22:58:04.940172 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m22:58:04.940172 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 62 at position 12
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m22:58:04.941172 [info ] [MainThread]: 
[0m22:58:04.942174 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m22:58:04.943217 [info ] [MainThread]: 
[0m22:58:04.944172 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:58:04.946213 [debug] [MainThread]: Command `dbt run` failed at 22:58:04.945193 after 4.04 seconds
[0m22:58:04.946213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020133805780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020134B725F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201380061A0>]}
[0m22:58:04.947171 [debug] [MainThread]: Flushing usage events
[0m22:58:05.718486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:32.935638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C20356C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C32CC430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C32CC250>]}


============================== 23:00:32.939638 | e87bdbf1-1bc9-4ec4-b60c-9a42d8482cf0 ==============================
[0m23:00:32.939638 [info ] [MainThread]: Running with dbt=1.10.5
[0m23:00:32.940639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s customer_orders.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:00:33.658672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e87bdbf1-1bc9-4ec4-b60c-9a42d8482cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BF3E2E60>]}
[0m23:00:33.743631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e87bdbf1-1bc9-4ec4-b60c-9a42d8482cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C29E3010>]}
[0m23:00:33.745633 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:00:34.128631 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m23:00:34.350676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:34.351681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:34.360677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m23:00:34.412691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e87bdbf1-1bc9-4ec4-b60c-9a42d8482cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C5349990>]}
[0m23:00:34.536634 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m23:00:34.540634 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m23:00:34.571639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e87bdbf1-1bc9-4ec4-b60c-9a42d8482cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C534A770>]}
[0m23:00:34.572633 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m23:00:34.573641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e87bdbf1-1bc9-4ec4-b60c-9a42d8482cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C4F282B0>]}
[0m23:00:34.575641 [info ] [MainThread]: 
[0m23:00:34.576640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:34.578634 [info ] [MainThread]: 
[0m23:00:34.579637 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:00:34.583637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m23:00:34.710672 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m23:00:34.711676 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m23:00:34.712673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:35.302394 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.590 seconds
[0m23:00:35.311387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m23:00:35.312389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m23:00:35.330430 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m23:00:35.335390 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m23:00:35.336386 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m23:00:35.337388 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m23:00:35.337388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:35.338429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:35.657119 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.318 seconds
[0m23:00:35.714703 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.377 seconds
[0m23:00:35.726641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e87bdbf1-1bc9-4ec4-b60c-9a42d8482cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C3D826E0>]}
[0m23:00:35.745534 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m23:00:35.748533 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m23:00:35.751528 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m23:00:35.752526 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m23:00:35.771528 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m23:00:35.773566 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m23:00:35.811565 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m23:00:35.815565 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m23:00:35.816564 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status

from finance_db.L1_LANDING_staging.stg_orders orders

-- Clean join: customers table, select only necessary fields
join (
    select 
        id,
        givenname,
        surname,
        full_name
    from finance_db.L1_LANDING_staging.stg_customers
) customers
on orders.user_id = customers.id

-- customer order history CTE - cleaned to avoid * and ambiguous fields
join (
    select 
        b.id as customer_id,
        b.givenname,
        b.surname,
        b.full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
            nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
        select 
            row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
        from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join (
        select 
            id,
            givenname,
            surname,
            full_name
        from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.givenname, b.surname
) customer_order_history
on orders.user_id = customer_order_history.customer_id

left join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m23:00:35.817523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:00:36.165172 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff10-0000-a353-0000-a1790003ddaa
[0m23:00:36.165172 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 38 at position 8
'B.FULL_NAME' in select clause is neither an aggregate nor in the group by clause.
[0m23:00:36.168169 [debug] [Thread-1 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  001104 (42601): SQL compilation error: error line 38 at position 8
  'B.FULL_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m23:00:36.171036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e87bdbf1-1bc9-4ec4-b60c-9a42d8482cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C5B47940>]}
[0m23:00:36.172185 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.42s]
[0m23:00:36.173194 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m23:00:36.174239 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  001104 (42601): SQL compilation error: error line 38 at position 8
  'B.FULL_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m23:00:36.177238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:36.177238 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m23:00:36.178198 [debug] [MainThread]: On list_finance_db: Close
[0m23:00:36.247652 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m23:00:36.247652 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m23:00:36.358409 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m23:00:36.358409 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m23:00:36.428520 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m23:00:36.429520 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m23:00:36.493014 [info ] [MainThread]: 
[0m23:00:36.494008 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m23:00:36.496008 [debug] [MainThread]: Command end result
[0m23:00:36.529011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m23:00:36.532052 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m23:00:36.543009 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m23:00:36.544010 [info ] [MainThread]: 
[0m23:00:36.545035 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:00:36.547010 [info ] [MainThread]: 
[0m23:00:36.548010 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m23:00:36.549008 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  001104 (42601): SQL compilation error: error line 38 at position 8
  'B.FULL_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m23:00:36.550007 [info ] [MainThread]: 
[0m23:00:36.551008 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m23:00:36.552008 [info ] [MainThread]: 
[0m23:00:36.553009 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:00:36.554011 [debug] [MainThread]: Command `dbt run` failed at 23:00:36.554011 after 3.73 seconds
[0m23:00:36.555051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C20356C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C29E2EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C22E93C0>]}
[0m23:00:36.556049 [debug] [MainThread]: Flushing usage events
[0m23:00:37.220315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:02:20.564100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024334915780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024336B7C400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024336B7C220>]}


============================== 23:02:20.568095 | 6c2a6828-da13-47fb-9683-eb13cd7a23e8 ==============================
[0m23:02:20.568095 [info ] [MainThread]: Running with dbt=1.10.5
[0m23:02:20.569123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s customer_orders.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:02:21.196144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c2a6828-da13-47fb-9683-eb13cd7a23e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024335BB93F0>]}
[0m23:02:21.281816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c2a6828-da13-47fb-9683-eb13cd7a23e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024335C7E5F0>]}
[0m23:02:21.282817 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:02:21.700089 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m23:02:21.920140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:02:21.921139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:02:21.930137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m23:02:21.982093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c2a6828-da13-47fb-9683-eb13cd7a23e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024338BF9A50>]}
[0m23:02:22.112090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m23:02:22.115097 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m23:02:22.139093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2a6828-da13-47fb-9683-eb13cd7a23e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024338B75990>]}
[0m23:02:22.140091 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m23:02:22.141066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2a6828-da13-47fb-9683-eb13cd7a23e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024338B77040>]}
[0m23:02:22.143103 [info ] [MainThread]: 
[0m23:02:22.144104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:02:22.145293 [info ] [MainThread]: 
[0m23:02:22.146302 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:02:22.148303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m23:02:22.245346 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m23:02:22.246347 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m23:02:22.247304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:23.081459 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.835 seconds
[0m23:02:23.096459 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m23:02:23.097455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m23:02:23.121497 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m23:02:23.125463 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m23:02:23.126458 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m23:02:23.127455 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m23:02:23.128460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:23.129461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:23.421343 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.293 seconds
[0m23:02:23.500938 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.371 seconds
[0m23:02:23.513922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2a6828-da13-47fb-9683-eb13cd7a23e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024338B74190>]}
[0m23:02:23.528717 [debug] [Thread-1 (]: Began running node model.snow_dbt.customer_orders
[0m23:02:23.530715 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m23:02:23.532743 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m23:02:23.533716 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.customer_orders
[0m23:02:23.548754 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m23:02:23.550712 [debug] [Thread-1 (]: Began executing node model.snow_dbt.customer_orders
[0m23:02:23.586753 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m23:02:23.590759 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m23:02:23.591755 [debug] [Thread-1 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status

from finance_db.L1_LANDING_staging.stg_orders orders

-- Clean join: customers table, select only necessary fields
join (
    select 
        id,
        givenname,
        surname,
        full_name
    from finance_db.L1_LANDING_staging.stg_customers
) customers
on orders.user_id = customers.id

-- customer order history CTE - cleaned to avoid * and ambiguous fields
join (
    select 
        b.id as customer_id,
        b.givenname,
        b.surname,
        b.full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
            nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
        select 
            row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
        from finance_db.L1_LANDING_staging.stg_orders
    ) a

    join (
        select 
            id,
            givenname,
            surname,
            full_name
        from finance_db.L1_LANDING_staging.stg_customers
    ) b
    on a.user_id = b.id

    left join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.givenname, b.surname , b.full_name
) customer_order_history
on orders.user_id = customer_order_history.customer_id

left join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m23:02:23.592756 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:02:24.016793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m23:02:24.046194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2a6828-da13-47fb-9683-eb13cd7a23e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024333640E80>]}
[0m23:02:24.047203 [info ] [Thread-1 (]: 1 of 1 OK created sql view model L1_LANDING.customer_orders .................... [[32mSUCCESS 1[0m in 0.51s]
[0m23:02:24.048114 [debug] [Thread-1 (]: Finished running node model.snow_dbt.customer_orders
[0m23:02:24.050239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:24.051252 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m23:02:24.051252 [debug] [MainThread]: On list_finance_db: Close
[0m23:02:24.127427 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m23:02:24.129371 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m23:02:24.206177 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m23:02:24.207224 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m23:02:24.283351 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m23:02:24.283351 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m23:02:24.361735 [info ] [MainThread]: 
[0m23:02:24.362731 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m23:02:24.364736 [debug] [MainThread]: Command end result
[0m23:02:24.400734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m23:02:24.403776 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m23:02:24.413776 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m23:02:24.414738 [info ] [MainThread]: 
[0m23:02:24.415732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:02:24.416733 [info ] [MainThread]: 
[0m23:02:24.417732 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:02:24.418732 [debug] [MainThread]: Command `dbt run` succeeded at 23:02:24.418732 after 3.97 seconds
[0m23:02:24.419730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024334915780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024335BA3F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024338BDD7B0>]}
[0m23:02:24.419730 [debug] [MainThread]: Flushing usage events
[0m23:02:25.134513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:53:36.311426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90CD5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D91F6C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D91F6C1F0>]}


============================== 23:53:36.320481 | 04f095df-8f3a-4480-9537-296d430435dc ==============================
[0m23:53:36.320481 [info ] [MainThread]: Running with dbt=1.10.5
[0m23:53:36.321485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_customers.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:53:37.844896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04f095df-8f3a-4480-9537-296d430435dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8E042F50>]}
[0m23:53:37.929896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04f095df-8f3a-4480-9537-296d430435dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D91DA2110>]}
[0m23:53:37.931855 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:53:38.489373 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m23:53:38.708332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:53:38.709331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:53:38.719331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m23:53:38.769371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04f095df-8f3a-4480-9537-296d430435dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D93FEE0E0>]}
[0m23:53:38.886329 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m23:53:38.895475 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m23:53:38.962678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04f095df-8f3a-4480-9537-296d430435dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D93FEC6D0>]}
[0m23:53:38.963679 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m23:53:38.964678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f095df-8f3a-4480-9537-296d430435dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D93FEE410>]}
[0m23:53:38.966716 [info ] [MainThread]: 
[0m23:53:38.967676 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:53:38.967676 [info ] [MainThread]: 
[0m23:53:38.968717 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:53:38.971036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m23:53:40.975647 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m23:53:40.976648 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m23:53:40.977682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:41.919536 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.943 seconds
[0m23:53:41.929536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m23:53:41.931536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m23:53:41.950522 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m23:53:41.954526 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m23:53:41.955110 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m23:53:41.955711 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m23:53:41.956832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:41.957384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:42.179529 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.222 seconds
[0m23:53:42.398887 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.442 seconds
[0m23:53:42.403928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04f095df-8f3a-4480-9537-296d430435dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D92A2A770>]}
[0m23:53:42.422910 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m23:53:42.423910 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING_staging.stg_customers ................... [RUN]
[0m23:53:42.425868 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m23:53:42.426916 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m23:53:42.441908 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m23:53:42.443862 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m23:53:42.484866 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m23:53:42.486868 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m23:53:42.487868 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace   view finance_db.L1_LANDING_staging.stg_customers
  
  
  
  
  as (
    
select *
 from finance_db.L1_LANDING.CUSTOMERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m23:53:42.488867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:53:42.986419 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff45-0000-a3b5-0000-a17900041d46
[0m23:53:42.987463 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
[0m23:53:43.002282 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m23:53:43.005226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04f095df-8f3a-4480-9537-296d430435dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D94717A30>]}
[0m23:53:43.006233 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING_staging.stg_customers .......... [[31mERROR[0m in 0.58s]
[0m23:53:43.007390 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m23:53:43.008443 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql.
[0m23:53:43.011438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:43.012410 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m23:53:43.012410 [debug] [MainThread]: On list_finance_db: Close
[0m23:53:43.088882 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m23:53:43.090868 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m23:53:43.177505 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m23:53:43.178505 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m23:53:43.255256 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m23:53:43.257260 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m23:53:43.338101 [info ] [MainThread]: 
[0m23:53:43.340053 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m23:53:43.341049 [debug] [MainThread]: Command end result
[0m23:53:43.384117 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m23:53:43.388124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m23:53:43.399118 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m23:53:43.400116 [info ] [MainThread]: 
[0m23:53:43.401116 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:53:43.402117 [info ] [MainThread]: 
[0m23:53:43.403116 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m23:53:43.404116 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m23:53:43.405117 [info ] [MainThread]: 
[0m23:53:43.405624 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\staging\stg_customers.sql
[0m23:53:43.406638 [info ] [MainThread]: 
[0m23:53:43.407630 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:53:43.408634 [debug] [MainThread]: Command `dbt run` failed at 23:53:43.408634 after 7.23 seconds
[0m23:53:43.409675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D90CD5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D916CE140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D93F999F0>]}
[0m23:53:43.410682 [debug] [MainThread]: Flushing usage events
[0m23:53:44.096201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:33.703619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DF8125750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DF93BC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DF93BC1F0>]}


============================== 23:54:33.708614 | d639f379-2f67-4f4a-9134-0544dcbdf091 ==============================
[0m23:54:33.708614 [info ] [MainThread]: Running with dbt=1.10.5
[0m23:54:33.709617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_customers.sql', 'send_anonymous_usage_stats': 'True'}
[0m23:54:34.578724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd639f379-2f67-4f4a-9134-0544dcbdf091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DF54D2F50>]}
[0m23:54:34.671730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd639f379-2f67-4f4a-9134-0544dcbdf091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DF91F2110>]}
[0m23:54:34.674724 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:54:35.087773 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m23:54:35.312590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:35.313160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:35.323335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m23:54:35.374445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd639f379-2f67-4f4a-9134-0544dcbdf091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DFB43E0E0>]}
[0m23:54:35.496689 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m23:54:35.499722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m23:54:35.533817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd639f379-2f67-4f4a-9134-0544dcbdf091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DFB43C6D0>]}
[0m23:54:35.534818 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m23:54:35.535816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd639f379-2f67-4f4a-9134-0544dcbdf091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DFB43E410>]}
[0m23:54:35.538851 [info ] [MainThread]: 
[0m23:54:35.539821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:35.540817 [info ] [MainThread]: 
[0m23:54:35.541821 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:35.543851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m23:54:35.643358 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m23:54:35.644360 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m23:54:35.645404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:36.547684 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.903 seconds
[0m23:54:36.557734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m23:54:36.567728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m23:54:36.576732 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m23:54:36.580732 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m23:54:36.580732 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m23:54:36.582031 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m23:54:36.582031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:36.583039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:36.959382 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.376 seconds
[0m23:54:36.967370 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.384 seconds
[0m23:54:36.986300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd639f379-2f67-4f4a-9134-0544dcbdf091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DF9E7A770>]}
[0m23:54:36.999856 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m23:54:37.000854 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING_staging.stg_customers ................... [RUN]
[0m23:54:37.002803 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m23:54:37.004808 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m23:54:37.017842 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m23:54:37.019801 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m23:54:37.055844 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m23:54:37.057800 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m23:54:37.058851 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace   view finance_db.L1_LANDING_staging.stg_customers
  
  
  
  
  as (
    
select id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m23:54:37.059829 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:54:37.495637 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff46-0000-a3c7-0000-a1790004521e
[0m23:54:37.496291 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
[0m23:54:37.499086 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m23:54:37.502439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd639f379-2f67-4f4a-9134-0544dcbdf091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DFBB23B80>]}
[0m23:54:37.504104 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING_staging.stg_customers .......... [[31mERROR[0m in 0.50s]
[0m23:54:37.505235 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m23:54:37.506369 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql.
[0m23:54:37.508622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:37.509846 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m23:54:37.510428 [debug] [MainThread]: On list_finance_db: Close
[0m23:54:37.593649 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m23:54:37.594605 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m23:54:37.673730 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m23:54:37.674726 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m23:54:37.755995 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m23:54:37.759001 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m23:54:37.854617 [info ] [MainThread]: 
[0m23:54:37.855616 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m23:54:37.857615 [debug] [MainThread]: Command end result
[0m23:54:37.889582 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m23:54:37.892574 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m23:54:37.904576 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m23:54:37.905573 [info ] [MainThread]: 
[0m23:54:37.906573 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:54:37.906573 [info ] [MainThread]: 
[0m23:54:37.907572 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m23:54:37.908572 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m23:54:37.909572 [info ] [MainThread]: 
[0m23:54:37.911574 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\staging\stg_customers.sql
[0m23:54:37.912573 [info ] [MainThread]: 
[0m23:54:37.913572 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:54:37.915577 [debug] [MainThread]: Command `dbt run` failed at 23:54:37.915577 after 4.33 seconds
[0m23:54:37.916575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DF8125750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DF8B1A140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DFB3ED9F0>]}
[0m23:54:37.916575 [debug] [MainThread]: Flushing usage events
[0m23:54:38.667449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:04.009369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB9BE5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBAE783D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBAE781F0>]}


============================== 00:16:04.015366 | 13dfda17-bd48-4ba7-8493-84fa7dfc6a93 ==============================
[0m00:16:04.015366 [info ] [MainThread]: Running with dbt=1.10.5
[0m00:16:04.016371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s fct_customer_orders.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:16:04.789579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13dfda17-bd48-4ba7-8493-84fa7dfc6a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB6FB2F50>]}
[0m00:16:04.881631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13dfda17-bd48-4ba7-8493-84fa7dfc6a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBACB2110>]}
[0m00:16:04.884170 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:16:05.363652 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m00:16:05.605605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:16:05.606605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:16:05.618606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m00:16:05.679609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13dfda17-bd48-4ba7-8493-84fa7dfc6a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBCEF9FC0>]}
[0m00:16:05.811609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:16:05.815607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:16:05.853604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13dfda17-bd48-4ba7-8493-84fa7dfc6a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBCEF9180>]}
[0m00:16:05.855620 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m00:16:05.856608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13dfda17-bd48-4ba7-8493-84fa7dfc6a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBCEFA290>]}
[0m00:16:05.858607 [info ] [MainThread]: 
[0m00:16:05.859605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:16:05.860605 [info ] [MainThread]: 
[0m00:16:05.861603 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:16:05.864608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m00:16:05.974648 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m00:16:05.975648 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m00:16:05.975648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:07.060731 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.084 seconds
[0m00:16:07.072458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m00:16:07.087522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m00:16:07.090577 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m00:16:07.094648 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m00:16:07.094648 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m00:16:07.095605 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m00:16:07.096651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:07.097634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:07.383708 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.287 seconds
[0m00:16:07.385705 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.289 seconds
[0m00:16:07.392882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13dfda17-bd48-4ba7-8493-84fa7dfc6a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBB93A770>]}
[0m00:16:07.400846 [debug] [Thread-1 (]: Began running node model.snow_dbt.fct_customer_orders
[0m00:16:07.402845 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m00:16:07.404848 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m00:16:07.405845 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m00:16:07.421847 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m00:16:07.430879 [debug] [Thread-1 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m00:16:07.481501 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m00:16:07.487694 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m00:16:07.488694 [debug] [Thread-1 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 
base_customers as (select * from finance_db.L1_LANDING_staging.stg_customers),
orders as (select * from finance_db.L1_LANDING_staging.stg_orders),
payments as (select * from finance_db.L1_LANDING_staging.stg_payments),

-- Logical 
customers as ( 
    select 
        id,
        givenname,
        surname,
        full_name
    from base_customers
),
a as (        
    select 
           row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
    from orders
),

customer_order_history as (
     select 
        customers.id as customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
        nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids
        from a
        join customers
        on a.user_id = customers.id
        left outer join payments c
        on a.id = c.orderid
        where a.status NOT IN ('pending') and c.status != 'fail'
        group by customers.id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
    from orders 
    join customers 
    on orders.user_id = customers.id
    join customer_order_history
    on orders.user_id = customer_order_history.customer_id
    left join payments
    on orders.id = payments.orderid 
    where payments.status != 'fail'
)
select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m00:16:07.489683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:16:07.791014 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff5c-0000-a3c7-0000-a1790004522e
[0m00:16:07.792017 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002037 (42601): SQL compilation error:
Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
[0m00:16:07.794017 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m00:16:07.797023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13dfda17-bd48-4ba7-8493-84fa7dfc6a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB89DD600>]}
[0m00:16:07.798027 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 0.39s]
[0m00:16:07.799310 [debug] [Thread-1 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m00:16:07.800370 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m00:16:07.803318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:07.804325 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m00:16:07.804325 [debug] [MainThread]: On list_finance_db: Close
[0m00:16:07.909520 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m00:16:07.912576 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m00:16:08.012960 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m00:16:08.012960 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m00:16:08.111492 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m00:16:08.111492 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m00:16:08.218422 [info ] [MainThread]: 
[0m00:16:08.219388 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m00:16:08.221042 [debug] [MainThread]: Command end result
[0m00:16:08.259045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:16:08.262046 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:16:08.273040 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m00:16:08.274041 [info ] [MainThread]: 
[0m00:16:08.275041 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:16:08.276040 [info ] [MainThread]: 
[0m00:16:08.277039 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m00:16:08.277039 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  002037 (42601): SQL compilation error:
  Failure during expansion of view 'STG_CUSTOMERS': SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m00:16:08.278633 [info ] [MainThread]: 
[0m00:16:08.279642 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m00:16:08.280650 [info ] [MainThread]: 
[0m00:16:08.281639 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:16:08.282643 [debug] [MainThread]: Command `dbt run` failed at 00:16:08.282643 after 4.41 seconds
[0m00:16:08.283674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EB9BE5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBA5DE140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBCEAD7E0>]}
[0m00:16:08.284641 [debug] [MainThread]: Flushing usage events
[0m00:16:08.937483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:17:33.091787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D5E256C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D70BC430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D70BC250>]}


============================== 00:17:33.096787 | 1b5c11f1-dfcc-4dc1-9d93-f773cbdda1ef ==============================
[0m00:17:33.096787 [info ] [MainThread]: Running with dbt=1.10.5
[0m00:17:33.097791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_customers.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:17:33.855109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b5c11f1-dfcc-4dc1-9d93-f773cbdda1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D3192E60>]}
[0m00:17:33.946657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b5c11f1-dfcc-4dc1-9d93-f773cbdda1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D67D7010>]}
[0m00:17:33.949166 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:17:34.338736 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m00:17:34.595737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:17:34.595737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:17:34.605737 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m00:17:34.656736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b5c11f1-dfcc-4dc1-9d93-f773cbdda1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D9139F30>]}
[0m00:17:34.778741 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:17:34.782740 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:17:34.814740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b5c11f1-dfcc-4dc1-9d93-f773cbdda1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D912C5B0>]}
[0m00:17:34.815738 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m00:17:34.816741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b5c11f1-dfcc-4dc1-9d93-f773cbdda1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D912C4F0>]}
[0m00:17:34.818739 [info ] [MainThread]: 
[0m00:17:34.819738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:17:34.820738 [info ] [MainThread]: 
[0m00:17:34.821739 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:34.823740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m00:17:34.939743 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m00:17:34.940738 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m00:17:34.941742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:35.772930 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.831 seconds
[0m00:17:35.792565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m00:17:35.800573 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m00:17:35.812572 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m00:17:35.816626 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m00:17:35.817573 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m00:17:35.818096 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m00:17:35.818096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:35.819104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:36.302776 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.484 seconds
[0m00:17:36.308846 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.490 seconds
[0m00:17:36.325205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b5c11f1-dfcc-4dc1-9d93-f773cbdda1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D7B726E0>]}
[0m00:17:36.334610 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m00:17:36.335612 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING_staging.stg_customers ................... [RUN]
[0m00:17:36.336615 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m00:17:36.337652 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m00:17:36.350658 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m00:17:36.351614 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m00:17:36.387658 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m00:17:36.389614 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m00:17:36.390610 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace   view finance_db.L1_LANDING_staging.stg_customers
  
  
  
  
  as (
    

select 
id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m00:17:36.390610 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:17:36.812340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff5d-0000-a3c7-0000-a17900045232
[0m00:17:36.813374 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
[0m00:17:36.816339 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m00:17:36.819373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b5c11f1-dfcc-4dc1-9d93-f773cbdda1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D987B5B0>]}
[0m00:17:36.820339 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING_staging.stg_customers .......... [[31mERROR[0m in 0.48s]
[0m00:17:36.822338 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m00:17:36.822338 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql.
[0m00:17:36.825341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:36.825341 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m00:17:36.826341 [debug] [MainThread]: On list_finance_db: Close
[0m00:17:36.895062 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m00:17:36.896063 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m00:17:36.969166 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m00:17:36.970137 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m00:17:37.043090 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m00:17:37.043090 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m00:17:37.149467 [info ] [MainThread]: 
[0m00:17:37.150467 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m00:17:37.152553 [debug] [MainThread]: Command end result
[0m00:17:37.185509 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:17:37.187510 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:17:37.198525 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m00:17:37.199510 [info ] [MainThread]: 
[0m00:17:37.200508 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:17:37.201465 [info ] [MainThread]: 
[0m00:17:37.202472 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m00:17:37.203476 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m00:17:37.204476 [info ] [MainThread]: 
[0m00:17:37.205475 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\staging\stg_customers.sql
[0m00:17:37.206476 [info ] [MainThread]: 
[0m00:17:37.207472 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:17:37.208509 [debug] [MainThread]: Command `dbt run` failed at 00:17:37.208509 after 4.24 seconds
[0m00:17:37.209489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D5E256C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D67D6EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234D60D93C0>]}
[0m00:17:37.209489 [debug] [MainThread]: Flushing usage events
[0m00:17:37.908833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:22:34.482476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A3D5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0C638430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0C638250>]}


============================== 00:22:34.487479 | 8db6897b-fd36-40b5-b4ff-337a2d471c9b ==============================
[0m00:22:34.487479 [info ] [MainThread]: Running with dbt=1.10.5
[0m00:22:34.489438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_customers.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:22:35.280704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8db6897b-fd36-40b5-b4ff-337a2d471c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0BD56980>]}
[0m00:22:35.380697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8db6897b-fd36-40b5-b4ff-337a2d471c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0D0C8250>]}
[0m00:22:35.383703 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:22:35.770699 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m00:22:35.996699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:35.997699 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:36.007699 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m00:22:36.062704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8db6897b-fd36-40b5-b4ff-337a2d471c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0E6B9F90>]}
[0m00:22:36.187704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:22:36.191707 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:22:36.227355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8db6897b-fd36-40b5-b4ff-337a2d471c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0E6BA3B0>]}
[0m00:22:36.228355 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m00:22:36.229355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db6897b-fd36-40b5-b4ff-337a2d471c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0E6BA2F0>]}
[0m00:22:36.231400 [info ] [MainThread]: 
[0m00:22:36.232401 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:22:36.233357 [info ] [MainThread]: 
[0m00:22:36.235358 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:22:36.237360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m00:22:36.336269 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m00:22:36.336269 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m00:22:36.337269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:36.954172 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.617 seconds
[0m00:22:36.964245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m00:22:36.965420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m00:22:36.983692 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m00:22:36.987651 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m00:22:36.988646 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m00:22:36.988646 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m00:22:36.989702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:36.989702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:37.418966 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.429 seconds
[0m00:22:37.449560 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.459 seconds
[0m00:22:37.459661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db6897b-fd36-40b5-b4ff-337a2d471c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0E6BA350>]}
[0m00:22:37.478220 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m00:22:37.480257 [info ] [Thread-1 (]: 1 of 1 START sql view model L1_LANDING_staging.stg_customers ................... [RUN]
[0m00:22:37.482259 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m00:22:37.484254 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m00:22:37.498203 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m00:22:37.500204 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m00:22:37.536252 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m00:22:37.538255 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m00:22:37.539249 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace   view finance_db.L1_LANDING_staging.stg_customers
  
  
  
  
  as (
    

select 
    id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m00:22:37.540256 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:22:37.848097 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff62-0000-a3c7-0000-a179000452a2
[0m00:22:37.850070 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
[0m00:22:37.855131 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m00:22:37.859555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8db6897b-fd36-40b5-b4ff-337a2d471c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0EDC7610>]}
[0m00:22:37.861564 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model L1_LANDING_staging.stg_customers .......... [[31mERROR[0m in 0.37s]
[0m00:22:37.863262 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m00:22:37.864222 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql.
[0m00:22:37.867215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:37.868214 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m00:22:37.868214 [debug] [MainThread]: On list_finance_db: Close
[0m00:22:37.941453 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m00:22:37.942447 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m00:22:38.049884 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m00:22:38.050927 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m00:22:38.127371 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m00:22:38.128372 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m00:22:38.224572 [info ] [MainThread]: 
[0m00:22:38.225515 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m00:22:38.226525 [debug] [MainThread]: Command end result
[0m00:22:38.258526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:22:38.261529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:22:38.271526 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m00:22:38.272528 [info ] [MainThread]: 
[0m00:22:38.273525 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:22:38.274527 [info ] [MainThread]: 
[0m00:22:38.275577 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m00:22:38.276525 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m00:22:38.277525 [info ] [MainThread]: 
[0m00:22:38.278523 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\staging\stg_customers.sql
[0m00:22:38.278523 [info ] [MainThread]: 
[0m00:22:38.279533 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:22:38.281566 [debug] [MainThread]: Command `dbt run` failed at 00:22:38.281566 after 3.92 seconds
[0m00:22:38.282522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A3D5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0BD57B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0B6754E0>]}
[0m00:22:38.282522 [debug] [MainThread]: Flushing usage events
[0m00:22:39.028035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:22:45.984951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9855C56F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A987820430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A987820250>]}


============================== 00:22:45.989626 | 6314498c-69b6-4e25-b69b-6e0e45901b02 ==============================
[0m00:22:45.989626 [info ] [MainThread]: Running with dbt=1.10.5
[0m00:22:45.990624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:22:46.745521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6314498c-69b6-4e25-b69b-6e0e45901b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9868661D0>]}
[0m00:22:46.830520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6314498c-69b6-4e25-b69b-6e0e45901b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9882BF0D0>]}
[0m00:22:46.833523 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:22:47.212066 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m00:22:47.447688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:47.447688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:47.457688 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m00:22:47.507684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6314498c-69b6-4e25-b69b-6e0e45901b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9898ADF00>]}
[0m00:22:47.626640 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:22:47.629683 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:22:47.665831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6314498c-69b6-4e25-b69b-6e0e45901b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9898AD1E0>]}
[0m00:22:47.666874 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m00:22:47.667881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6314498c-69b6-4e25-b69b-6e0e45901b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9898AE110>]}
[0m00:22:47.669874 [info ] [MainThread]: 
[0m00:22:47.670830 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:22:47.671830 [info ] [MainThread]: 
[0m00:22:47.672877 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:22:47.681832 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m00:22:47.697878 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m00:22:47.782644 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m00:22:47.783694 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m00:22:47.784647 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m00:22:47.785516 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m00:22:47.785516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:47.786524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:48.387683 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.601 seconds
[0m00:22:48.388698 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.603 seconds
[0m00:22:48.394656 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m00:22:48.410707 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m00:22:48.411695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m00:22:48.412657 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m00:22:48.416252 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m00:22:48.417252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:48.417252 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m00:22:48.421399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:48.710547 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.289 seconds
[0m00:22:48.714609 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.298 seconds
[0m00:22:48.731553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6314498c-69b6-4e25-b69b-6e0e45901b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9899946A0>]}
[0m00:22:48.740669 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m00:22:48.741668 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m00:22:48.742712 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m00:22:48.743716 [info ] [Thread-1 (]: 1 of 5 START sql view model L1_LANDING_staging.stg_customers ................... [RUN]
[0m00:22:48.745672 [info ] [Thread-2 (]: 2 of 5 START sql view model L1_LANDING_staging.stg_orders ...................... [RUN]
[0m00:22:48.746674 [info ] [Thread-3 (]: 3 of 5 START sql view model L1_LANDING_staging.stg_payments .................... [RUN]
[0m00:22:48.748667 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m00:22:48.749671 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m00:22:48.750677 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m00:22:48.751715 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m00:22:48.752923 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m00:22:48.753934 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m00:22:48.770933 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m00:22:48.776934 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m00:22:48.783930 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m00:22:48.785931 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m00:22:48.801938 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m00:22:48.834931 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m00:22:48.839929 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m00:22:48.840931 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m00:22:48.847931 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m00:22:48.846931 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m00:22:48.849930 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace   view finance_db.L1_LANDING_staging.stg_customers
  
  
  
  
  as (
    

select 
    id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m00:22:48.850931 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m00:22:48.852935 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:22:48.853929 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace   view finance_db.L1_LANDING_staging.stg_orders
  
  
  
  
  as (
    

select * from finance_db.L1_LANDING.ORDERS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m00:22:48.854936 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m00:22:48.857929 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:22:48.860931 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace   view finance_db.L1_LANDING_staging.stg_payments
  
  
  
  
  as (
    

select * from finance_db.L1_LANDING.PAYMENTS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m00:22:48.864932 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:22:49.140930 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bdff62-0000-a3c7-0000-a179000452b2
[0m00:22:49.141931 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdff62-0000-a3b5-0000-a17900041db2
[0m00:22:49.142932 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FINANCE_DB.L1_LANDING.ORDERS' does not exist or not authorized.
[0m00:22:49.143931 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
[0m00:22:49.148935 [debug] [Thread-2 (]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.ORDERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_orders.sql
[0m00:22:49.152930 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m00:22:49.153931 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6314498c-69b6-4e25-b69b-6e0e45901b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A985419AB0>]}
[0m00:22:49.154930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6314498c-69b6-4e25-b69b-6e0e45901b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A989F04B20>]}
[0m00:22:49.155932 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model L1_LANDING_staging.stg_orders ............. [[31mERROR[0m in 0.40s]
[0m00:22:49.156932 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model L1_LANDING_staging.stg_customers .......... [[31mERROR[0m in 0.41s]
[0m00:22:49.158933 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m00:22:49.159934 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m00:22:49.161930 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models\staging\stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.ORDERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_orders.sql.
[0m00:22:49.163930 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql.
[0m00:22:49.215936 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bdff62-0000-a353-0000-a1790003dfe6
[0m00:22:49.216931 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FINANCE_DB.L1_LANDING.PAYMENTS' does not exist or not authorized.
[0m00:22:49.221934 [debug] [Thread-3 (]: Database Error in model stg_payments (models\staging\stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.PAYMENTS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_payments.sql
[0m00:22:49.223933 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6314498c-69b6-4e25-b69b-6e0e45901b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A98A043A60>]}
[0m00:22:49.225932 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model L1_LANDING_staging.stg_payments ........... [[31mERROR[0m in 0.47s]
[0m00:22:49.229933 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m00:22:49.249933 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.stg_payments' to be skipped because of status 'error'.  Reason: Database Error in model stg_payments (models\staging\stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.PAYMENTS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_payments.sql.
[0m00:22:49.251932 [debug] [Thread-4 (]: Began running node model.snow_dbt.customer_orders
[0m00:22:49.252934 [debug] [Thread-2 (]: Began running node model.snow_dbt.fct_customer_orders
[0m00:22:49.254935 [info ] [Thread-4 (]: 4 of 5 SKIP relation L1_LANDING.customer_orders ................................ [[33mSKIP[0m]
[0m00:22:49.260935 [debug] [Thread-4 (]: Finished running node model.snow_dbt.customer_orders
[0m00:22:49.255932 [info ] [Thread-2 (]: 5 of 5 SKIP relation L1_LANDING.fct_customer_orders ............................ [[33mSKIP[0m]
[0m00:22:49.263934 [debug] [Thread-2 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m00:22:49.267933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:49.268933 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m00:22:49.269936 [debug] [MainThread]: On list_finance_db: Close
[0m00:22:49.363932 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m00:22:49.365931 [debug] [MainThread]: On list_finance_db: Close
[0m00:22:49.447932 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m00:22:49.448931 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m00:22:49.543929 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m00:22:49.544929 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m00:22:49.638933 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m00:22:49.639930 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m00:22:49.711931 [debug] [MainThread]: Connection 'model.snow_dbt.stg_orders' was left open.
[0m00:22:49.712931 [debug] [MainThread]: On model.snow_dbt.stg_orders: Close
[0m00:22:49.807931 [debug] [MainThread]: Connection 'model.snow_dbt.stg_payments' was left open.
[0m00:22:49.807931 [debug] [MainThread]: On model.snow_dbt.stg_payments: Close
[0m00:22:49.884929 [info ] [MainThread]: 
[0m00:22:49.885931 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m00:22:49.888931 [debug] [MainThread]: Command end result
[0m00:22:49.934934 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:22:49.938936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:22:49.951932 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m00:22:49.952930 [info ] [MainThread]: 
[0m00:22:49.953929 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:22:49.954935 [info ] [MainThread]: 
[0m00:22:49.955936 [error] [MainThread]: [31mFailure in model stg_orders (models\staging\stg_orders.sql)[0m
[0m00:22:49.956930 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.ORDERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_orders.sql
[0m00:22:49.957935 [info ] [MainThread]: 
[0m00:22:49.959932 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\staging\stg_orders.sql
[0m00:22:49.961935 [info ] [MainThread]: 
[0m00:22:49.963936 [error] [MainThread]: [31mFailure in model stg_customers (models\staging\stg_customers.sql)[0m
[0m00:22:49.965934 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_customers.sql
[0m00:22:49.967933 [info ] [MainThread]: 
[0m00:22:49.969936 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\staging\stg_customers.sql
[0m00:22:49.971932 [info ] [MainThread]: 
[0m00:22:49.972934 [error] [MainThread]: [31mFailure in model stg_payments (models\staging\stg_payments.sql)[0m
[0m00:22:49.974933 [error] [MainThread]:   Database Error in model stg_payments (models\staging\stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'FINANCE_DB.L1_LANDING.PAYMENTS' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\staging\stg_payments.sql
[0m00:22:49.975934 [info ] [MainThread]: 
[0m00:22:49.976932 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\staging\stg_payments.sql
[0m00:22:49.977934 [info ] [MainThread]: 
[0m00:22:49.977934 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 NO-OP=0 TOTAL=5
[0m00:22:49.979935 [debug] [MainThread]: Command `dbt run` failed at 00:22:49.979935 after 4.10 seconds
[0m00:22:49.979935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9855C56F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9882BF0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9868661D0>]}
[0m00:22:49.980933 [debug] [MainThread]: Flushing usage events
[0m00:22:50.688708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:32:26.106313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F48055660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4A2B87F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4A2B8610>]}


============================== 00:32:26.111353 | 83c91f84-6860-412d-86b4-87a58dbd9d8b ==============================
[0m00:32:26.111353 [info ] [MainThread]: Running with dbt=1.10.5
[0m00:32:26.113312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:32:26.849976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4AEB9B10>]}
[0m00:32:26.937969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F492F6380>]}
[0m00:32:26.940820 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:32:27.334081 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m00:32:27.558090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:32:27.559085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:32:27.569074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m00:32:27.619082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4C339E70>]}
[0m00:32:27.743031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:32:27.747033 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:32:27.783003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4C2EFCD0>]}
[0m00:32:27.785001 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m00:32:27.785001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4C2EF2E0>]}
[0m00:32:27.788044 [info ] [MainThread]: 
[0m00:32:27.789004 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:32:27.790004 [info ] [MainThread]: 
[0m00:32:27.791008 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:32:27.800007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m00:32:27.812042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m00:32:27.900052 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m00:32:27.901054 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m00:32:27.902005 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m00:32:27.903029 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m00:32:27.903029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:27.904004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:28.743902 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.840 seconds
[0m00:32:28.760147 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.856 seconds
[0m00:32:28.767528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m00:32:28.776586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING_staging'
[0m00:32:28.788643 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m00:32:28.792591 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING_staging"
[0m00:32:28.793686 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m00:32:28.794514 [debug] [ThreadPool]: On list_finance_db_L1_LANDING_staging: show objects in finance_db.L1_LANDING_staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING_staging"} */;
[0m00:32:28.795139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:28.795833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:29.121599 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.327 seconds
[0m00:32:29.265149 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.469 seconds
[0m00:32:29.274143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4C342BC0>]}
[0m00:32:29.285183 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m00:32:29.286140 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m00:32:29.287145 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m00:32:29.288149 [info ] [Thread-1 (]: 1 of 5 START sql table model L1_LANDING.stg_customers .......................... [RUN]
[0m00:32:29.290186 [info ] [Thread-2 (]: 2 of 5 START sql table model L1_LANDING.stg_orders ............................. [RUN]
[0m00:32:29.291140 [info ] [Thread-3 (]: 3 of 5 START sql view model L1_LANDING_staging.stg_payments .................... [RUN]
[0m00:32:29.292144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m00:32:29.294139 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m00:32:29.294139 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m00:32:29.295144 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m00:32:29.296139 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m00:32:29.297139 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m00:32:29.312142 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m00:32:29.320138 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m00:32:29.330140 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m00:32:29.333141 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m00:32:29.334137 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m00:32:29.418136 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m00:32:29.439136 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m00:32:29.440136 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m00:32:29.469183 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m00:32:29.472137 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m00:32:29.473140 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m00:32:29.474136 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace transient table finance_db.L1_LANDING.stg_orders
    
    
    
    as (

select * from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m00:32:29.475136 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m00:32:29.476143 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace transient table finance_db.L1_LANDING.stg_customers
    
    
    
    as (

select 
    id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m00:32:29.477141 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:32:29.478137 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace   view finance_db.L1_LANDING_staging.stg_payments
  
  
  
  
  as (
    

select * from finance_db.L1_LANDING.PAYMENTS
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m00:32:29.479137 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:32:29.482183 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:32:29.957502 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m00:32:30.001495 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F465C0D60>]}
[0m00:32:30.003495 [info ] [Thread-3 (]: 3 of 5 OK created sql view model L1_LANDING_staging.stg_payments ............... [[32mSUCCESS 1[0m in 0.70s]
[0m00:32:30.006496 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m00:32:30.933814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.454 seconds
[0m00:32:30.944787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4C89CDF0>]}
[0m00:32:30.947737 [info ] [Thread-1 (]: 1 of 5 OK created sql table model L1_LANDING.stg_customers ..................... [[32mSUCCESS 1[0m in 1.65s]
[0m00:32:30.950736 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m00:32:31.008024 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.531 seconds
[0m00:32:31.012036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4CB33DC0>]}
[0m00:32:31.013037 [info ] [Thread-2 (]: 2 of 5 OK created sql table model L1_LANDING.stg_orders ........................ [[32mSUCCESS 1[0m in 1.72s]
[0m00:32:31.014035 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m00:32:31.015648 [debug] [Thread-4 (]: Began running node model.snow_dbt.customer_orders
[0m00:32:31.015648 [debug] [Thread-3 (]: Began running node model.snow_dbt.fct_customer_orders
[0m00:32:31.016660 [info ] [Thread-4 (]: 4 of 5 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m00:32:31.017715 [info ] [Thread-3 (]: 5 of 5 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m00:32:31.019654 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m00:32:31.019654 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.snow_dbt.stg_payments, now model.snow_dbt.fct_customer_orders)
[0m00:32:31.020661 [debug] [Thread-4 (]: Began compiling node model.snow_dbt.customer_orders
[0m00:32:31.021699 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m00:32:31.028654 [debug] [Thread-4 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m00:32:31.033653 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m00:32:31.035658 [debug] [Thread-4 (]: Began executing node model.snow_dbt.customer_orders
[0m00:32:31.040658 [debug] [Thread-4 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m00:32:31.041655 [debug] [Thread-3 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m00:32:31.046659 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m00:32:31.050695 [debug] [Thread-4 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m00:32:31.054701 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m00:32:31.054701 [debug] [Thread-4 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status

from finance_db.L1_LANDING.stg_orders orders

-- Clean join: customers table, select only necessary fields
join (
    select 
        id,
        givenname,
        surname,
        full_name
    from finance_db.L1_LANDING.stg_customers
) customers
on orders.user_id = customers.id

-- customer order history CTE - cleaned to avoid * and ambiguous fields
join (
    select 
        b.id as customer_id,
        b.givenname,
        b.surname,
        b.full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
            nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
        select 
            row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
        from finance_db.L1_LANDING.stg_orders
    ) a

    join (
        select 
            id,
            givenname,
            surname,
            full_name
        from finance_db.L1_LANDING.stg_customers
    ) b
    on a.user_id = b.id

    left join finance_db.L1_LANDING_staging.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.givenname, b.surname , b.full_name
) customer_order_history
on orders.user_id = customer_order_history.customer_id

left join finance_db.L1_LANDING_staging.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m00:32:31.056662 [debug] [Thread-3 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 
base_customers as (select * from finance_db.L1_LANDING.stg_customers),
orders as (select * from finance_db.L1_LANDING.stg_orders),
payments as (select * from finance_db.L1_LANDING_staging.stg_payments),

-- Logical 
customers as ( 
    select 
        id,
        givenname,
        surname,
        full_name
    from base_customers
),
a as (        
    select 
           row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
    from orders
),

customer_order_history as (
     select 
        customers.id as customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
        nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids
        from a
        join customers
        on a.user_id = customers.id
        left outer join payments c
        on a.id = c.orderid
        where a.status NOT IN ('pending') and c.status != 'fail'
        group by customers.id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
    from orders 
    join customers 
    on orders.user_id = customers.id
    join customer_order_history
    on orders.user_id = customer_order_history.customer_id
    left join payments
    on orders.id = payments.orderid 
    where payments.status != 'fail'
)
select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m00:32:31.057661 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:32:31.523340 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m00:32:31.535429 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4CBEA0B0>]}
[0m00:32:31.537331 [info ] [Thread-4 (]: 4 of 5 OK created sql view model L1_LANDING.customer_orders .................... [[32mSUCCESS 1[0m in 0.52s]
[0m00:32:31.540335 [debug] [Thread-4 (]: Finished running node model.snow_dbt.customer_orders
[0m00:32:32.368936 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.310 seconds
[0m00:32:32.372975 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c91f84-6860-412d-86b4-87a58dbd9d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4CBFEAA0>]}
[0m00:32:32.373942 [info ] [Thread-3 (]: 5 of 5 OK created sql table model L1_LANDING.fct_customer_orders ............... [[32mSUCCESS 1[0m in 1.35s]
[0m00:32:32.374931 [debug] [Thread-3 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m00:32:32.376933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:32:32.377933 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m00:32:32.378931 [debug] [MainThread]: On list_finance_db: Close
[0m00:32:32.461547 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m00:32:32.462552 [debug] [MainThread]: On list_finance_db: Close
[0m00:32:32.538783 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m00:32:32.539781 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m00:32:32.642240 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING_staging' was left open.
[0m00:32:32.642240 [debug] [MainThread]: On list_finance_db_L1_LANDING_staging: Close
[0m00:32:32.713192 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m00:32:32.714190 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m00:32:32.789217 [debug] [MainThread]: Connection 'model.snow_dbt.stg_orders' was left open.
[0m00:32:32.791217 [debug] [MainThread]: On model.snow_dbt.stg_orders: Close
[0m00:32:32.858271 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m00:32:32.859310 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m00:32:32.948187 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m00:32:32.949153 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m00:32:33.027899 [info ] [MainThread]: 
[0m00:32:33.029858 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m00:32:33.031860 [debug] [MainThread]: Command end result
[0m00:32:33.126855 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m00:32:33.129896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m00:32:33.144421 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m00:32:33.145431 [info ] [MainThread]: 
[0m00:32:33.146175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:32:33.147181 [info ] [MainThread]: 
[0m00:32:33.148183 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m00:32:33.149182 [debug] [MainThread]: Command `dbt run` succeeded at 00:32:33.149182 after 7.18 seconds
[0m00:32:33.150226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F48055660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F480D4F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4CB22B90>]}
[0m00:32:33.150226 [debug] [MainThread]: Flushing usage events
[0m00:32:33.974064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:33.758025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB5975690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB6C00400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB6C00220>]}


============================== 17:32:33.765369 | ff84097e-982d-415c-a375-f89236a53c41 ==============================
[0m17:32:33.765369 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:32:33.767333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:32:35.563080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB6A44B50>]}
[0m17:32:35.678635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB7690400>]}
[0m17:32:35.682636 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:32:36.376215 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m17:32:36.682213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:36.684213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:36.699215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m17:32:36.769254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB8C8DEA0>]}
[0m17:32:36.940214 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:32:36.969213 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:32:37.016085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB8C3E7D0>]}
[0m17:32:37.017083 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m17:32:37.017503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB8C3F790>]}
[0m17:32:37.019554 [info ] [MainThread]: 
[0m17:32:37.020552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:32:37.021512 [info ] [MainThread]: 
[0m17:32:37.022511 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:32:37.031513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m17:32:40.469007 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m17:32:40.470006 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m17:32:40.471005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:41.342642 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.872 seconds
[0m17:32:41.346653 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m17:32:41.363653 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m17:32:41.364654 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m17:32:41.365653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:41.672027 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.307 seconds
[0m17:32:41.677976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB87B3EB0>]}
[0m17:32:41.687973 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m17:32:41.688981 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m17:32:41.689973 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m17:32:41.691019 [info ] [Thread-1 (]: 1 of 5 START sql table model L1_LANDING.stg_customers .......................... [RUN]
[0m17:32:41.692975 [info ] [Thread-2 (]: 2 of 5 START sql table model L1_LANDING.stg_orders ............................. [RUN]
[0m17:32:41.693975 [info ] [Thread-3 (]: 3 of 5 START sql table model L1_LANDING.stg_payments ........................... [RUN]
[0m17:32:41.695015 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m17:32:41.696975 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m17:32:41.697676 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m17:32:41.698683 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m17:32:41.699744 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m17:32:41.700684 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m17:32:41.715725 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m17:32:41.720723 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m17:32:41.725682 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m17:32:41.727873 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m17:32:41.728875 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m17:32:41.760914 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m17:32:41.769916 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m17:32:41.776870 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m17:32:41.781915 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m17:32:41.783870 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m17:32:41.784871 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m17:32:41.785801 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace transient table finance_db.L1_LANDING.stg_customers
    
    
    
    as (

select 
    id as customer_id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS



 -- customers as ( 
--     select 
--         id as customer_id,
--         givenname,
--         surname,
--         full_name
--     from base_customers
-- ),
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m17:32:41.786450 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m17:32:41.787457 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace transient table finance_db.L1_LANDING.stg_orders
    
    
    
    as (

select
       id as order_id,
       user_id as customer_id,
       order_date,
       status as order_status,
       row_number() over (partition by user_id order by order_date, id) as user_order_seq
 from finance_db.L1_LANDING.ORDERS 


-- orders as (        
--     select 
--             id as order_id,
--             user_id as customer_id,
--             order_date,
--             status as order_status,
--             row_number() over (partition by user_id order by order_date, id) as user_order_seq
--     from base_orders
-- ),
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m17:32:41.788497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:41.789457 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace transient table finance_db.L1_LANDING.stg_payments
    
    
    
    as (

select   id as payment_id,
         paymentmethod,
         orderid as order_id,
         round(amount / 100.0, 2) as payment_amount,
         status as payment_status
from finance_db.L1_LANDING.PAYMENTS



-- payments as (
--     select 
--         id as payment_id,
--         paymentmethod,
--         orderid as order_id,
--         round(amount / 100.0, 2) as payment_amount,
--         status as payment_status
--     from base_payments
-- ),
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m17:32:41.790457 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:32:41.794456 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:32:44.631330 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.840 seconds
[0m17:32:44.635239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.846 seconds
[0m17:32:44.692547 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.898 seconds
[0m17:32:44.698547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB2F6FFA0>]}
[0m17:32:44.699503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB8C68580>]}
[0m17:32:44.699503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB87B1690>]}
[0m17:32:44.700548 [info ] [Thread-2 (]: 2 of 5 OK created sql table model L1_LANDING.stg_orders ........................ [[32mSUCCESS 1[0m in 2.99s]
[0m17:32:44.701538 [info ] [Thread-1 (]: 1 of 5 OK created sql table model L1_LANDING.stg_customers ..................... [[32mSUCCESS 1[0m in 3.00s]
[0m17:32:44.702845 [info ] [Thread-3 (]: 3 of 5 OK created sql table model L1_LANDING.stg_payments ...................... [[32mSUCCESS 1[0m in 3.00s]
[0m17:32:44.704444 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m17:32:44.705450 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m17:32:44.706485 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m17:32:44.709452 [debug] [Thread-4 (]: Began running node model.snow_dbt.customer_orders
[0m17:32:44.709452 [debug] [Thread-2 (]: Began running node model.snow_dbt.fct_customer_orders
[0m17:32:44.710452 [info ] [Thread-4 (]: 4 of 5 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m17:32:44.712458 [info ] [Thread-2 (]: 5 of 5 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m17:32:44.713455 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m17:32:44.714451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.snow_dbt.stg_orders, now model.snow_dbt.fct_customer_orders)
[0m17:32:44.715451 [debug] [Thread-4 (]: Began compiling node model.snow_dbt.customer_orders
[0m17:32:44.716499 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m17:32:44.723453 [debug] [Thread-4 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m17:32:44.729449 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m17:32:44.730494 [debug] [Thread-4 (]: Began executing node model.snow_dbt.customer_orders
[0m17:32:44.752494 [debug] [Thread-2 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m17:32:44.761494 [debug] [Thread-4 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m17:32:44.765450 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m17:32:44.770225 [debug] [Thread-4 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m17:32:44.770225 [debug] [Thread-4 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status

from finance_db.L1_LANDING.stg_orders orders

-- Clean join: customers table, select only necessary fields
join (
    select 
        id,
        givenname,
        surname,
        full_name
    from finance_db.L1_LANDING.stg_customers
) customers
on orders.user_id = customers.id

-- customer order history CTE - cleaned to avoid * and ambiguous fields
join (
    select 
        b.id as customer_id,
        b.givenname,
        b.surname,
        b.full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
            nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
        select 
            row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
        from finance_db.L1_LANDING.stg_orders
    ) a

    join (
        select 
            id,
            givenname,
            surname,
            full_name
        from finance_db.L1_LANDING.stg_customers
    ) b
    on a.user_id = b.id

    left join finance_db.L1_LANDING.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.givenname, b.surname , b.full_name
) customer_order_history
on orders.user_id = customer_order_history.customer_id

left join finance_db.L1_LANDING.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m17:32:44.775273 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m17:32:44.776276 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:32:44.776828 [debug] [Thread-2 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 
base_customers as (select * from finance_db.L1_LANDING.stg_customers),
base_orders as (select * from finance_db.L1_LANDING.stg_orders),
base_payments as (select * from finance_db.L1_LANDING.stg_payments),

-- staging 
customers as ( 
    select 
        id as customer_id,
        givenname,
        surname,
        full_name
    from base_customers
),
orders as (        
    select 
            id as order_id,
            user_id as customer_id,
            order_date,
            status as order_status,
            row_number() over (partition by user_id order by order_date, id) as user_order_seq
    from base_orders
),
payments as (
    select 
        id as payment_id,
        paymentmethod,
        orderid as order_id,
        round(amount / 100.0, 2) as payment_amount,
        status as payment_status
    from base_payments
),
--MARTS
customer_order_history as (
     select 
        customers.customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) as first_order_date,
        min(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as first_non_returned_order_date,
        max(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(orders.user_order_seq), 0) as order_count,
        coalesce(count(case when orders.order_status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end as total_lifetime_value,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) 
        /
        nullif(count(case when orders.order_status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct order.order_id) as order_ids
        from a
        join customers
        on orders.customer_id = customers.customer_id
        left outer join payments
        on order.order_id = payments.order_id
        where orders.order_status NOT IN ('pending') and payments.payment_status != 'fail'
        group by customers.id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( select 
    order.order_id ,
    orders.customer_id ,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    payments.payment_amount as order_value_dollars,
    orders.order_status ,
    payments.payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id
    left join payments
    on order.order_id = payments.order_id
    where payments.payment_status != 'fail'
)
select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m17:32:45.110914 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01be0368-0000-a3b5-0000-a17900041ffe
[0m17:32:45.112926 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 50 at position 119 unexpected 'as'.
syntax error line 54 at position 27 unexpected 'order'.
syntax error line 54 at position 32 unexpected '.'.
syntax error line 54 at position 43 unexpected 'as'.
syntax error line 57 at position 11 unexpected 'orders'.
[0m17:32:45.114912 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01be0368-0000-a3b5-0000-a17900042002
[0m17:32:45.115868 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'ID'
[0m17:32:45.127868 [debug] [Thread-4 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'ID'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m17:32:45.128908 [debug] [Thread-2 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 119 unexpected 'as'.
  syntax error line 54 at position 27 unexpected 'order'.
  syntax error line 54 at position 32 unexpected '.'.
  syntax error line 54 at position 43 unexpected 'as'.
  syntax error line 57 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:32:45.129910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB47F8190>]}
[0m17:32:45.130909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff84097e-982d-415c-a375-f89236a53c41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB93DB9D0>]}
[0m17:32:45.131908 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.42s]
[0m17:32:45.132909 [error] [Thread-2 (]: 5 of 5 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 0.42s]
[0m17:32:45.134911 [debug] [Thread-4 (]: Finished running node model.snow_dbt.customer_orders
[0m17:32:45.135869 [debug] [Thread-2 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m17:32:45.136866 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'ID'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m17:32:45.138869 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 119 unexpected 'as'.
  syntax error line 54 at position 27 unexpected 'order'.
  syntax error line 54 at position 32 unexpected '.'.
  syntax error line 54 at position 43 unexpected 'as'.
  syntax error line 57 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m17:32:45.139868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:45.140912 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m17:32:45.141913 [debug] [MainThread]: On list_finance_db: Close
[0m17:32:45.230155 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m17:32:45.231146 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m17:32:45.311407 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m17:32:45.312407 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m17:32:45.403032 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m17:32:45.404034 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m17:32:45.486635 [debug] [MainThread]: Connection 'model.snow_dbt.stg_payments' was left open.
[0m17:32:45.487639 [debug] [MainThread]: On model.snow_dbt.stg_payments: Close
[0m17:32:45.574635 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m17:32:45.575636 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m17:32:45.661532 [info ] [MainThread]: 
[0m17:32:45.663531 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 8.64 seconds (8.64s).
[0m17:32:45.669540 [debug] [MainThread]: Command end result
[0m17:32:45.780564 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:32:45.783522 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:32:45.793930 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m17:32:45.794939 [info ] [MainThread]: 
[0m17:32:45.794939 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:32:45.795937 [info ] [MainThread]: 
[0m17:32:45.796936 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m17:32:45.797936 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'ID'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m17:32:45.798935 [info ] [MainThread]: 
[0m17:32:45.799939 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m17:32:45.800936 [info ] [MainThread]: 
[0m17:32:45.801936 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m17:32:45.802935 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 119 unexpected 'as'.
  syntax error line 54 at position 27 unexpected 'order'.
  syntax error line 54 at position 32 unexpected '.'.
  syntax error line 54 at position 43 unexpected 'as'.
  syntax error line 57 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:32:45.803983 [info ] [MainThread]: 
[0m17:32:45.805939 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:32:45.805939 [info ] [MainThread]: 
[0m17:32:45.807941 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m17:32:45.808939 [debug] [MainThread]: Command `dbt run` failed at 17:32:45.808939 after 12.19 seconds
[0m17:32:45.809936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB5975690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB5C48AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB300E5F0>]}
[0m17:32:45.810938 [debug] [MainThread]: Flushing usage events
[0m17:32:46.711024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:49.870572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1D7E5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1FA50430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1FA50250>]}


============================== 17:34:49.874630 | 9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a ==============================
[0m17:34:49.874630 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:34:49.876586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:34:50.755240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F20522320>]}
[0m17:34:50.857280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F20522080>]}
[0m17:34:50.859235 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:34:51.330953 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m17:34:51.578471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:51.579471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:51.589467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m17:34:51.642513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F21ADDF60>]}
[0m17:34:51.779471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:34:51.783469 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:34:51.822478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F21AD0550>]}
[0m17:34:51.823476 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m17:34:51.824471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F21AD04F0>]}
[0m17:34:51.827473 [info ] [MainThread]: 
[0m17:34:51.828476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:34:51.829475 [info ] [MainThread]: 
[0m17:34:51.830474 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:34:51.841472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m17:34:51.941548 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m17:34:51.942550 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m17:34:51.943549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:52.795902 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.852 seconds
[0m17:34:52.806834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m17:34:52.827867 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m17:34:52.828868 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m17:34:52.828868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:53.158856 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.330 seconds
[0m17:34:53.163783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2050E710>]}
[0m17:34:53.170603 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m17:34:53.171660 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m17:34:53.172613 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m17:34:53.173658 [info ] [Thread-1 (]: 1 of 5 START sql table model L1_LANDING.stg_customers .......................... [RUN]
[0m17:34:53.174614 [info ] [Thread-2 (]: 2 of 5 START sql table model L1_LANDING.stg_orders ............................. [RUN]
[0m17:34:53.175612 [info ] [Thread-3 (]: 3 of 5 START sql table model L1_LANDING.stg_payments ........................... [RUN]
[0m17:34:53.176610 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m17:34:53.177616 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m17:34:53.178654 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m17:34:53.178654 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m17:34:53.179611 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m17:34:53.180610 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m17:34:53.191609 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m17:34:53.196611 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m17:34:53.202653 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m17:34:53.203611 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m17:34:53.205614 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m17:34:53.232610 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m17:34:53.246658 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m17:34:53.252659 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m17:34:53.257608 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m17:34:53.259620 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m17:34:53.260654 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m17:34:53.261655 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace transient table finance_db.L1_LANDING.stg_customers
    
    
    
    as (

select 
    id as customer_id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m17:34:53.262610 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m17:34:53.263616 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace transient table finance_db.L1_LANDING.stg_orders
    
    
    
    as (

select
       id as order_id,
       user_id as customer_id,
       order_date,
       status as order_status,
       row_number() over (partition by user_id order by order_date, id) as user_order_seq
 from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m17:34:53.264658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:34:53.265611 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace transient table finance_db.L1_LANDING.stg_payments
    
    
    
    as (

select   id as payment_id,
         paymentmethod,
         orderid as order_id,
         round(amount / 100.0, 2) as payment_amount,
         status as payment_status
from finance_db.L1_LANDING.PAYMENTS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m17:34:53.266611 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:34:53.270655 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:34:55.168764 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.902 seconds
[0m17:34:55.178765 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.908 seconds
[0m17:34:55.217770 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F221C7D60>]}
[0m17:34:55.218768 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F22206DD0>]}
[0m17:34:55.219767 [info ] [Thread-2 (]: 2 of 5 OK created sql table model L1_LANDING.stg_orders ........................ [[32mSUCCESS 1[0m in 2.04s]
[0m17:34:55.221764 [info ] [Thread-3 (]: 3 of 5 OK created sql table model L1_LANDING.stg_payments ...................... [[32mSUCCESS 1[0m in 2.04s]
[0m17:34:55.223763 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m17:34:55.224764 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m17:34:55.276762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.012 seconds
[0m17:34:55.279766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2050E710>]}
[0m17:34:55.281772 [info ] [Thread-1 (]: 1 of 5 OK created sql table model L1_LANDING.stg_customers ..................... [[32mSUCCESS 1[0m in 2.10s]
[0m17:34:55.283772 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m17:34:55.284763 [debug] [Thread-4 (]: Began running node model.snow_dbt.customer_orders
[0m17:34:55.286772 [debug] [Thread-2 (]: Began running node model.snow_dbt.fct_customer_orders
[0m17:34:55.287807 [info ] [Thread-4 (]: 4 of 5 START sql view model L1_LANDING.customer_orders ......................... [RUN]
[0m17:34:55.288768 [info ] [Thread-2 (]: 5 of 5 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m17:34:55.289785 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snow_dbt.customer_orders'
[0m17:34:55.290808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.snow_dbt.stg_orders, now model.snow_dbt.fct_customer_orders)
[0m17:34:55.291813 [debug] [Thread-4 (]: Began compiling node model.snow_dbt.customer_orders
[0m17:34:55.292765 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m17:34:55.297814 [debug] [Thread-4 (]: Writing injected SQL for node "model.snow_dbt.customer_orders"
[0m17:34:55.303805 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m17:34:55.305763 [debug] [Thread-4 (]: Began executing node model.snow_dbt.customer_orders
[0m17:34:55.336816 [debug] [Thread-4 (]: Writing runtime sql for node "model.snow_dbt.customer_orders"
[0m17:34:55.337767 [debug] [Thread-2 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m17:34:55.342807 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m17:34:55.345808 [debug] [Thread-4 (]: Using snowflake connection "model.snow_dbt.customer_orders"
[0m17:34:55.349764 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m17:34:55.350765 [debug] [Thread-4 (]: On model.snow_dbt.customer_orders: create or replace   view finance_db.L1_LANDING.customer_orders
  
  
  
  
  as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    round(payments.amount / 100.0, 2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status

from finance_db.L1_LANDING.stg_orders orders

-- Clean join: customers table, select only necessary fields
join (
    select 
        id,
        givenname,
        surname,
        full_name
    from finance_db.L1_LANDING.stg_customers
) customers
on orders.user_id = customers.id

-- customer order history CTE - cleaned to avoid * and ambiguous fields
join (
    select 
        b.id as customer_id,
        b.givenname,
        b.surname,
        b.full_name,
        min(a.order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then a.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(a.user_order_seq), 0) as order_count,
        coalesce(count(case when a.status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then round(c.amount / 100.0, 2) else 0 end) /
            nullif(count(case when a.status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
        select 
            row_number() over (partition by user_id order by order_date, id) as user_order_seq,
            id,
            user_id,
            order_date,
            status
        from finance_db.L1_LANDING.stg_orders
    ) a

    join (
        select 
            id,
            givenname,
            surname,
            full_name
        from finance_db.L1_LANDING.stg_customers
    ) b
    on a.user_id = b.id

    left join finance_db.L1_LANDING.stg_payments c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.givenname, b.surname , b.full_name
) customer_order_history
on orders.user_id = customer_order_history.customer_id

left join finance_db.L1_LANDING.stg_payments payments
on orders.id = payments.orderid

where payments.status != 'fail'
  )
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.customer_orders"} */;
[0m17:34:55.352765 [debug] [Thread-2 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers),
orders as (select * from finance_db.L1_LANDING.stg_orders),
payments as (select * from finance_db.L1_LANDING.stg_payments),

customer_order_history as (
     select 
        customers.customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) as first_order_date,
        min(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as first_non_returned_order_date,
        max(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(orders.user_order_seq), 0) as order_count,
        coalesce(count(case when orders.order_status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end as total_lifetime_value,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) 
        /
        nullif(count(case when orders.order_status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct order.order_id) as order_ids
        from a
        join customers
        on orders.customer_id = customers.customer_id
        left outer join payments
        on order.order_id = payments.order_id
        where orders.order_status NOT IN ('pending') and payments.payment_status != 'fail'
        group by customers.id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( 
    select 
    order.order_id ,
    orders.customer_id ,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    payments.payment_amount as order_value_dollars,
    orders.order_status ,
    payments.payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id
    left join payments
    on order.order_id = payments.order_id
    where payments.payment_status != 'fail'
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m17:34:55.352765 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:34:55.431578 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01be036b-0000-a353-0000-a1790004626e
[0m17:34:55.431578 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 119 unexpected 'as'.
syntax error line 27 at position 27 unexpected 'order'.
syntax error line 27 at position 32 unexpected '.'.
syntax error line 27 at position 43 unexpected 'as'.
syntax error line 30 at position 11 unexpected 'orders'.
[0m17:34:55.434579 [debug] [Thread-2 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 119 unexpected 'as'.
  syntax error line 27 at position 27 unexpected 'order'.
  syntax error line 27 at position 32 unexpected '.'.
  syntax error line 27 at position 43 unexpected 'as'.
  syntax error line 30 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:34:55.435579 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F2229AA40>]}
[0m17:34:55.436586 [error] [Thread-2 (]: 5 of 5 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 0.14s]
[0m17:34:55.446580 [debug] [Thread-2 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m17:34:55.447587 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 119 unexpected 'as'.
  syntax error line 27 at position 27 unexpected 'order'.
  syntax error line 27 at position 32 unexpected '.'.
  syntax error line 27 at position 43 unexpected 'as'.
  syntax error line 30 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m17:34:55.702865 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01be036b-0000-a353-0000-a17900046272
[0m17:34:55.703917 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'ID'
[0m17:34:55.705917 [debug] [Thread-4 (]: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'ID'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m17:34:55.706916 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ecdd0a0-2f1a-470f-9918-938e9e4b0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F221D8580>]}
[0m17:34:55.707915 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model L1_LANDING.customer_orders ................ [[31mERROR[0m in 0.42s]
[0m17:34:55.710003 [debug] [Thread-4 (]: Finished running node model.snow_dbt.customer_orders
[0m17:34:55.711021 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'ID'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql.
[0m17:34:55.713014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:55.714019 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m17:34:55.715017 [debug] [MainThread]: On list_finance_db: Close
[0m17:34:55.795229 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m17:34:55.795229 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m17:34:55.881592 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m17:34:55.882556 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m17:34:55.962252 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m17:34:55.963250 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m17:34:56.049414 [debug] [MainThread]: Connection 'model.snow_dbt.stg_payments' was left open.
[0m17:34:56.051452 [debug] [MainThread]: On model.snow_dbt.stg_payments: Close
[0m17:34:56.148971 [debug] [MainThread]: Connection 'model.snow_dbt.customer_orders' was left open.
[0m17:34:56.151969 [debug] [MainThread]: On model.snow_dbt.customer_orders: Close
[0m17:34:56.241485 [info ] [MainThread]: 
[0m17:34:56.242480 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m17:34:56.245429 [debug] [MainThread]: Command end result
[0m17:34:56.342474 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:34:56.345476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:34:56.355432 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m17:34:56.356431 [info ] [MainThread]: 
[0m17:34:56.357433 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:34:56.358430 [info ] [MainThread]: 
[0m17:34:56.359431 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m17:34:56.360044 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 119 unexpected 'as'.
  syntax error line 27 at position 27 unexpected 'order'.
  syntax error line 27 at position 32 unexpected '.'.
  syntax error line 27 at position 43 unexpected 'as'.
  syntax error line 30 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:34:56.360955 [info ] [MainThread]: 
[0m17:34:56.361963 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:34:56.361963 [info ] [MainThread]: 
[0m17:34:56.362963 [error] [MainThread]: [31mFailure in model customer_orders (models\legacy\customer_orders.sql)[0m
[0m17:34:56.363963 [error] [MainThread]:   Database Error in model customer_orders (models\legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'ID'
  compiled code at target\run\snow_dbt\models\legacy\customer_orders.sql
[0m17:34:56.364963 [info ] [MainThread]: 
[0m17:34:56.365965 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\legacy\customer_orders.sql
[0m17:34:56.366965 [info ] [MainThread]: 
[0m17:34:56.367964 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m17:34:56.369964 [debug] [MainThread]: Command `dbt run` failed at 17:34:56.369964 after 6.62 seconds
[0m17:34:56.370976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1D7E5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F21A4BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1BE947C0>]}
[0m17:34:56.370976 [debug] [MainThread]: Flushing usage events
[0m17:34:57.216466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:54.964181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCBD156F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCCFA0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCCFA0250>]}


============================== 17:35:54.969182 | 90878ef2-7c24-4ec6-8f2f-be7c2c1b742a ==============================
[0m17:35:54.969182 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:35:54.970182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:35:55.977107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCBFE61D0>]}
[0m17:35:56.065113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCDA3F0D0>]}
[0m17:35:56.068109 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:35:56.557111 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m17:35:56.866110 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m17:35:56.867108 [debug] [MainThread]: Partial parsing: deleted file: snow_dbt://models\legacy\customer_orders.sql
[0m17:35:56.993113 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m17:35:57.016113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCF0492A0>]}
[0m17:35:57.142113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:35:57.146109 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:35:57.185109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCEFAAA70>]}
[0m17:35:57.186110 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m17:35:57.187117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCEFA92A0>]}
[0m17:35:57.190108 [info ] [MainThread]: 
[0m17:35:57.191114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:35:57.192113 [info ] [MainThread]: 
[0m17:35:57.194115 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:35:57.208110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m17:35:57.369110 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m17:35:57.370110 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m17:35:57.371108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:57.897071 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.526 seconds
[0m17:35:57.902075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m17:35:57.922085 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m17:35:57.923087 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m17:35:57.924087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:58.244973 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.321 seconds
[0m17:35:58.249969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC9B13D00>]}
[0m17:35:58.255973 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m17:35:58.256976 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m17:35:58.257970 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m17:35:58.258970 [info ] [Thread-1 (]: 1 of 4 START sql table model L1_LANDING.stg_customers .......................... [RUN]
[0m17:35:58.259976 [info ] [Thread-2 (]: 2 of 4 START sql table model L1_LANDING.stg_orders ............................. [RUN]
[0m17:35:58.260971 [info ] [Thread-3 (]: 3 of 4 START sql table model L1_LANDING.stg_payments ........................... [RUN]
[0m17:35:58.262975 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m17:35:58.263984 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m17:35:58.264980 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m17:35:58.265979 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m17:35:58.266980 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m17:35:58.267977 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m17:35:58.279973 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m17:35:58.283979 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m17:35:58.290996 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m17:35:58.292971 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m17:35:58.307977 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m17:35:58.336976 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m17:35:58.337972 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m17:35:58.341970 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m17:35:58.348973 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m17:35:58.349970 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m17:35:58.351971 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace transient table finance_db.L1_LANDING.stg_customers
    
    
    
    as (

select 
    id as customer_id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m17:35:58.352973 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m17:35:58.354973 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m17:35:58.354973 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:35:58.355978 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace transient table finance_db.L1_LANDING.stg_orders
    
    
    
    as (

select
       id as order_id,
       user_id as customer_id,
       order_date,
       status as order_status,
       row_number() over (partition by user_id order by order_date, id) as user_order_seq
 from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m17:35:58.357007 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace transient table finance_db.L1_LANDING.stg_payments
    
    
    
    as (

select   id as payment_id,
         paymentmethod,
         orderid as order_id,
         round(amount / 100.0, 2) as payment_amount,
         status as payment_status
from finance_db.L1_LANDING.PAYMENTS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m17:35:58.360009 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:35:58.361971 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:35:59.863709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.508 seconds
[0m17:35:59.898702 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.539 seconds
[0m17:35:59.902702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCDA5E6B0>]}
[0m17:35:59.903707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC9B13D00>]}
[0m17:35:59.904703 [info ] [Thread-1 (]: 1 of 4 OK created sql table model L1_LANDING.stg_customers ..................... [[32mSUCCESS 1[0m in 1.63s]
[0m17:35:59.905708 [info ] [Thread-2 (]: 2 of 4 OK created sql table model L1_LANDING.stg_orders ........................ [[32mSUCCESS 1[0m in 1.64s]
[0m17:35:59.907703 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m17:35:59.908706 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m17:35:59.961136 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.599 seconds
[0m17:35:59.966129 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCF59AA70>]}
[0m17:35:59.967129 [info ] [Thread-3 (]: 3 of 4 OK created sql table model L1_LANDING.stg_payments ...................... [[32mSUCCESS 1[0m in 1.70s]
[0m17:35:59.968130 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m17:35:59.970129 [debug] [Thread-4 (]: Began running node model.snow_dbt.fct_customer_orders
[0m17:35:59.971131 [info ] [Thread-4 (]: 4 of 4 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m17:35:59.972134 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m17:35:59.973136 [debug] [Thread-4 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m17:35:59.980132 [debug] [Thread-4 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m17:35:59.982130 [debug] [Thread-4 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m17:35:59.987173 [debug] [Thread-4 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m17:35:59.993134 [debug] [Thread-4 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m17:35:59.994132 [debug] [Thread-4 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers),
orders as (select * from finance_db.L1_LANDING.stg_orders),
payments as (select * from finance_db.L1_LANDING.stg_payments),

customer_order_history as (
     select 
        customers.customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) as first_order_date,
        min(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as first_non_returned_order_date,
        max(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(orders.user_order_seq), 0) as order_count,
        coalesce(count(case when orders.order_status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end as total_lifetime_value,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) 
        /
        nullif(count(case when orders.order_status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct order.order_id) as order_ids
        from a
        join customers
        on orders.customer_id = customers.customer_id
        left outer join payments
        on order.order_id = payments.order_id
        where orders.order_status NOT IN ('pending') and payments.payment_status != 'fail'
        group by customers.id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( 
    select 
    order.order_id ,
    orders.customer_id ,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    payments.payment_amount as order_value_dollars,
    orders.order_status ,
    payments.payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id
    left join payments
    on order.order_id = payments.order_id
    where payments.payment_status != 'fail'
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m17:35:59.995134 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:36:00.427412 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01be036c-0000-a353-0000-a17900046276
[0m17:36:00.428412 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 119 unexpected 'as'.
syntax error line 27 at position 27 unexpected 'order'.
syntax error line 27 at position 32 unexpected '.'.
syntax error line 27 at position 43 unexpected 'as'.
syntax error line 30 at position 11 unexpected 'orders'.
[0m17:36:00.430415 [debug] [Thread-4 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 119 unexpected 'as'.
  syntax error line 27 at position 27 unexpected 'order'.
  syntax error line 27 at position 32 unexpected '.'.
  syntax error line 27 at position 43 unexpected 'as'.
  syntax error line 30 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:36:00.431416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90878ef2-7c24-4ec6-8f2f-be7c2c1b742a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCF06F580>]}
[0m17:36:00.432416 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 0.46s]
[0m17:36:00.434411 [debug] [Thread-4 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m17:36:00.435413 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 119 unexpected 'as'.
  syntax error line 27 at position 27 unexpected 'order'.
  syntax error line 27 at position 32 unexpected '.'.
  syntax error line 27 at position 43 unexpected 'as'.
  syntax error line 30 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m17:36:00.437411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:00.437411 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m17:36:00.438409 [debug] [MainThread]: On list_finance_db: Close
[0m17:36:00.520728 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m17:36:00.521749 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m17:36:00.602731 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m17:36:00.603728 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m17:36:00.682806 [debug] [MainThread]: Connection 'model.snow_dbt.stg_orders' was left open.
[0m17:36:00.683808 [debug] [MainThread]: On model.snow_dbt.stg_orders: Close
[0m17:36:00.763813 [debug] [MainThread]: Connection 'model.snow_dbt.stg_payments' was left open.
[0m17:36:00.763813 [debug] [MainThread]: On model.snow_dbt.stg_payments: Close
[0m17:36:00.844969 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m17:36:00.845923 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m17:36:00.926961 [info ] [MainThread]: 
[0m17:36:00.927923 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m17:36:00.930964 [debug] [MainThread]: Command end result
[0m17:36:01.031960 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:36:01.035926 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:36:01.045927 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m17:36:01.046929 [info ] [MainThread]: 
[0m17:36:01.047930 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:36:01.048928 [info ] [MainThread]: 
[0m17:36:01.049929 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m17:36:01.050929 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 119 unexpected 'as'.
  syntax error line 27 at position 27 unexpected 'order'.
  syntax error line 27 at position 32 unexpected '.'.
  syntax error line 27 at position 43 unexpected 'as'.
  syntax error line 30 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:36:01.051930 [info ] [MainThread]: 
[0m17:36:01.052923 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:36:01.053932 [info ] [MainThread]: 
[0m17:36:01.054927 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m17:36:01.055923 [debug] [MainThread]: Command `dbt run` failed at 17:36:01.055923 after 6.26 seconds
[0m17:36:01.056924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCBD156F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCEC2EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCF6C14B0>]}
[0m17:36:01.057926 [debug] [MainThread]: Flushing usage events
[0m17:36:01.723966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:11.606509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6D8F56F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6FB50430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6FB50250>]}


============================== 17:43:11.611503 | e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2 ==============================
[0m17:43:11.611503 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:43:11.612458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:43:12.348963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6EB9A1D0>]}
[0m17:43:12.432963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA705E8580>]}
[0m17:43:12.435010 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:43:12.814863 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m17:43:13.035863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:13.036863 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:13.045858 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m17:43:13.096819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA71BD9840>]}
[0m17:43:13.214820 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:43:13.217821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:43:13.252862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA71B56F80>]}
[0m17:43:13.253861 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m17:43:13.254864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA71B55240>]}
[0m17:43:13.257868 [info ] [MainThread]: 
[0m17:43:13.258868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:43:13.259863 [info ] [MainThread]: 
[0m17:43:13.261862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:13.269865 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m17:43:13.368911 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m17:43:13.369912 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m17:43:13.369912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:14.298856 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.929 seconds
[0m17:43:14.302898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m17:43:14.319852 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m17:43:14.320854 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m17:43:14.320854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:14.627754 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.307 seconds
[0m17:43:14.641718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA7068A320>]}
[0m17:43:14.651089 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m17:43:14.652096 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m17:43:14.653095 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m17:43:14.654097 [info ] [Thread-1 (]: 1 of 4 START sql table model L1_LANDING.stg_customers .......................... [RUN]
[0m17:43:14.655097 [info ] [Thread-2 (]: 2 of 4 START sql table model L1_LANDING.stg_orders ............................. [RUN]
[0m17:43:14.656096 [info ] [Thread-3 (]: 3 of 4 START sql table model L1_LANDING.stg_payments ........................... [RUN]
[0m17:43:14.657096 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m17:43:14.658144 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m17:43:14.659141 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m17:43:14.660098 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m17:43:14.661141 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m17:43:14.662150 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m17:43:14.672148 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m17:43:14.678156 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m17:43:14.683097 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m17:43:14.684099 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m17:43:14.697098 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m17:43:14.732141 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m17:43:14.732141 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m17:43:14.733098 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m17:43:14.738141 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m17:43:14.739141 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m17:43:14.741102 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m17:43:14.742098 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace transient table finance_db.L1_LANDING.stg_orders
    
    
    
    as (

select
       id as order_id,
       user_id as customer_id,
       order_date,
       status as order_status,
       row_number() over (partition by user_id order by order_date, id) as user_order_seq
 from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m17:43:14.743099 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m17:43:14.744100 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace transient table finance_db.L1_LANDING.stg_customers
    
    
    
    as (

select 
    id as customer_id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m17:43:14.745097 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:43:14.745097 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace transient table finance_db.L1_LANDING.stg_payments
    
    
    
    as (

select   id as payment_id,
         paymentmethod,
         orderid as order_id,
         round(amount / 100.0, 2) as payment_amount,
         status as payment_status
from finance_db.L1_LANDING.PAYMENTS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m17:43:14.746141 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:14.750099 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:43:16.419310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.673 seconds
[0m17:43:16.472590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6D6BCBB0>]}
[0m17:43:16.473598 [info ] [Thread-1 (]: 1 of 4 OK created sql table model L1_LANDING.stg_customers ..................... [[32mSUCCESS 1[0m in 1.81s]
[0m17:43:16.474661 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m17:43:16.480683 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.731 seconds
[0m17:43:16.484673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA7068A320>]}
[0m17:43:16.485673 [info ] [Thread-3 (]: 3 of 4 OK created sql table model L1_LANDING.stg_payments ...................... [[32mSUCCESS 1[0m in 1.82s]
[0m17:43:16.486715 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m17:43:16.508377 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.764 seconds
[0m17:43:16.513324 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA72354F40>]}
[0m17:43:16.514324 [info ] [Thread-2 (]: 2 of 4 OK created sql table model L1_LANDING.stg_orders ........................ [[32mSUCCESS 1[0m in 1.85s]
[0m17:43:16.515316 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m17:43:16.516365 [debug] [Thread-4 (]: Began running node model.snow_dbt.fct_customer_orders
[0m17:43:16.517361 [info ] [Thread-4 (]: 4 of 4 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m17:43:16.518703 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m17:43:16.519755 [debug] [Thread-4 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m17:43:16.524757 [debug] [Thread-4 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m17:43:16.526710 [debug] [Thread-4 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m17:43:16.531753 [debug] [Thread-4 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m17:43:16.535753 [debug] [Thread-4 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m17:43:16.536752 [debug] [Thread-4 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers),
orders as (select * from finance_db.L1_LANDING.stg_orders),
payments as (select * from finance_db.L1_LANDING.stg_payments),

customer_order_history as (
     select 
        customers.customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) as first_order_date,
        min(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as first_non_returned_order_date,
        max(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(orders.user_order_seq), 0) as order_count,
        coalesce(count(case when orders.order_status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end as total_lifetime_value,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) 
        /
        nullif(count(case when orders.order_status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct order.order_id) as order_ids
        from orders
        join customers
        on orders.customer_id = customers.customer_id
        left outer join payments
        on order.order_id = payments.order_id
        where orders.order_status NOT IN ('pending') and payments.payment_status != 'fail'
        group by customers.id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( 
    select 
    order.order_id ,
    orders.customer_id ,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    payments.payment_amount as order_value_dollars,
    orders.order_status ,
    payments.payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id
    left join payments
    on order.order_id = payments.order_id
    where payments.payment_status != 'fail'
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m17:43:16.537755 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:43:16.840457 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01be0373-0000-a353-0000-a17900046282
[0m17:43:16.841455 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 119 unexpected 'as'.
syntax error line 27 at position 27 unexpected 'order'.
syntax error line 27 at position 32 unexpected '.'.
syntax error line 27 at position 43 unexpected 'as'.
syntax error line 30 at position 11 unexpected 'orders'.
[0m17:43:16.846449 [debug] [Thread-4 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 119 unexpected 'as'.
  syntax error line 27 at position 27 unexpected 'order'.
  syntax error line 27 at position 32 unexpected '.'.
  syntax error line 27 at position 43 unexpected 'as'.
  syntax error line 30 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:43:16.847450 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6b95d1f-e14a-4fda-9fef-882bf6f9dfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA723970D0>]}
[0m17:43:16.849445 [error] [Thread-4 (]: 4 of 4 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 0.33s]
[0m17:43:16.851402 [debug] [Thread-4 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m17:43:16.852401 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 119 unexpected 'as'.
  syntax error line 27 at position 27 unexpected 'order'.
  syntax error line 27 at position 32 unexpected '.'.
  syntax error line 27 at position 43 unexpected 'as'.
  syntax error line 30 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m17:43:16.855398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:16.856399 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m17:43:16.857399 [debug] [MainThread]: On list_finance_db: Close
[0m17:43:16.945702 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m17:43:16.946705 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m17:43:17.030704 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m17:43:17.031709 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m17:43:17.111704 [debug] [MainThread]: Connection 'model.snow_dbt.stg_orders' was left open.
[0m17:43:17.112705 [debug] [MainThread]: On model.snow_dbt.stg_orders: Close
[0m17:43:17.203687 [debug] [MainThread]: Connection 'model.snow_dbt.stg_payments' was left open.
[0m17:43:17.204684 [debug] [MainThread]: On model.snow_dbt.stg_payments: Close
[0m17:43:17.293414 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m17:43:17.294414 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m17:43:17.378402 [info ] [MainThread]: 
[0m17:43:17.379522 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m17:43:17.381574 [debug] [MainThread]: Command end result
[0m17:43:17.414535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:43:17.417534 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:43:17.427573 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m17:43:17.428534 [info ] [MainThread]: 
[0m17:43:17.430537 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:43:17.431555 [info ] [MainThread]: 
[0m17:43:17.432535 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m17:43:17.433537 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 119 unexpected 'as'.
  syntax error line 27 at position 27 unexpected 'order'.
  syntax error line 27 at position 32 unexpected '.'.
  syntax error line 27 at position 43 unexpected 'as'.
  syntax error line 30 at position 11 unexpected 'orders'.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:43:17.434537 [info ] [MainThread]: 
[0m17:43:17.435534 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:43:17.436535 [info ] [MainThread]: 
[0m17:43:17.437542 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m17:43:17.439533 [debug] [MainThread]: Command `dbt run` failed at 17:43:17.438534 after 5.94 seconds
[0m17:43:17.439533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6D8F56F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6F990BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA7240C3A0>]}
[0m17:43:17.440533 [debug] [MainThread]: Flushing usage events
[0m17:43:18.138108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:15.148254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26BCA5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26CF3C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26CF3C250>]}


============================== 17:47:15.153249 | 06c1cee4-f3a8-4dc9-a2b1-622ba161fe69 ==============================
[0m17:47:15.153249 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:47:15.154249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s fct_customer_orders.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:47:15.991693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c1cee4-f3a8-4dc9-a2b1-622ba161fe69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26C652980>]}
[0m17:47:16.077745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06c1cee4-f3a8-4dc9-a2b1-622ba161fe69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26D9D0250>]}
[0m17:47:16.079711 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:47:16.482716 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m17:47:16.719175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:16.719175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:16.729179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m17:47:16.779335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06c1cee4-f3a8-4dc9-a2b1-622ba161fe69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26EFB98D0>]}
[0m17:47:16.899372 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:47:16.901420 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:47:16.938328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06c1cee4-f3a8-4dc9-a2b1-622ba161fe69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26EF355D0>]}
[0m17:47:16.939333 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m17:47:16.940331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c1cee4-f3a8-4dc9-a2b1-622ba161fe69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26EF35630>]}
[0m17:47:16.943367 [info ] [MainThread]: 
[0m17:47:16.944324 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:47:16.944324 [info ] [MainThread]: 
[0m17:47:16.946326 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:47:16.948329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m17:47:17.045597 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m17:47:17.046596 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m17:47:17.047597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:17.934758 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.887 seconds
[0m17:47:17.956591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m17:47:17.980597 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m17:47:17.980597 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m17:47:17.981600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:18.455546 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.473 seconds
[0m17:47:18.470528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c1cee4-f3a8-4dc9-a2b1-622ba161fe69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26EF353F0>]}
[0m17:47:18.480648 [debug] [Thread-1 (]: Began running node model.snow_dbt.fct_customer_orders
[0m17:47:18.482689 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m17:47:18.483648 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m17:47:18.484687 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m17:47:18.496642 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m17:47:18.498645 [debug] [Thread-1 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m17:47:18.538694 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m17:47:18.542688 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m17:47:18.543689 [debug] [Thread-1 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers),
orders as (select * from finance_db.L1_LANDING.stg_orders),
payments as (select * from finance_db.L1_LANDING.stg_payments),

customer_order_history as (
     select 
        customers.customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) as first_order_date,
        min(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as first_non_returned_order_date,
        max(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(orders.user_order_seq), 0) as order_count,
        coalesce(count(case when orders.order_status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) as total_lifetime_value,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) 
        /
        nullif(count(case when orders.order_status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct orders.order_id) as order_ids
        from orders
        join customers
        on orders.customer_id = customers.customer_id
        left outer join payments
        on orders.order_id = payments.order_id
        where orders.order_status NOT IN ('pending') and payments.payment_status != 'fail'
        group by customers.customer_id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( 
    select 
    orders.order_id ,
    orders.customer_id ,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    payments.payment_amount as order_value_dollars,
    orders.order_status ,
    payments.payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id
    left join payments
    on orders.order_id = payments.order_id
    where payments.payment_status != 'fail'
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m17:47:18.544689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:47:18.956777 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be0377-0000-a353-0000-a1790004628a
[0m17:47:18.957773 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 52 at position 28
invalid identifier 'CUSTOMERS.ID'
[0m17:47:18.960413 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  000904 (42000): SQL compilation error: error line 52 at position 28
  invalid identifier 'CUSTOMERS.ID'
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:47:18.964430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c1cee4-f3a8-4dc9-a2b1-622ba161fe69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26F6A0670>]}
[0m17:47:18.966778 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 0.48s]
[0m17:47:18.967739 [debug] [Thread-1 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m17:47:18.968779 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  000904 (42000): SQL compilation error: error line 52 at position 28
  invalid identifier 'CUSTOMERS.ID'
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m17:47:18.971733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:18.972779 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m17:47:18.973734 [debug] [MainThread]: On list_finance_db: Close
[0m17:47:19.065647 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m17:47:19.067648 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m17:47:19.167238 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m17:47:19.167238 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m17:47:19.246906 [info ] [MainThread]: 
[0m17:47:19.247857 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m17:47:19.248857 [debug] [MainThread]: Command end result
[0m17:47:19.284863 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:47:19.287858 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:47:19.297857 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m17:47:19.298865 [info ] [MainThread]: 
[0m17:47:19.299858 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:47:19.300866 [info ] [MainThread]: 
[0m17:47:19.302858 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m17:47:19.303863 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  000904 (42000): SQL compilation error: error line 52 at position 28
  invalid identifier 'CUSTOMERS.ID'
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:47:19.304899 [info ] [MainThread]: 
[0m17:47:19.305859 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m17:47:19.306901 [info ] [MainThread]: 
[0m17:47:19.307856 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:47:19.309857 [debug] [MainThread]: Command `dbt run` failed at 17:47:19.309857 after 4.27 seconds
[0m17:47:19.310857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26BCA5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26C653B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26BF754E0>]}
[0m17:47:19.310857 [debug] [MainThread]: Flushing usage events
[0m17:47:20.008177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:16.809912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192260956F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192282FC490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192282FC2B0>]}


============================== 17:50:16.815424 | 6b93fc06-becb-4e7e-bcc3-132f1af07021 ==============================
[0m17:50:16.815424 [info ] [MainThread]: Running with dbt=1.10.5
[0m17:50:16.816378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s fct_customer_orders.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:17.564694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b93fc06-becb-4e7e-bcc3-132f1af07021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019227335090>]}
[0m17:50:17.648692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b93fc06-becb-4e7e-bcc3-132f1af07021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019228D90400>]}
[0m17:50:17.650694 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:50:18.028692 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m17:50:18.248692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:18.249694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:18.258739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m17:50:18.309739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b93fc06-becb-4e7e-bcc3-132f1af07021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001922A3798A0>]}
[0m17:50:18.426693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:50:18.430695 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:50:18.466722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b93fc06-becb-4e7e-bcc3-132f1af07021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001922A2F77F0>]}
[0m17:50:18.467756 [info ] [MainThread]: Found 4 models, 3 sources, 477 macros
[0m17:50:18.468720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b93fc06-becb-4e7e-bcc3-132f1af07021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001922A2F4790>]}
[0m17:50:18.470758 [info ] [MainThread]: 
[0m17:50:18.471760 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:50:18.472755 [info ] [MainThread]: 
[0m17:50:18.474720 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:18.476716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m17:50:18.574351 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m17:50:18.575351 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m17:50:18.576312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:19.528206 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.953 seconds
[0m17:50:19.538209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m17:50:19.558206 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m17:50:19.559202 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m17:50:19.559202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:20.332680 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.773 seconds
[0m17:50:20.343656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b93fc06-becb-4e7e-bcc3-132f1af07021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001922A2F5570>]}
[0m17:50:20.350253 [debug] [Thread-1 (]: Began running node model.snow_dbt.fct_customer_orders
[0m17:50:20.351303 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m17:50:20.352254 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m17:50:20.353253 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m17:50:20.364251 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m17:50:20.366253 [debug] [Thread-1 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m17:50:20.407258 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m17:50:20.411257 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m17:50:20.412256 [debug] [Thread-1 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers),
orders as (select * from finance_db.L1_LANDING.stg_orders),
payments as (select * from finance_db.L1_LANDING.stg_payments),

customer_order_history as (
     select 
        customers.customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) as first_order_date,
        min(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as first_non_returned_order_date,
        max(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(orders.user_order_seq), 0) as order_count,
        coalesce(count(case when orders.order_status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) as total_lifetime_value,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) 
        /
        nullif(count(case when orders.order_status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct orders.order_id) as order_ids
        from orders
        join customers
        on orders.customer_id = customers.customer_id
        left outer join payments
        on orders.order_id = payments.order_id
        where orders.order_status NOT IN ('pending') and payments.payment_status != 'fail'
        group by customers.customer_id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( 
    select 
    orders.order_id ,
    orders.customer_id ,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    payments.payment_amount as order_value_dollars,
    orders.order_status ,
    payments.payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.customer_id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id
    left join payments
    on orders.order_id = payments.order_id
    where payments.payment_status != 'fail'
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m17:50:20.413257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:23.823915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.411 seconds
[0m17:50:23.859867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b93fc06-becb-4e7e-bcc3-132f1af07021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192245A0DF0>]}
[0m17:50:23.861866 [info ] [Thread-1 (]: 1 of 1 OK created sql table model L1_LANDING.fct_customer_orders ............... [[32mSUCCESS 1[0m in 3.50s]
[0m17:50:23.863868 [debug] [Thread-1 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m17:50:23.866867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:23.867867 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m17:50:23.868866 [debug] [MainThread]: On list_finance_db: Close
[0m17:50:23.958864 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m17:50:23.959866 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m17:50:24.081204 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m17:50:24.082251 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m17:50:24.177947 [info ] [MainThread]: 
[0m17:50:24.178946 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m17:50:24.180948 [debug] [MainThread]: Command end result
[0m17:50:24.214944 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m17:50:24.218949 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m17:50:24.230948 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m17:50:24.231946 [info ] [MainThread]: 
[0m17:50:24.232948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:24.233948 [info ] [MainThread]: 
[0m17:50:24.234948 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:50:24.235948 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:24.235948 after 7.54 seconds
[0m17:50:24.236948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192260956F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001922A35D960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019227335090>]}
[0m17:50:24.237946 [debug] [MainThread]: Flushing usage events
[0m17:50:24.994773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:53.504068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2206B5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F222910430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F222910250>]}


============================== 16:34:53.512232 | 4f30d968-605a-416d-92eb-62935d4bb829 ==============================
[0m16:34:53.512232 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:34:53.513231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:55.023967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2233E1FC0>]}
[0m16:34:55.111606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2233AB130>]}
[0m16:34:55.118498 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:34:55.677488 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:34:55.897922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:55.898914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:55.907915 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m16:34:55.959925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F224999DB0>]}
[0m16:34:56.080059 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:34:56.111041 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:34:56.182451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22494F2B0>]}
[0m16:34:56.182451 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m16:34:56.184450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22494FBB0>]}
[0m16:34:56.186495 [info ] [MainThread]: 
[0m16:34:56.187494 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:34:56.188564 [info ] [MainThread]: 
[0m16:34:56.189570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:34:56.199579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:34:59.231436 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:34:59.232435 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:34:59.232435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:01.304975 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.072 seconds
[0m16:35:01.324248 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:35:01.343161 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:35:01.344161 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:35:01.345161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:01.916706 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.572 seconds
[0m16:35:01.933680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21EC7FD00>]}
[0m16:35:01.954521 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m16:35:01.955561 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m16:35:01.956519 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m16:35:01.958517 [info ] [Thread-1 (]: 1 of 5 START sql table model L1_LANDING.stg_customers .......................... [RUN]
[0m16:35:01.959516 [info ] [Thread-2 (]: 2 of 5 START sql table model L1_LANDING.stg_orders ............................. [RUN]
[0m16:35:01.961560 [info ] [Thread-3 (]: 3 of 5 START sql table model L1_LANDING.stg_payments ........................... [RUN]
[0m16:35:01.962518 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m16:35:01.963562 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m16:35:01.964517 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m16:35:01.965571 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m16:35:01.966517 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m16:35:01.967597 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m16:35:01.979649 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m16:35:01.983648 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m16:35:01.990611 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m16:35:01.992224 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m16:35:02.000219 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m16:35:02.031219 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m16:35:02.037220 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m16:35:02.042265 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m16:35:02.046267 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m16:35:02.048222 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m16:35:02.049224 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace transient table finance_db.L1_LANDING.stg_customers
    
    
    
    as (

select 
    id as customer_id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m16:35:02.051220 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m16:35:02.052265 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:35:02.053223 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m16:35:02.054266 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace transient table finance_db.L1_LANDING.stg_payments
    
    
    
    as (

select   id as payment_id,
         paymentmethod,
         orderid as order_id,
         round(amount / 100.0, 2) as payment_amount,
         status as payment_status
from finance_db.L1_LANDING.PAYMENTS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m16:35:02.058220 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace transient table finance_db.L1_LANDING.stg_orders
    
    
    
    as (

select
       id as order_id,
       user_id as customer_id,
       order_date,
       status as order_status,
    case
         when order_status NOT IN ('returned','return_pending') 
         then order_date
    end as valid_order_date,
       row_number() over (partition by user_id order by order_date, id) as user_order_seq
 from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m16:35:02.059222 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:35:02.060221 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:35:04.995158 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.936 seconds
[0m16:35:05.055046 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22506F700>]}
[0m16:35:05.056054 [info ] [Thread-3 (]: 3 of 5 OK created sql table model L1_LANDING.stg_payments ...................... [[32mSUCCESS 1[0m in 3.09s]
[0m16:35:05.057054 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m16:35:05.249793 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.190 seconds
[0m16:35:05.253796 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F224975090>]}
[0m16:35:05.255789 [info ] [Thread-2 (]: 2 of 5 OK created sql table model L1_LANDING.stg_orders ........................ [[32mSUCCESS 1[0m in 3.29s]
[0m16:35:05.256788 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m16:35:05.258791 [debug] [Thread-4 (]: Began running node model.snow_dbt.int_orders
[0m16:35:05.259794 [info ] [Thread-4 (]: 4 of 5 START sql table model L1_LANDING.int_orders ............................. [RUN]
[0m16:35:05.260791 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snow_dbt.int_orders'
[0m16:35:05.262790 [debug] [Thread-4 (]: Began compiling node model.snow_dbt.int_orders
[0m16:35:05.271177 [debug] [Thread-4 (]: Writing injected SQL for node "model.snow_dbt.int_orders"
[0m16:35:05.274000 [debug] [Thread-4 (]: Began executing node model.snow_dbt.int_orders
[0m16:35:05.280788 [debug] [Thread-4 (]: Writing runtime sql for node "model.snow_dbt.int_orders"
[0m16:35:05.289304 [debug] [Thread-4 (]: Using snowflake connection "model.snow_dbt.int_orders"
[0m16:35:05.291290 [debug] [Thread-4 (]: On model.snow_dbt.int_orders: create or replace transient table finance_db.L1_LANDING.int_orders
    
    
    
    as (orders as 
    (select * from finance_db.L1_LANDING.stg_orders)
,
payments as
     (select * from finance_db.L1_LANDING.stg_payments
where payments.payment_status != 'fail'),

order_total as ( 
    select 
        order_id, 
        order_status,
        sum(payment_amount) as order_value_dollars
    from payments
    group by order_id, order_status
),

order_value_join as ( 
    select 
        orders.*,
        order_total.order_status,
        order_total.order_value_dollars
    from orders
    left join order_total
    on orders.order_id = order_total.order_id
)
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.int_orders"} */;
[0m16:35:05.291879 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:35:05.341826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.290 seconds
[0m16:35:05.345839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21EC7FD00>]}
[0m16:35:05.346838 [info ] [Thread-1 (]: 1 of 5 OK created sql table model L1_LANDING.stg_customers ..................... [[32mSUCCESS 1[0m in 3.38s]
[0m16:35:05.347858 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m16:35:05.348883 [debug] [Thread-2 (]: Began running node model.snow_dbt.fct_customer_orders
[0m16:35:05.349879 [info ] [Thread-2 (]: 5 of 5 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m16:35:05.351837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.snow_dbt.stg_orders, now model.snow_dbt.fct_customer_orders)
[0m16:35:05.352878 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m16:35:05.357440 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m16:35:05.359401 [debug] [Thread-2 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m16:35:05.364017 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m16:35:05.374132 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m16:35:05.375117 [debug] [Thread-2 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers),
orders as (select * from finance_db.L1_LANDING.stg_orders),
payments as (select * from finance_db.L1_LANDING.stg_payments),

customer_order_history as (
     select 
        customers.customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) as first_order_date,
        min(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as first_non_returned_order_date,
        max(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(orders.user_order_seq), 0) as order_count,
        coalesce(count(case when orders.order_status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) as total_lifetime_value,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) 
        /
        nullif(count(case when orders.order_status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct orders.order_id) as order_ids
        from orders
        join customers
        on orders.customer_id = customers.customer_id
        left outer join payments
        on orders.order_id = payments.order_id
        where orders.order_status NOT IN ('pending') and payments.payment_status != 'fail'
        group by customers.customer_id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( 
    select 
    orders.order_id ,
    orders.customer_id ,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    payments.payment_amount as order_value_dollars,
    orders.order_status ,
    payments.payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.customer_id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id
    left join payments
    on orders.order_id = payments.order_id
    where payments.payment_status != 'fail'
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m16:35:06.555275 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01be140f-0000-a498-0000-a17900065006
[0m16:35:06.555275 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 8 unexpected 'orders'.
syntax error line 7 at position 0 unexpected ','.
[0m16:35:06.570275 [debug] [Thread-4 (]: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 8 unexpected 'orders'.
  syntax error line 7 at position 0 unexpected ','.
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:35:06.571275 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2252141C0>]}
[0m16:35:06.572274 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model L1_LANDING.int_orders .................... [[31mERROR[0m in 1.31s]
[0m16:35:06.573278 [debug] [Thread-4 (]: Finished running node model.snow_dbt.int_orders
[0m16:35:06.575275 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.int_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 8 unexpected 'orders'.
  syntax error line 7 at position 0 unexpected ','.
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql.
[0m16:35:08.199107 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.823 seconds
[0m16:35:08.211081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f30d968-605a-416d-92eb-62935d4bb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F224975300>]}
[0m16:35:08.214026 [info ] [Thread-2 (]: 5 of 5 OK created sql table model L1_LANDING.fct_customer_orders ............... [[32mSUCCESS 1[0m in 2.86s]
[0m16:35:08.217033 [debug] [Thread-2 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m16:35:08.220022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:08.221068 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:35:08.222067 [debug] [MainThread]: On list_finance_db: Close
[0m16:35:08.298163 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:35:08.299163 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:35:08.375316 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m16:35:08.375316 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m16:35:08.443969 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m16:35:08.443969 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m16:35:08.512332 [debug] [MainThread]: Connection 'model.snow_dbt.stg_payments' was left open.
[0m16:35:08.513323 [debug] [MainThread]: On model.snow_dbt.stg_payments: Close
[0m16:35:08.595716 [debug] [MainThread]: Connection 'model.snow_dbt.int_orders' was left open.
[0m16:35:08.596718 [debug] [MainThread]: On model.snow_dbt.int_orders: Close
[0m16:35:08.662835 [info ] [MainThread]: 
[0m16:35:08.663789 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 12.47 seconds (12.47s).
[0m16:35:08.665791 [debug] [MainThread]: Command end result
[0m16:35:08.762832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:35:08.766789 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:35:08.776293 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:35:08.777307 [info ] [MainThread]: 
[0m16:35:08.778303 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:35:08.778303 [info ] [MainThread]: 
[0m16:35:08.780303 [error] [MainThread]: [31mFailure in model int_orders (models\marts\intermedate\int_orders.sql)[0m
[0m16:35:08.780998 [error] [MainThread]:   Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 8 unexpected 'orders'.
  syntax error line 7 at position 0 unexpected ','.
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:35:08.782005 [info ] [MainThread]: 
[0m16:35:08.783005 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:35:08.784004 [info ] [MainThread]: 
[0m16:35:08.785005 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m16:35:08.787037 [debug] [MainThread]: Command `dbt run` failed at 16:35:08.786004 after 15.42 seconds
[0m16:35:08.787037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2206B5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F224996260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2248AEC20>]}
[0m16:35:08.788003 [debug] [MainThread]: Flushing usage events
[0m16:35:09.634910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:34.323080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7328A5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A733B38430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A733B38250>]}


============================== 16:40:34.327885 | 151fd051-9fd5-438c-8e13-9fae6f11d4f2 ==============================
[0m16:40:34.327885 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:40:34.329887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:40:35.072335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A734601FC0>]}
[0m16:40:35.157329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7345CB130>]}
[0m16:40:35.159429 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:40:35.540311 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:40:35.763314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:35.763314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:35.774267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m16:40:35.825660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A735BB9DB0>]}
[0m16:40:35.941617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:40:35.944655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:40:35.980126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A735B6F2B0>]}
[0m16:40:35.980126 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m16:40:35.981170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A735B6FBB0>]}
[0m16:40:35.984127 [info ] [MainThread]: 
[0m16:40:35.985127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:35.986132 [info ] [MainThread]: 
[0m16:40:35.987128 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:40:35.996133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:40:36.095112 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:40:36.096114 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:40:36.096114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:36.959913 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.864 seconds
[0m16:40:36.964421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:40:36.983427 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:40:36.984427 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:40:36.985427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:37.239616 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.254 seconds
[0m16:40:37.252618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A73069FD00>]}
[0m16:40:37.262506 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m16:40:37.263542 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m16:40:37.264534 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m16:40:37.265495 [info ] [Thread-1 (]: 1 of 5 START sql table model L1_LANDING.stg_customers .......................... [RUN]
[0m16:40:37.266499 [info ] [Thread-2 (]: 2 of 5 START sql table model L1_LANDING.stg_orders ............................. [RUN]
[0m16:40:37.267493 [info ] [Thread-3 (]: 3 of 5 START sql table model L1_LANDING.stg_payments ........................... [RUN]
[0m16:40:37.269493 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m16:40:37.270493 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m16:40:37.271493 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m16:40:37.272501 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m16:40:37.273536 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m16:40:37.274502 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m16:40:37.285537 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m16:40:37.290537 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m16:40:37.294538 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m16:40:37.296494 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m16:40:37.303537 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m16:40:37.334542 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m16:40:37.339542 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m16:40:37.344491 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m16:40:37.348414 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m16:40:37.351414 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m16:40:37.352416 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m16:40:37.353416 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace transient table finance_db.L1_LANDING.stg_customers
    
    
    
    as (

select 
    id as customer_id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m16:40:37.354416 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m16:40:37.355414 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace transient table finance_db.L1_LANDING.stg_orders
    
    
    
    as (

select
       id as order_id,
       user_id as customer_id,
       order_date,
       status as order_status,
    case
         when order_status NOT IN ('returned','return_pending') 
         then order_date
    end as valid_order_date,
       row_number() over (partition by user_id order by order_date, id) as user_order_seq
 from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m16:40:37.356460 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:37.357414 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace transient table finance_db.L1_LANDING.stg_payments
    
    
    
    as (

select   id as payment_id,
         paymentmethod,
         orderid as order_id,
         round(amount / 100.0, 2) as payment_amount,
         status as payment_status
from finance_db.L1_LANDING.PAYMENTS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m16:40:37.358054 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:40:37.360750 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:40:38.865332 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.504 seconds
[0m16:40:38.910320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A73636FDC0>]}
[0m16:40:38.911316 [info ] [Thread-3 (]: 3 of 5 OK created sql table model L1_LANDING.stg_payments ...................... [[32mSUCCESS 1[0m in 1.64s]
[0m16:40:38.913362 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m16:40:40.086767 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.730 seconds
[0m16:40:40.089798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A73069FD00>]}
[0m16:40:40.090797 [info ] [Thread-1 (]: 1 of 5 OK created sql table model L1_LANDING.stg_customers ..................... [[32mSUCCESS 1[0m in 2.82s]
[0m16:40:40.092750 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m16:40:40.257550 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.899 seconds
[0m16:40:40.261501 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7363C0130>]}
[0m16:40:40.262580 [info ] [Thread-2 (]: 2 of 5 OK created sql table model L1_LANDING.stg_orders ........................ [[32mSUCCESS 1[0m in 2.99s]
[0m16:40:40.264505 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m16:40:40.265500 [debug] [Thread-4 (]: Began running node model.snow_dbt.fct_customer_orders
[0m16:40:40.266541 [debug] [Thread-3 (]: Began running node model.snow_dbt.int_orders
[0m16:40:40.267035 [info ] [Thread-4 (]: 4 of 5 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m16:40:40.267803 [info ] [Thread-3 (]: 5 of 5 START sql table model L1_LANDING.int_orders ............................. [RUN]
[0m16:40:40.269818 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m16:40:40.270810 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.snow_dbt.stg_payments, now model.snow_dbt.int_orders)
[0m16:40:40.270810 [debug] [Thread-4 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m16:40:40.271852 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.int_orders
[0m16:40:40.277815 [debug] [Thread-4 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m16:40:40.282854 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.int_orders"
[0m16:40:40.283809 [debug] [Thread-4 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m16:40:40.290855 [debug] [Thread-4 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m16:40:40.291857 [debug] [Thread-3 (]: Began executing node model.snow_dbt.int_orders
[0m16:40:40.297814 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.int_orders"
[0m16:40:40.301812 [debug] [Thread-4 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m16:40:40.302809 [debug] [Thread-4 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers),
orders as (select * from finance_db.L1_LANDING.stg_orders),
payments as (select * from finance_db.L1_LANDING.stg_payments),

customer_order_history as (
     select 
        customers.customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) as first_order_date,
        min(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as first_non_returned_order_date,
        max(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(orders.user_order_seq), 0) as order_count,
        coalesce(count(case when orders.order_status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) as total_lifetime_value,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) 
        /
        nullif(count(case when orders.order_status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct orders.order_id) as order_ids
        from orders
        join customers
        on orders.customer_id = customers.customer_id
        left outer join payments
        on orders.order_id = payments.order_id
        where orders.order_status NOT IN ('pending') and payments.payment_status != 'fail'
        group by customers.customer_id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( 
    select 
    orders.order_id ,
    orders.customer_id ,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    payments.payment_amount as order_value_dollars,
    orders.order_status ,
    payments.payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.customer_id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id
    left join payments
    on orders.order_id = payments.order_id
    where payments.payment_status != 'fail'
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m16:40:40.303813 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:40:40.306836 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.int_orders"
[0m16:40:40.309854 [debug] [Thread-3 (]: On model.snow_dbt.int_orders: create or replace transient table finance_db.L1_LANDING.int_orders
    
    
    
    as (orders as 
    (select * from finance_db.L1_LANDING.stg_orders)
,
payments as
     (select * from finance_db.L1_LANDING.stg_payments
where payments.payment_status != 'fail'),

order_total as ( 
    select 
        order_id, 
        order_status,
        sum(payment_amount) as order_value_dollars
    from payments
    group by order_id, order_status
),

order_value_join as ( 
    select 
        orders.*,
        order_total.order_status,
        order_total.order_value_dollars
    from orders
    left join order_total
    on orders.order_id = order_total.order_id
)
select * from order_value_join


    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.int_orders"} */;
[0m16:40:40.424251 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01be1414-0000-a499-0000-a1790006300e
[0m16:40:40.425251 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 8 unexpected 'orders'.
syntax error line 7 at position 0 unexpected ','.
[0m16:40:40.427251 [debug] [Thread-3 (]: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 8 unexpected 'orders'.
  syntax error line 7 at position 0 unexpected ','.
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:40:40.428251 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7361720E0>]}
[0m16:40:40.429251 [error] [Thread-3 (]: 5 of 5 ERROR creating sql table model L1_LANDING.int_orders .................... [[31mERROR[0m in 0.16s]
[0m16:40:40.429813 [debug] [Thread-3 (]: Finished running node model.snow_dbt.int_orders
[0m16:40:40.430865 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.int_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 8 unexpected 'orders'.
  syntax error line 7 at position 0 unexpected ','.
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql.
[0m16:40:42.105065 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.801 seconds
[0m16:40:42.110063 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '151fd051-9fd5-438c-8e13-9fae6f11d4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A736167EE0>]}
[0m16:40:42.111020 [info ] [Thread-4 (]: 4 of 5 OK created sql table model L1_LANDING.fct_customer_orders ............... [[32mSUCCESS 1[0m in 1.84s]
[0m16:40:42.112019 [debug] [Thread-4 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m16:40:42.114017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:42.114017 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:40:42.115018 [debug] [MainThread]: On list_finance_db: Close
[0m16:40:42.190789 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:40:42.191835 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:40:42.256312 [debug] [MainThread]: Connection 'model.snow_dbt.stg_customers' was left open.
[0m16:40:42.257309 [debug] [MainThread]: On model.snow_dbt.stg_customers: Close
[0m16:40:42.327469 [debug] [MainThread]: Connection 'model.snow_dbt.stg_orders' was left open.
[0m16:40:42.329431 [debug] [MainThread]: On model.snow_dbt.stg_orders: Close
[0m16:40:42.404514 [debug] [MainThread]: Connection 'model.snow_dbt.int_orders' was left open.
[0m16:40:42.404514 [debug] [MainThread]: On model.snow_dbt.int_orders: Close
[0m16:40:42.472950 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m16:40:42.473951 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m16:40:42.562192 [info ] [MainThread]: 
[0m16:40:42.563193 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m16:40:42.565192 [debug] [MainThread]: Command end result
[0m16:40:42.662189 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:40:42.665191 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:40:42.675191 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:40:42.676192 [info ] [MainThread]: 
[0m16:40:42.677192 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:40:42.678192 [info ] [MainThread]: 
[0m16:40:42.679193 [error] [MainThread]: [31mFailure in model int_orders (models\marts\intermedate\int_orders.sql)[0m
[0m16:40:42.679625 [error] [MainThread]:   Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 8 unexpected 'orders'.
  syntax error line 7 at position 0 unexpected ','.
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:40:42.680633 [info ] [MainThread]: 
[0m16:40:42.681632 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:40:42.682633 [info ] [MainThread]: 
[0m16:40:42.683635 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m16:40:42.684633 [debug] [MainThread]: Command `dbt run` failed at 16:40:42.684633 after 8.47 seconds
[0m16:40:42.685674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7328A5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A735BB6860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A732B754E0>]}
[0m16:40:42.686633 [debug] [MainThread]: Flushing usage events
[0m16:40:43.495858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:01.075653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244DBA56C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244FE04430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244FE04250>]}


============================== 16:43:01.080696 | d3a52f34-d108-4919-916c-533148bac61f ==============================
[0m16:43:01.080696 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:43:01.081650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:01.975315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244FE042B0>]}
[0m16:43:02.113313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244F523010>]}
[0m16:43:02.116316 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:43:02.609799 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:43:02.866756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:02.867757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:02.878755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m16:43:02.967755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022451E89D50>]}
[0m16:43:03.109754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:43:03.112760 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:43:03.148759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022451E38E50>]}
[0m16:43:03.149759 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m16:43:03.150757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022451E3A830>]}
[0m16:43:03.153799 [info ] [MainThread]: 
[0m16:43:03.154756 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:03.155756 [info ] [MainThread]: 
[0m16:43:03.156757 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:03.164761 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:43:03.279996 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:43:03.280994 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:43:03.281995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:03.909294 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.627 seconds
[0m16:43:03.913297 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:43:03.934290 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:43:03.935289 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:43:03.936289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:04.273492 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.338 seconds
[0m16:43:04.282443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224508C6680>]}
[0m16:43:04.295045 [debug] [Thread-1 (]: Began running node model.snow_dbt.stg_customers
[0m16:43:04.296011 [debug] [Thread-2 (]: Began running node model.snow_dbt.stg_orders
[0m16:43:04.297006 [debug] [Thread-3 (]: Began running node model.snow_dbt.stg_payments
[0m16:43:04.300050 [info ] [Thread-1 (]: 1 of 5 START sql table model L1_LANDING.stg_customers .......................... [RUN]
[0m16:43:04.302011 [info ] [Thread-2 (]: 2 of 5 START sql table model L1_LANDING.stg_orders ............................. [RUN]
[0m16:43:04.304007 [info ] [Thread-3 (]: 3 of 5 START sql table model L1_LANDING.stg_payments ........................... [RUN]
[0m16:43:04.307002 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_customers'
[0m16:43:04.308997 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_orders'
[0m16:43:04.311000 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snow_dbt.stg_payments'
[0m16:43:04.312998 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.stg_customers
[0m16:43:04.314997 [debug] [Thread-2 (]: Began compiling node model.snow_dbt.stg_orders
[0m16:43:04.317002 [debug] [Thread-3 (]: Began compiling node model.snow_dbt.stg_payments
[0m16:43:04.334039 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.stg_customers"
[0m16:43:04.338993 [debug] [Thread-2 (]: Writing injected SQL for node "model.snow_dbt.stg_orders"
[0m16:43:04.343037 [debug] [Thread-3 (]: Writing injected SQL for node "model.snow_dbt.stg_payments"
[0m16:43:04.344993 [debug] [Thread-1 (]: Began executing node model.snow_dbt.stg_customers
[0m16:43:04.345995 [debug] [Thread-2 (]: Began executing node model.snow_dbt.stg_orders
[0m16:43:04.347041 [debug] [Thread-3 (]: Began executing node model.snow_dbt.stg_payments
[0m16:43:04.399996 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.stg_customers"
[0m16:43:04.407003 [debug] [Thread-2 (]: Writing runtime sql for node "model.snow_dbt.stg_orders"
[0m16:43:04.413995 [debug] [Thread-3 (]: Writing runtime sql for node "model.snow_dbt.stg_payments"
[0m16:43:04.416994 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.stg_customers"
[0m16:43:04.418994 [debug] [Thread-1 (]: On model.snow_dbt.stg_customers: create or replace transient table finance_db.L1_LANDING.stg_customers
    
    
    
    as (

select 
    id as customer_id,
    first_name || ' ' || last_name as full_name,
    first_name as givenname,
    last_name as surname
 from finance_db.L1_LANDING.CUSTOMERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_customers"} */;
[0m16:43:04.419995 [debug] [Thread-2 (]: Using snowflake connection "model.snow_dbt.stg_orders"
[0m16:43:04.420995 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:04.422995 [debug] [Thread-3 (]: Using snowflake connection "model.snow_dbt.stg_payments"
[0m16:43:04.423995 [debug] [Thread-2 (]: On model.snow_dbt.stg_orders: create or replace transient table finance_db.L1_LANDING.stg_orders
    
    
    
    as (

select
       id as order_id,
       user_id as customer_id,
       order_date,
       status as order_status,
    case
         when order_status NOT IN ('returned','return_pending') 
         then order_date
    end as valid_order_date,
       row_number() over (partition by user_id order by order_date, id) as user_order_seq
 from finance_db.L1_LANDING.ORDERS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_orders"} */;
[0m16:43:04.428998 [debug] [Thread-3 (]: On model.snow_dbt.stg_payments: create or replace transient table finance_db.L1_LANDING.stg_payments
    
    
    
    as (

select   id as payment_id,
         paymentmethod,
         orderid as order_id,
         round(amount / 100.0, 2) as payment_amount,
         status as payment_status
from finance_db.L1_LANDING.PAYMENTS
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.stg_payments"} */;
[0m16:43:04.430976 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:43:04.432582 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:43:05.980207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.559 seconds
[0m16:43:06.018205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224508C6680>]}
[0m16:43:06.019207 [info ] [Thread-1 (]: 1 of 5 OK created sql table model L1_LANDING.stg_customers ..................... [[32mSUCCESS 1[0m in 1.71s]
[0m16:43:06.020208 [debug] [Thread-1 (]: Finished running node model.snow_dbt.stg_customers
[0m16:43:06.155046 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.724 seconds
[0m16:43:06.161095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224525D0070>]}
[0m16:43:06.163046 [info ] [Thread-2 (]: 2 of 5 OK created sql table model L1_LANDING.stg_orders ........................ [[32mSUCCESS 1[0m in 1.85s]
[0m16:43:06.164054 [debug] [Thread-2 (]: Finished running node model.snow_dbt.stg_orders
[0m16:43:06.167091 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.735 seconds
[0m16:43:06.171090 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245243BEE0>]}
[0m16:43:06.172097 [info ] [Thread-3 (]: 3 of 5 OK created sql table model L1_LANDING.stg_payments ...................... [[32mSUCCESS 1[0m in 1.86s]
[0m16:43:06.173053 [debug] [Thread-3 (]: Finished running node model.snow_dbt.stg_payments
[0m16:43:06.175047 [debug] [Thread-4 (]: Began running node model.snow_dbt.fct_customer_orders
[0m16:43:06.175047 [debug] [Thread-1 (]: Began running node model.snow_dbt.int_orders
[0m16:43:06.177047 [info ] [Thread-4 (]: 4 of 5 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m16:43:06.178046 [info ] [Thread-1 (]: 5 of 5 START sql table model L1_LANDING.int_orders ............................. [RUN]
[0m16:43:06.180051 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m16:43:06.181048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snow_dbt.stg_customers, now model.snow_dbt.int_orders)
[0m16:43:06.182050 [debug] [Thread-4 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m16:43:06.183092 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.int_orders
[0m16:43:06.188090 [debug] [Thread-4 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m16:43:06.193051 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.int_orders"
[0m16:43:06.195052 [debug] [Thread-4 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m16:43:06.202053 [debug] [Thread-4 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m16:43:06.203053 [debug] [Thread-1 (]: Began executing node model.snow_dbt.int_orders
[0m16:43:06.209093 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.int_orders"
[0m16:43:06.215052 [debug] [Thread-4 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m16:43:06.216053 [debug] [Thread-4 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers),
orders as (select * from finance_db.L1_LANDING.stg_orders),
payments as (select * from finance_db.L1_LANDING.stg_payments),

customer_order_history as (
     select 
        customers.customer_id,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) as first_order_date,
        min(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as first_non_returned_order_date,
        max(case when orders.order_status NOT IN ('returned','return_pending') then orders.order_date end) as most_recent_non_returned_order_date,
        coalesce(max(orders.user_order_seq), 0) as order_count,
        coalesce(count(case when orders.order_status != 'returned' then 1 end), 0) as non_returned_order_count,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) as total_lifetime_value,
        sum(case when orders.order_status NOT IN ('returned','return_pending') then payments.payment_amount else 0 end) 
        /
        nullif(count(case when orders.order_status NOT IN ('returned','return_pending') then 1 end), 0) as avg_non_returned_order_value,
        array_agg(distinct orders.order_id) as order_ids
        from orders
        join customers
        on orders.customer_id = customers.customer_id
        left outer join payments
        on orders.order_id = payments.order_id
        where orders.order_status NOT IN ('pending') and payments.payment_status != 'fail'
        group by customers.customer_id, customers.givenname, customers.surname , customers.full_name
        ),
-- Final CTE to select from orders and join with customers and customer_order_history

final as ( 
    select 
    orders.order_id ,
    orders.customer_id ,
    customers.surname,
    customers.givenname,
    customer_order_history.first_order_date,
    customer_order_history.order_count,
    customer_order_history.total_lifetime_value,
    payments.payment_amount as order_value_dollars,
    orders.order_status ,
    payments.payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.customer_id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id
    left join payments
    on orders.order_id = payments.order_id
    where payments.payment_status != 'fail'
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m16:43:06.217050 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:43:06.219049 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.int_orders"
[0m16:43:06.223054 [debug] [Thread-1 (]: On model.snow_dbt.int_orders: create or replace transient table finance_db.L1_LANDING.int_orders
    
    
    
    as (with
orders as 
    (select * from finance_db.L1_LANDING.stg_orders),
payments as
     (select * from finance_db.L1_LANDING.stg_payments
where payments.payment_status != 'fail'),

order_total as ( 
    select 
        order_id, 
        order_status,
        sum(payment_amount) as order_value_dollars
    from payments
    group by order_id, order_status
),

order_value_join as ( 
    select 
        orders.*,
        order_total.order_status,
        order_total.order_value_dollars
    from orders
    left join order_total
    on orders.order_id = order_total.order_id
)
select * from order_value_join


    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.int_orders"} */;
[0m16:43:06.315051 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be1417-0000-a49b-0000-a1790006401a
[0m16:43:06.316052 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 6
invalid identifier 'PAYMENTS.PAYMENT_STATUS'
[0m16:43:06.318052 [debug] [Thread-1 (]: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 6
  invalid identifier 'PAYMENTS.PAYMENT_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:43:06.319051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022452621F30>]}
[0m16:43:06.320052 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model L1_LANDING.int_orders .................... [[31mERROR[0m in 0.14s]
[0m16:43:06.321051 [debug] [Thread-1 (]: Finished running node model.snow_dbt.int_orders
[0m16:43:06.322053 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.int_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 6
  invalid identifier 'PAYMENTS.PAYMENT_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql.
[0m16:43:08.382075 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.165 seconds
[0m16:43:08.390067 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3a52f34-d108-4919-916c-533148bac61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224526216C0>]}
[0m16:43:08.392019 [info ] [Thread-4 (]: 4 of 5 OK created sql table model L1_LANDING.fct_customer_orders ............... [[32mSUCCESS 1[0m in 2.21s]
[0m16:43:08.395058 [debug] [Thread-4 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m16:43:08.398055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:08.399052 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:43:08.400053 [debug] [MainThread]: On list_finance_db: Close
[0m16:43:08.471812 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:43:08.472813 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:43:08.560811 [debug] [MainThread]: Connection 'model.snow_dbt.int_orders' was left open.
[0m16:43:08.561811 [debug] [MainThread]: On model.snow_dbt.int_orders: Close
[0m16:43:08.629814 [debug] [MainThread]: Connection 'model.snow_dbt.stg_orders' was left open.
[0m16:43:08.630815 [debug] [MainThread]: On model.snow_dbt.stg_orders: Close
[0m16:43:08.702549 [debug] [MainThread]: Connection 'model.snow_dbt.stg_payments' was left open.
[0m16:43:08.704544 [debug] [MainThread]: On model.snow_dbt.stg_payments: Close
[0m16:43:08.786506 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m16:43:08.788507 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m16:43:08.855497 [info ] [MainThread]: 
[0m16:43:08.856500 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m16:43:08.859500 [debug] [MainThread]: Command end result
[0m16:43:08.972376 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:43:08.975131 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:43:08.985573 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:43:08.985573 [info ] [MainThread]: 
[0m16:43:08.986570 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:43:08.987569 [info ] [MainThread]: 
[0m16:43:08.988569 [error] [MainThread]: [31mFailure in model int_orders (models\marts\intermedate\int_orders.sql)[0m
[0m16:43:08.989569 [error] [MainThread]:   Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 6
  invalid identifier 'PAYMENTS.PAYMENT_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:43:08.989569 [info ] [MainThread]: 
[0m16:43:08.990572 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:43:08.991570 [info ] [MainThread]: 
[0m16:43:08.992576 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m16:43:08.993569 [debug] [MainThread]: Command `dbt run` failed at 16:43:08.993569 after 8.02 seconds
[0m16:43:08.994573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244DBA56C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224501E03D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244EE2AA40>]}
[0m16:43:08.995571 [debug] [MainThread]: Flushing usage events
[0m16:43:09.841748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:54.387378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF91A95690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF93CFC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF93CFC1F0>]}


============================== 16:47:54.391420 | 34acee42-2c2b-44f1-bb7a-e4ecbf4bb2b3 ==============================
[0m16:47:54.391420 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:47:54.392421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s int_orders.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:55.177249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34acee42-2c2b-44f1-bb7a-e4ecbf4bb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF947B7820>]}
[0m16:47:55.275244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34acee42-2c2b-44f1-bb7a-e4ecbf4bb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF9479B070>]}
[0m16:47:55.277202 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:47:55.664251 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:47:55.894200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:55.895201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:55.906246 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m16:47:55.964898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34acee42-2c2b-44f1-bb7a-e4ecbf4bb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF95D79D50>]}
[0m16:47:56.088992 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:47:56.091987 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:47:56.128348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34acee42-2c2b-44f1-bb7a-e4ecbf4bb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF95D2CC70>]}
[0m16:47:56.129352 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m16:47:56.130348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34acee42-2c2b-44f1-bb7a-e4ecbf4bb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF95D2CD60>]}
[0m16:47:56.132379 [info ] [MainThread]: 
[0m16:47:56.133350 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:56.134349 [info ] [MainThread]: 
[0m16:47:56.135349 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:47:56.137373 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:47:56.240390 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:47:56.241389 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:47:56.242390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:57.075182 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.832 seconds
[0m16:47:57.096114 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:47:57.116111 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:47:57.117110 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:47:57.118110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:57.553739 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.436 seconds
[0m16:47:57.559648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34acee42-2c2b-44f1-bb7a-e4ecbf4bb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF95CFCD00>]}
[0m16:47:57.565842 [debug] [Thread-1 (]: Began running node model.snow_dbt.int_orders
[0m16:47:57.567844 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.int_orders ............................. [RUN]
[0m16:47:57.568844 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.int_orders'
[0m16:47:57.570845 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.int_orders
[0m16:47:57.581845 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.int_orders"
[0m16:47:57.582840 [debug] [Thread-1 (]: Began executing node model.snow_dbt.int_orders
[0m16:47:57.623838 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.int_orders"
[0m16:47:57.625840 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.int_orders"
[0m16:47:57.626838 [debug] [Thread-1 (]: On model.snow_dbt.int_orders: create or replace transient table finance_db.L1_LANDING.int_orders
    
    
    
    as (with
orders as 
    (select * from finance_db.L1_LANDING.stg_orders),
payments as
     (select * from finance_db.L1_LANDING.stg_payments
where payments.payment_status != 'fail'),

order_total as ( 
    select 
        order_id, 
        order_status,
        sum(payment_amount) as order_value_dollars
    from payments
    group by order_id, order_status
),

order_value_join as ( 
    select 
        orders.*,
        order_total.order_status,
        order_total.order_value_dollars
    from orders
    left join order_total
    on orders.order_id = order_total.order_id
)
select * from order_value_join


    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.int_orders"} */;
[0m16:47:57.627838 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:47:58.007759 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be141c-0000-a465-0000-a17900061072
[0m16:47:58.008760 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 6
invalid identifier 'PAYMENTS.PAYMENT_STATUS'
[0m16:47:58.011761 [debug] [Thread-1 (]: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 6
  invalid identifier 'PAYMENTS.PAYMENT_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:47:58.014553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34acee42-2c2b-44f1-bb7a-e4ecbf4bb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF965353F0>]}
[0m16:47:58.015561 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model L1_LANDING.int_orders .................... [[31mERROR[0m in 0.44s]
[0m16:47:58.016596 [debug] [Thread-1 (]: Finished running node model.snow_dbt.int_orders
[0m16:47:58.017647 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.int_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 6
  invalid identifier 'PAYMENTS.PAYMENT_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql.
[0m16:47:58.020605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:58.021608 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:47:58.021608 [debug] [MainThread]: On list_finance_db: Close
[0m16:47:58.101202 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:47:58.102157 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:47:58.178544 [debug] [MainThread]: Connection 'model.snow_dbt.int_orders' was left open.
[0m16:47:58.179542 [debug] [MainThread]: On model.snow_dbt.int_orders: Close
[0m16:47:58.247214 [info ] [MainThread]: 
[0m16:47:58.249213 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m16:47:58.251213 [debug] [MainThread]: Command end result
[0m16:47:58.286210 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:47:58.290209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:47:58.300218 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:47:58.301213 [info ] [MainThread]: 
[0m16:47:58.302211 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:47:58.303212 [info ] [MainThread]: 
[0m16:47:58.304210 [error] [MainThread]: [31mFailure in model int_orders (models\marts\intermedate\int_orders.sql)[0m
[0m16:47:58.305024 [error] [MainThread]:   Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 6
  invalid identifier 'PAYMENTS.PAYMENT_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:47:58.306031 [info ] [MainThread]: 
[0m16:47:58.307033 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:47:58.308036 [info ] [MainThread]: 
[0m16:47:58.309031 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:47:58.310036 [debug] [MainThread]: Command `dbt run` failed at 16:47:58.310036 after 4.03 seconds
[0m16:47:58.311037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF91A95690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF93413F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF92D3BAC0>]}
[0m16:47:58.312035 [debug] [MainThread]: Flushing usage events
[0m16:47:59.010578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:00.721226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C48A5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C5B3C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C5B3C250>]}


============================== 16:49:00.725954 | 6188908f-c584-47bf-bbdb-6409c2b9bb33 ==============================
[0m16:49:00.725954 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:49:00.727671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s int_orders.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:01.484138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6188908f-c584-47bf-bbdb-6409c2b9bb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C660A6E0>]}
[0m16:49:01.569092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6188908f-c584-47bf-bbdb-6409c2b9bb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C65D0400>]}
[0m16:49:01.571095 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:49:01.945529 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:49:02.169574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:02.170574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:02.179526 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m16:49:02.230527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6188908f-c584-47bf-bbdb-6409c2b9bb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C7BB9DE0>]}
[0m16:49:02.346527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:49:02.349527 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:49:02.385145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6188908f-c584-47bf-bbdb-6409c2b9bb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C7B70F40>]}
[0m16:49:02.386147 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m16:49:02.388147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6188908f-c584-47bf-bbdb-6409c2b9bb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C7B72680>]}
[0m16:49:02.390188 [info ] [MainThread]: 
[0m16:49:02.391177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:49:02.392189 [info ] [MainThread]: 
[0m16:49:02.393151 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:49:02.396147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:49:02.496211 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:49:02.497212 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:49:02.497212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:02.980670 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.483 seconds
[0m16:49:02.989453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:49:03.006504 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:49:03.007502 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:49:03.008460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:03.431688 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.423 seconds
[0m16:49:03.437642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6188908f-c584-47bf-bbdb-6409c2b9bb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C7B36EC0>]}
[0m16:49:03.443405 [debug] [Thread-1 (]: Began running node model.snow_dbt.int_orders
[0m16:49:03.444436 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.int_orders ............................. [RUN]
[0m16:49:03.446405 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.int_orders'
[0m16:49:03.447403 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.int_orders
[0m16:49:03.458403 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.int_orders"
[0m16:49:03.459402 [debug] [Thread-1 (]: Began executing node model.snow_dbt.int_orders
[0m16:49:03.501402 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.int_orders"
[0m16:49:03.504403 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.int_orders"
[0m16:49:03.504403 [debug] [Thread-1 (]: On model.snow_dbt.int_orders: create or replace transient table finance_db.L1_LANDING.int_orders
    
    
    
    as (with
orders as 
    (select * from finance_db.L1_LANDING.stg_orders
    ),

payments as
     (select * from finance_db.L1_LANDING.stg_payments
     where payments.payment_status != 'fail'
),

order_total as ( 
    select 
        order_id, 
        payment_status,
        sum(payment_amount) as order_value_dollars
    from payments
    group by order_id, order_status
),

order_value_join as ( 
    select 
        orders.*,
        order_total.order_status,
        order_total.order_value_dollars
    from orders
    left join order_total
    on orders.order_id = order_total.order_id
)
select * from order_value_join


    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.int_orders"} */;
[0m16:49:03.505403 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:03.778395 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be141d-0000-a498-0000-a17900065016
[0m16:49:03.779374 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 11
invalid identifier 'PAYMENTS.PAYMENT_STATUS'
[0m16:49:03.781402 [debug] [Thread-1 (]: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 12 at position 11
  invalid identifier 'PAYMENTS.PAYMENT_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:49:03.784399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6188908f-c584-47bf-bbdb-6409c2b9bb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C81768F0>]}
[0m16:49:03.785398 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model L1_LANDING.int_orders .................... [[31mERROR[0m in 0.34s]
[0m16:49:03.787398 [debug] [Thread-1 (]: Finished running node model.snow_dbt.int_orders
[0m16:49:03.788355 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.int_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 12 at position 11
  invalid identifier 'PAYMENTS.PAYMENT_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql.
[0m16:49:03.790355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:03.791359 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:49:03.791359 [debug] [MainThread]: On list_finance_db: Close
[0m16:49:03.887096 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:49:03.888100 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:49:03.969690 [debug] [MainThread]: Connection 'model.snow_dbt.int_orders' was left open.
[0m16:49:03.969690 [debug] [MainThread]: On model.snow_dbt.int_orders: Close
[0m16:49:04.053208 [info ] [MainThread]: 
[0m16:49:04.055260 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m16:49:04.057207 [debug] [MainThread]: Command end result
[0m16:49:04.102276 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:49:04.106249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:49:04.117228 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:49:04.118206 [info ] [MainThread]: 
[0m16:49:04.119206 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:49:04.120210 [info ] [MainThread]: 
[0m16:49:04.121204 [error] [MainThread]: [31mFailure in model int_orders (models\marts\intermedate\int_orders.sql)[0m
[0m16:49:04.122205 [error] [MainThread]:   Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 12 at position 11
  invalid identifier 'PAYMENTS.PAYMENT_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:49:04.123204 [info ] [MainThread]: 
[0m16:49:04.124208 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:49:04.124208 [info ] [MainThread]: 
[0m16:49:04.126211 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:49:04.127204 [debug] [MainThread]: Command `dbt run` failed at 16:49:04.127204 after 3.52 seconds
[0m16:49:04.128250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C48A5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C1C12EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C2B720E0>]}
[0m16:49:04.129252 [debug] [MainThread]: Flushing usage events
[0m16:49:04.808373 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:14.841698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAAD156F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DABFA4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DABFA4250>]}


============================== 16:53:14.846654 | 648bdb00-2dec-4268-838f-4874b627466e ==============================
[0m16:53:14.846654 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:53:14.847655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s int_orders.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:15.595615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '648bdb00-2dec-4268-838f-4874b627466e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DACACBE80>]}
[0m16:53:15.680607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '648bdb00-2dec-4268-838f-4874b627466e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DABFA44F0>]}
[0m16:53:15.682566 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:53:16.061617 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:53:16.289126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:16.290126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:16.299190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m16:53:16.351421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '648bdb00-2dec-4268-838f-4874b627466e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAE029DB0>]}
[0m16:53:16.470646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:53:16.473648 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:53:16.510564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '648bdb00-2dec-4268-838f-4874b627466e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DADFE0E80>]}
[0m16:53:16.511600 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m16:53:16.512570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '648bdb00-2dec-4268-838f-4874b627466e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DADFE0E50>]}
[0m16:53:16.514569 [info ] [MainThread]: 
[0m16:53:16.515359 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:53:16.516369 [info ] [MainThread]: 
[0m16:53:16.517370 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:53:16.520371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:53:16.617437 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:53:16.618438 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:53:16.619438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:17.471231 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.852 seconds
[0m16:53:17.497101 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:53:17.516110 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:53:17.517112 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:53:17.518111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:17.839762 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.322 seconds
[0m16:53:17.854785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '648bdb00-2dec-4268-838f-4874b627466e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DADFE2B90>]}
[0m16:53:17.866552 [debug] [Thread-1 (]: Began running node model.snow_dbt.int_orders
[0m16:53:17.868511 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.int_orders ............................. [RUN]
[0m16:53:17.870501 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.int_orders'
[0m16:53:17.871499 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.int_orders
[0m16:53:17.887495 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.int_orders"
[0m16:53:17.888495 [debug] [Thread-1 (]: Began executing node model.snow_dbt.int_orders
[0m16:53:17.930493 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.int_orders"
[0m16:53:17.932492 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.int_orders"
[0m16:53:17.933494 [debug] [Thread-1 (]: On model.snow_dbt.int_orders: create or replace transient table finance_db.L1_LANDING.int_orders
    
    
    
    as (with
orders as 
    (select * from finance_db.L1_LANDING.stg_orders
    ),

payments as
     (select * from finance_db.L1_LANDING.stg_payments
     where payment_status != 'fail'
),

order_total as ( 
    select 
        order_id, 
        payment_status,
        sum(payment_amount) as order_value_dollars
    from payments
    group by order_id, order_status
),

order_value_join as ( 
    select 
        orders.*,
        order_total.order_status,
        order_total.order_value_dollars
    from orders
    left join order_total
    on orders.order_id = order_total.order_id
)
select * from order_value_join


    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.int_orders"} */;
[0m16:53:17.933494 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:53:18.146349 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be1421-0000-a464-0000-a1790005272e
[0m16:53:18.147393 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 23
invalid identifier 'ORDER_STATUS'
[0m16:53:18.149393 [debug] [Thread-1 (]: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 21 at position 23
  invalid identifier 'ORDER_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:53:18.153354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '648bdb00-2dec-4268-838f-4874b627466e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAE5E28C0>]}
[0m16:53:18.154347 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model L1_LANDING.int_orders .................... [[31mERROR[0m in 0.28s]
[0m16:53:18.155353 [debug] [Thread-1 (]: Finished running node model.snow_dbt.int_orders
[0m16:53:18.156392 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.int_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 21 at position 23
  invalid identifier 'ORDER_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql.
[0m16:53:18.158307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:18.159359 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:53:18.160359 [debug] [MainThread]: On list_finance_db: Close
[0m16:53:18.221117 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:53:18.222115 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:53:18.300283 [debug] [MainThread]: Connection 'model.snow_dbt.int_orders' was left open.
[0m16:53:18.302289 [debug] [MainThread]: On model.snow_dbt.int_orders: Close
[0m16:53:18.383143 [info ] [MainThread]: 
[0m16:53:18.385098 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m16:53:18.386097 [debug] [MainThread]: Command end result
[0m16:53:18.420089 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:53:18.425094 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:53:18.436094 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:53:18.437093 [info ] [MainThread]: 
[0m16:53:18.439092 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:53:18.440091 [info ] [MainThread]: 
[0m16:53:18.441103 [error] [MainThread]: [31mFailure in model int_orders (models\marts\intermedate\int_orders.sql)[0m
[0m16:53:18.442091 [error] [MainThread]:   Database Error in model int_orders (models\marts\intermedate\int_orders.sql)
  000904 (42000): SQL compilation error: error line 21 at position 23
  invalid identifier 'ORDER_STATUS'
  compiled code at target\run\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:53:18.444096 [info ] [MainThread]: 
[0m16:53:18.445092 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\intermedate\int_orders.sql
[0m16:53:18.446093 [info ] [MainThread]: 
[0m16:53:18.448090 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:53:18.450093 [debug] [MainThread]: Command `dbt run` failed at 16:53:18.450093 after 3.73 seconds
[0m16:53:18.451090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAAD156F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DABFA44F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAAFE4280>]}
[0m16:53:18.452092 [debug] [MainThread]: Flushing usage events
[0m16:53:19.132215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:26.227430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E1B85750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E3DEC430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E3DEC250>]}


============================== 16:54:26.231429 | d387f234-cc08-4aac-a54c-b2f19dd14f2a ==============================
[0m16:54:26.231429 [info ] [MainThread]: Running with dbt=1.10.5
[0m16:54:26.233435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s int_orders.sql', 'send_anonymous_usage_stats': 'True'}
[0m16:54:26.973173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd387f234-cc08-4aac-a54c-b2f19dd14f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E354E140>]}
[0m16:54:27.059171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd387f234-cc08-4aac-a54c-b2f19dd14f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E4874250>]}
[0m16:54:27.061226 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:54:27.443283 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m16:54:27.711755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:27.712749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:27.722762 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m16:54:27.773975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd387f234-cc08-4aac-a54c-b2f19dd14f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E5E69E10>]}
[0m16:54:27.893500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:54:27.896503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:54:27.932495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd387f234-cc08-4aac-a54c-b2f19dd14f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E5E23CA0>]}
[0m16:54:27.933494 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m16:54:27.934493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd387f234-cc08-4aac-a54c-b2f19dd14f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E5E239D0>]}
[0m16:54:27.936538 [info ] [MainThread]: 
[0m16:54:27.937536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:54:27.938493 [info ] [MainThread]: 
[0m16:54:27.939534 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:54:27.942494 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m16:54:28.044624 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m16:54:28.044624 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m16:54:28.045620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:29.005413 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.959 seconds
[0m16:54:29.015354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m16:54:29.031359 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m16:54:29.032408 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m16:54:29.033402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:29.407566 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.375 seconds
[0m16:54:29.412999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd387f234-cc08-4aac-a54c-b2f19dd14f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E5DE90C0>]}
[0m16:54:29.419507 [debug] [Thread-1 (]: Began running node model.snow_dbt.int_orders
[0m16:54:29.420509 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.int_orders ............................. [RUN]
[0m16:54:29.421507 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.int_orders'
[0m16:54:29.422509 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.int_orders
[0m16:54:29.433553 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.int_orders"
[0m16:54:29.434554 [debug] [Thread-1 (]: Began executing node model.snow_dbt.int_orders
[0m16:54:29.476514 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.int_orders"
[0m16:54:29.478512 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.int_orders"
[0m16:54:29.479515 [debug] [Thread-1 (]: On model.snow_dbt.int_orders: create or replace transient table finance_db.L1_LANDING.int_orders
    
    
    
    as (with
orders as 
    (select * from finance_db.L1_LANDING.stg_orders
    ),

payments as
     (select * from finance_db.L1_LANDING.stg_payments
     where payment_status != 'fail'
),

order_total as ( 
    select 
        order_id, 
        payment_status,
        sum(payment_amount) as order_value_dollars
    from payments
    group by order_id, payment_status
),

order_value_join as ( 
    select 
        orders.*,
        order_total.payment_status,
        order_total.order_value_dollars
    from orders
    left join order_total
    on orders.order_id = order_total.order_id
)
select * from order_value_join


    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.int_orders"} */;
[0m16:54:29.480516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:31.357762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.878 seconds
[0m16:54:31.387759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd387f234-cc08-4aac-a54c-b2f19dd14f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E0090E50>]}
[0m16:54:31.388761 [info ] [Thread-1 (]: 1 of 1 OK created sql table model L1_LANDING.int_orders ........................ [[32mSUCCESS 1[0m in 1.96s]
[0m16:54:31.389759 [debug] [Thread-1 (]: Finished running node model.snow_dbt.int_orders
[0m16:54:31.391761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:31.392804 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m16:54:31.392804 [debug] [MainThread]: On list_finance_db: Close
[0m16:54:31.454805 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m16:54:31.454805 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m16:54:31.534309 [debug] [MainThread]: Connection 'model.snow_dbt.int_orders' was left open.
[0m16:54:31.535308 [debug] [MainThread]: On model.snow_dbt.int_orders: Close
[0m16:54:31.609361 [info ] [MainThread]: 
[0m16:54:31.611326 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m16:54:31.615150 [debug] [MainThread]: Command end result
[0m16:54:31.661125 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m16:54:31.666131 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m16:54:31.676128 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m16:54:31.677135 [info ] [MainThread]: 
[0m16:54:31.678134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:31.679133 [info ] [MainThread]: 
[0m16:54:31.680132 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:54:31.682136 [debug] [MainThread]: Command `dbt run` succeeded at 16:54:31.682136 after 5.56 seconds
[0m16:54:31.682136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E1B85750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E35036D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E2E26F50>]}
[0m16:54:31.683128 [debug] [MainThread]: Flushing usage events
[0m16:54:32.435875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:15:32.274321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002669BE91780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002669E0E87C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002669E0E85E0>]}


============================== 01:15:32.307323 | d3e44481-218c-4f24-86a3-31579dcd049d ==============================
[0m01:15:32.307323 [info ] [MainThread]: Running with dbt=1.10.5
[0m01:15:32.317322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:15:33.248359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3e44481-218c-4f24-86a3-31579dcd049d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002669A1CEF80>]}
[0m01:15:33.348904 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:15:33.355905 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:15:33.361901 [debug] [MainThread]: Command `cli deps` succeeded at 01:15:33.360906 after 1.58 seconds
[0m01:15:33.364905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002669BE91780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002669E09B6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002669E0B0940>]}
[0m01:15:33.367904 [debug] [MainThread]: Flushing usage events
[0m01:15:34.098356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:58.747656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001643DC13E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001643FD5B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001643FD5B1F0>]}


============================== 01:59:58.760723 | e330fcf6-2b00-452d-b231-95190cb3abb6 ==============================
[0m01:59:58.760723 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:59:58.762685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s fct_customer_orders.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:00:07.603539 [debug] [MainThread]: Traceback (most recent call last):
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m02:00:07.604607 [error] [MainThread]: Encountered an error:
No module named 'dbt.adapters.catalogs'
[0m02:00:07.682711 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 232, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\runtime.py", line 79, in load_profile
    profile = Profile.render(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\config\profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\alawa\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m02:00:07.687655 [debug] [MainThread]: Command `dbt run` failed at 02:00:07.687655 after 9.17 seconds
[0m02:00:07.689654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001643DC13E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016450941480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016450941630>]}
[0m02:00:07.691670 [debug] [MainThread]: Flushing usage events
[0m02:00:08.447736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:53.455128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA4509780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA579C400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA579C220>]}


============================== 02:00:53.465122 | 93baba4f-a4fd-4f1b-8497-900c508eb642 ==============================
[0m02:00:53.465122 [info ] [MainThread]: Running with dbt=1.10.5
[0m02:00:53.468120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s fct_customer_orders.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:00:56.147881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93baba4f-a4fd-4f1b-8497-900c508eb642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA47DD3F0>]}
[0m02:00:56.332881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93baba4f-a4fd-4f1b-8497-900c508eb642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA489E5F0>]}
[0m02:00:56.337186 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m02:00:57.660103 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m02:00:58.235049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:00:58.236051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:00:58.259103 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m02:00:58.394426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93baba4f-a4fd-4f1b-8497-900c508eb642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA7819E10>]}
[0m02:00:58.656139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m02:00:58.691927 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m02:00:58.745726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93baba4f-a4fd-4f1b-8497-900c508eb642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA77D2890>]}
[0m02:00:58.747726 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m02:00:58.749726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93baba4f-a4fd-4f1b-8497-900c508eb642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA77D29B0>]}
[0m02:00:58.753778 [info ] [MainThread]: 
[0m02:00:58.755737 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:00:58.758732 [info ] [MainThread]: 
[0m02:00:58.760727 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:00:58.765723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m02:01:04.999519 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m02:01:05.001520 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m02:01:05.004520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:06.192536 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.188 seconds
[0m02:01:06.228535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m02:01:06.303471 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m02:01:06.306534 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m02:01:06.310469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:06.866737 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.556 seconds
[0m02:01:06.890791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93baba4f-a4fd-4f1b-8497-900c508eb642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA77D1C00>]}
[0m02:01:06.923801 [debug] [Thread-1 (]: Began running node model.snow_dbt.fct_customer_orders
[0m02:01:06.927791 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m02:01:06.931730 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m02:01:06.934792 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m02:01:06.980788 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m02:01:06.990802 [debug] [Thread-1 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m02:01:07.139802 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m02:01:07.154798 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m02:01:07.156795 [debug] [Thread-1 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers
),

orders as (
    select * from finance_db.L1_LANDING.int_orders
),
 
customer_orders as (
select 
        orders.* ,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) over (partition by customers.customer_id) as customer_first_order_date,
        min(orders.valid_order_date) over (partition by customers.customer_id) as customer_first_non_returned_order_date,
        max(orders.valid_order_date) over (partition by customers.customer_id) as customer_most_recent_non_returned_order_date,
        count(*) over (partition by customers.customer_id) as customer_order_count,
        sum(nvl2(orders.valid_order_date, 1, 0) over (partition by customers.customer_id)) as customer_non_returned_order_count,
        sum(orders.valid_order_date, orders.order_value_dollars, 0) over (partition by customers.customer_id) as customer_total_lifetime_value,
        array_agg(distinct orders.order_id) over (partition by customers.customer_id) as customer_order_ids
from orders 
inner join customers
on orders.customer_id = customers.customer_id
),

add_avg_order_history as 
    (
    select 
        *,
        total_lifetime_value / non_returned_order_count as avg_non_returned_order_value

    from customer_orders
    ),

final as ( 
    select 
    order_id ,
    customer_id ,
    surname,
    givenname,
    customer_orders.customer_first_order_date as first_order_date,
    customer_orders.customer_order_count as order_count,
    customer_orders.customer_total_lifetime_value as total_lifetime_value,
    order_value_dollars,
    order_status ,
    payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.customer_id
    join customer_order_history
    on orders.customer_id = customer_order_history.customer_id

)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m02:01:07.158801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:01:08.186458 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be1645-0000-a4a5-0000-a17900067006
[0m02:01:08.188459 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CUSTOMER_ORDER_HISTORY' does not exist or not authorized.
[0m02:01:08.217166 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMER_ORDER_HISTORY' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m02:01:08.224171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93baba4f-a4fd-4f1b-8497-900c508eb642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA7DD69B0>]}
[0m02:01:08.226173 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 1.29s]
[0m02:01:08.229169 [debug] [Thread-1 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m02:01:08.231224 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMER_ORDER_HISTORY' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m02:01:08.236175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:08.238179 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m02:01:08.239217 [debug] [MainThread]: On list_finance_db: Close
[0m02:01:08.345147 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m02:01:08.348152 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m02:01:08.438124 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m02:01:08.439136 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m02:01:08.540608 [info ] [MainThread]: 
[0m02:01:08.544595 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.78 seconds (9.78s).
[0m02:01:08.552591 [debug] [MainThread]: Command end result
[0m02:01:08.733587 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m02:01:08.741584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m02:01:08.766859 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m02:01:08.768854 [info ] [MainThread]: 
[0m02:01:08.771861 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:01:08.772859 [info ] [MainThread]: 
[0m02:01:08.775719 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m02:01:08.777719 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'CUSTOMER_ORDER_HISTORY' does not exist or not authorized.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m02:01:08.779717 [info ] [MainThread]: 
[0m02:01:08.781723 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m02:01:08.784723 [info ] [MainThread]: 
[0m02:01:08.787716 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:01:08.790718 [debug] [MainThread]: Command `dbt run` failed at 02:01:08.790718 after 15.58 seconds
[0m02:01:08.793724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA4509780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA47C3F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA47DD3F0>]}
[0m02:01:08.796728 [debug] [MainThread]: Flushing usage events
[0m02:01:09.749152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:01:31.783904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C267039750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2682CC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2682CC1F0>]}


============================== 02:01:31.794002 | 5a4b4011-e841-4a26-adfe-ce46976c5666 ==============================
[0m02:01:31.794002 [info ] [MainThread]: Running with dbt=1.10.5
[0m02:01:31.795949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s fct_customer_orders.sql', 'send_anonymous_usage_stats': 'True'}
[0m02:01:33.570875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a4b4011-e841-4a26-adfe-ce46976c5666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2643A2F50>]}
[0m02:01:33.763929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a4b4011-e841-4a26-adfe-ce46976c5666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C268102110>]}
[0m02:01:33.767881 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m02:01:34.751156 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m02:01:35.268984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:01:35.270922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:01:35.290971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m02:01:35.404970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a4b4011-e841-4a26-adfe-ce46976c5666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26A349DE0>]}
[0m02:01:35.672331 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m02:01:35.678329 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m02:01:35.733969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a4b4011-e841-4a26-adfe-ce46976c5666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26A3032B0>]}
[0m02:01:35.735964 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m02:01:35.738968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a4b4011-e841-4a26-adfe-ce46976c5666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26A301F30>]}
[0m02:01:35.745023 [info ] [MainThread]: 
[0m02:01:35.747158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:01:35.749193 [info ] [MainThread]: 
[0m02:01:35.752187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:01:35.758182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m02:01:36.072227 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m02:01:36.074227 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m02:01:36.075226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:37.122762 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.048 seconds
[0m02:01:37.158816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m02:01:37.243758 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m02:01:37.246761 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m02:01:37.249744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:37.797308 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.548 seconds
[0m02:01:37.818240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a4b4011-e841-4a26-adfe-ce46976c5666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26A2CBC70>]}
[0m02:01:37.840369 [debug] [Thread-1 (]: Began running node model.snow_dbt.fct_customer_orders
[0m02:01:37.844363 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m02:01:37.848437 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m02:01:37.852375 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m02:01:37.899361 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m02:01:37.907367 [debug] [Thread-1 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m02:01:38.019414 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m02:01:38.027416 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m02:01:38.029414 [debug] [Thread-1 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers
),

orders as (
    select * from finance_db.L1_LANDING.int_orders
),
 
customer_orders as (
select 
        orders.* ,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) over (partition by customers.customer_id) as customer_first_order_date,
        min(orders.valid_order_date) over (partition by customers.customer_id) as customer_first_non_returned_order_date,
        max(orders.valid_order_date) over (partition by customers.customer_id) as customer_most_recent_non_returned_order_date,
        count(*) over (partition by customers.customer_id) as customer_order_count,
        sum(nvl2(orders.valid_order_date, 1, 0) over (partition by customers.customer_id)) as customer_non_returned_order_count,
        sum(orders.valid_order_date, orders.order_value_dollars, 0) over (partition by customers.customer_id) as customer_total_lifetime_value,
        array_agg(distinct orders.order_id) over (partition by customers.customer_id) as customer_order_ids
from orders 
inner join customers
on orders.customer_id = customers.customer_id
),

add_avg_order_history as 
    (
    select 
        *,
        total_lifetime_value / non_returned_order_count as avg_non_returned_order_value

    from customer_orders
    ),

final as ( 
    select 
    order_id ,
    customer_id ,
    surname,
    givenname,
    customer_orders.customer_first_order_date as first_order_date,
    customer_orders.customer_order_count as order_count,
    customer_orders.customer_total_lifetime_value as total_lifetime_value,
    order_value_dollars,
    order_status ,
    payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.customer_id
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m02:01:38.031357 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:01:38.502883 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be1645-0000-a464-0000-a1790005276e
[0m02:01:38.505893 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002060 (42601): SQL compilation error:
Invalid function type [NVL2] for window function.
[0m02:01:38.515894 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  002060 (42601): SQL compilation error:
  Invalid function type [NVL2] for window function.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m02:01:38.527398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a4b4011-e841-4a26-adfe-ce46976c5666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26A9068C0>]}
[0m02:01:38.532374 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 0.67s]
[0m02:01:38.536320 [debug] [Thread-1 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m02:01:38.540387 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  002060 (42601): SQL compilation error:
  Invalid function type [NVL2] for window function.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m02:01:38.550310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:38.553321 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m02:01:38.556310 [debug] [MainThread]: On list_finance_db: Close
[0m02:01:38.654798 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m02:01:38.658789 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m02:01:38.764069 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m02:01:38.767100 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m02:01:38.880040 [info ] [MainThread]: 
[0m02:01:38.884037 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m02:01:38.890027 [debug] [MainThread]: Command end result
[0m02:01:39.049028 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m02:01:39.067019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m02:01:39.121019 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m02:01:39.125025 [info ] [MainThread]: 
[0m02:01:39.129016 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:01:39.132017 [info ] [MainThread]: 
[0m02:01:39.136017 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m02:01:39.139013 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  002060 (42601): SQL compilation error:
  Invalid function type [NVL2] for window function.
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m02:01:39.143014 [info ] [MainThread]: 
[0m02:01:39.146017 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m02:01:39.149017 [info ] [MainThread]: 
[0m02:01:39.154049 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:01:39.161018 [debug] [MainThread]: Command `dbt run` failed at 02:01:39.160016 after 7.64 seconds
[0m02:01:39.164017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C267039750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C267A2E140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26A346260>]}
[0m02:01:39.167014 [debug] [MainThread]: Flushing usage events
[0m02:01:39.856830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:06:45.599331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806DB396F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806EDCC490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806EDCC2B0>]}


============================== 02:06:45.612936 | 868007a6-7218-40bf-a35a-ac81d0790a7b ==============================
[0m02:06:45.612936 [info ] [MainThread]: Running with dbt=1.10.5
[0m02:06:45.615903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s fct_customer_orders.sql', 'send_anonymous_usage_stats': 'True'}
[0m02:06:47.409086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '868007a6-7218-40bf-a35a-ac81d0790a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806DDFD090>]}
[0m02:06:47.602135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '868007a6-7218-40bf-a35a-ac81d0790a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806F860400>]}
[0m02:06:47.606012 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m02:06:48.672989 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m02:06:49.185992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:06:49.186990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:06:49.207989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m02:06:49.317992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '868007a6-7218-40bf-a35a-ac81d0790a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018070E49D80>]}
[0m02:06:49.578990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m02:06:49.586948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m02:06:49.636954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '868007a6-7218-40bf-a35a-ac81d0790a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018070E00EB0>]}
[0m02:06:49.637951 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m02:06:49.639951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '868007a6-7218-40bf-a35a-ac81d0790a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018070E00E80>]}
[0m02:06:49.644989 [info ] [MainThread]: 
[0m02:06:49.647351 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:06:49.649359 [info ] [MainThread]: 
[0m02:06:49.652399 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:06:49.656362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m02:06:49.902997 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m02:06:49.905002 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m02:06:49.905998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:50.955242 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.049 seconds
[0m02:06:50.992031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m02:06:51.060030 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m02:06:51.063030 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m02:06:51.065964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:51.536497 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.471 seconds
[0m02:06:51.555501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '868007a6-7218-40bf-a35a-ac81d0790a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018070DCDC60>]}
[0m02:06:51.577616 [debug] [Thread-1 (]: Began running node model.snow_dbt.fct_customer_orders
[0m02:06:51.581684 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m02:06:51.585624 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m02:06:51.588683 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m02:06:51.634612 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m02:06:51.640610 [debug] [Thread-1 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m02:06:51.748657 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m02:06:51.756660 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m02:06:51.757667 [debug] [Thread-1 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers
),

orders as (
    select * from finance_db.L1_LANDING.int_orders
),
 
customer_orders as (
select 
        orders.* ,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) over (partition by customers.customer_id) as customer_first_order_date,
        min(orders.valid_order_date) over (partition by customers.customer_id) as customer_first_non_returned_order_date,
        max(orders.valid_order_date) over (partition by customers.customer_id) as customer_most_recent_non_returned_order_date,
        count(*) over (partition by customers.customer_id) as customer_order_count,
        sum(nvl2(orders.valid_order_date, 1, 0)) over (partition by customers.customer_id) as customer_non_returned_order_count,
        sum(orders.valid_order_date, orders.order_value_dollars, 0) over (partition by customers.customer_id) as customer_total_lifetime_value,
        array_agg(distinct orders.order_id) over (partition by customers.customer_id) as customer_order_ids
from orders 
inner join customers
on orders.customer_id = customers.customer_id
),

add_avg_order_history as 
    (
    select 
        *,
        customer_total_lifetime_value / customer_non_returned_order_count as avg_non_returned_order_value

    from customer_orders
    ),

final as ( 
    select 
    order_id ,
    customer_id ,
    surname,
    givenname,
    customer_orders.customer_first_order_date as first_order_date,
    customer_orders.customer_order_count as order_count,
    customer_orders.customer_total_lifetime_value as total_lifetime_value,
    order_value_dollars,
    order_status ,
    payment_status
    from orders 
    join customers 
    on orders.customer_id = customers.customer_id
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m02:06:51.759632 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:06:52.333800 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be164a-0000-a4a5-0000-a17900067012
[0m02:06:52.336790 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 26 at position 8
too many arguments for function [SUM(SYS_VW.VALID_ORDER_DATE_7, SYS_VW.ORDER_VALUE_DOLLARS_4, 0)] expected 1, got 3
[0m02:06:52.346796 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  000939 (22023): SQL compilation error: error line 26 at position 8
  too many arguments for function [SUM(SYS_VW.VALID_ORDER_DATE_7, SYS_VW.ORDER_VALUE_DOLLARS_4, 0)] expected 1, got 3
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m02:06:52.358800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '868007a6-7218-40bf-a35a-ac81d0790a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180715481F0>]}
[0m02:06:52.362789 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 0.77s]
[0m02:06:52.367789 [debug] [Thread-1 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m02:06:52.371799 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  000939 (22023): SQL compilation error: error line 26 at position 8
  too many arguments for function [SUM(SYS_VW.VALID_ORDER_DATE_7, SYS_VW.ORDER_VALUE_DOLLARS_4, 0)] expected 1, got 3
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m02:06:52.380733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:52.383731 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m02:06:52.387737 [debug] [MainThread]: On list_finance_db: Close
[0m02:06:52.484124 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m02:06:52.487126 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m02:06:52.587528 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m02:06:52.590525 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m02:06:52.694248 [info ] [MainThread]: 
[0m02:06:52.697253 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m02:06:52.703247 [debug] [MainThread]: Command end result
[0m02:06:52.837265 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m02:06:52.850250 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m02:06:52.889263 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m02:06:52.894254 [info ] [MainThread]: 
[0m02:06:52.899278 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:06:52.903252 [info ] [MainThread]: 
[0m02:06:52.908253 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m02:06:52.913248 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  000939 (22023): SQL compilation error: error line 26 at position 8
  too many arguments for function [SUM(SYS_VW.VALID_ORDER_DATE_7, SYS_VW.ORDER_VALUE_DOLLARS_4, 0)] expected 1, got 3
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m02:06:52.919262 [info ] [MainThread]: 
[0m02:06:52.926263 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m02:06:52.934256 [info ] [MainThread]: 
[0m02:06:52.940271 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m02:06:52.947276 [debug] [MainThread]: Command `dbt run` failed at 02:06:52.947276 after 7.60 seconds
[0m02:06:52.951276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806DB396F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806F886710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806DDFD090>]}
[0m02:06:52.954254 [debug] [MainThread]: Flushing usage events
[0m02:06:53.735957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:06:22.524789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9206A96F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C92193C490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C92193C2B0>]}


============================== 19:06:22.532791 | ca74bab8-5894-4a02-b36a-bc298bec8c60 ==============================
[0m19:06:22.532791 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:06:22.534791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s fct_customer_orders.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:06:24.170596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca74bab8-5894-4a02-b36a-bc298bec8c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C920965090>]}
[0m19:06:24.263599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca74bab8-5894-4a02-b36a-bc298bec8c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9223CC400>]}
[0m19:06:24.266597 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:06:24.994178 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:06:25.304223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:06:25.305223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:06:25.316221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m19:06:25.391181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca74bab8-5894-4a02-b36a-bc298bec8c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9239B9D80>]}
[0m19:06:25.578177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m19:06:25.602177 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m19:06:25.662175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca74bab8-5894-4a02-b36a-bc298bec8c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C923970EB0>]}
[0m19:06:25.664178 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m19:06:25.666179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca74bab8-5894-4a02-b36a-bc298bec8c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C923970E80>]}
[0m19:06:25.670177 [info ] [MainThread]: 
[0m19:06:25.671176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:06:25.673176 [info ] [MainThread]: 
[0m19:06:25.675177 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:06:25.678178 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m19:06:29.333829 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m19:06:29.333829 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m19:06:29.334830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:31.729571 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.395 seconds
[0m19:06:31.739571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m19:06:31.755621 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m19:06:31.755621 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m19:06:31.756618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:32.447853 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.690 seconds
[0m19:06:32.452866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca74bab8-5894-4a02-b36a-bc298bec8c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C923938880>]}
[0m19:06:32.470881 [debug] [Thread-1 (]: Began running node model.snow_dbt.fct_customer_orders
[0m19:06:32.471881 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m19:06:32.473884 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m19:06:32.474882 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m19:06:32.485886 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m19:06:32.487882 [debug] [Thread-1 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m19:06:32.529882 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m19:06:32.533931 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m19:06:32.534933 [debug] [Thread-1 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers
),

orders as (
    select * from finance_db.L1_LANDING.int_orders
),
 
customer_orders as (
select 
        orders.* ,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) over (partition by customers.customer_id) as customer_first_order_date,
        min(orders.valid_order_date) over (partition by customers.customer_id) as customer_first_non_returned_order_date,
        max(orders.valid_order_date) over (partition by customers.customer_id) as customer_most_recent_non_returned_order_date,
        count(*) over (partition by customers.customer_id) as customer_order_count,
        sum(nvl2(orders.valid_order_date, 1, 0)) over (partition by customers.customer_id) as customer_non_returned_order_count,
        sum(case when orders.valid_order_date is not null then orders.order_value_dollars else 0 end) 
        over (partition by customers.customer_id) as customer_total_lifetime_value,
        array_agg(distinct orders.order_id) over (partition by customers.customer_id) as customer_order_ids
from orders 
inner join customers
on orders.customer_id = customers.customer_id
),

add_avg_order_history as 
    (
    select 
        *,
        customer_total_lifetime_value / customer_non_returned_order_count as avg_non_returned_order_value

    from customer_orders
    ),

final as ( 
    select 
    order_id ,
    customer_id ,
    surname,
    givenname,
    customer_orders.customer_first_order_date as first_order_date,
    customer_orders.customer_order_count as order_count,
    customer_orders.customer_total_lifetime_value as total_lifetime_value,
    order_value_dollars,
    order_status ,
    payment_status
    from add_avg_order_history
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m19:06:32.535882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:06:33.151346 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be1a46-0000-a4e3-0000-a1790006900a
[0m19:06:33.151346 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 49 at position 4
invalid identifier 'CUSTOMER_ORDERS.CUSTOMER_FIRST_ORDER_DATE'
[0m19:06:33.167298 [debug] [Thread-1 (]: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  000904 (42000): SQL compilation error: error line 49 at position 4
  invalid identifier 'CUSTOMER_ORDERS.CUSTOMER_FIRST_ORDER_DATE'
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m19:06:33.171299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca74bab8-5894-4a02-b36a-bc298bec8c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9223F2710>]}
[0m19:06:33.172298 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model L1_LANDING.fct_customer_orders ........... [[31mERROR[0m in 0.70s]
[0m19:06:33.173135 [debug] [Thread-1 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m19:06:33.174193 [debug] [Thread-7 (]: Marking all children of 'model.snow_dbt.fct_customer_orders' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  000904 (42000): SQL compilation error: error line 49 at position 4
  invalid identifier 'CUSTOMER_ORDERS.CUSTOMER_FIRST_ORDER_DATE'
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql.
[0m19:06:33.177142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:33.178141 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m19:06:33.178141 [debug] [MainThread]: On list_finance_db: Close
[0m19:06:33.262029 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m19:06:33.265033 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m19:06:33.342685 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m19:06:33.343686 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m19:06:33.422569 [info ] [MainThread]: 
[0m19:06:33.425507 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m19:06:33.429733 [debug] [MainThread]: Command end result
[0m19:06:33.481663 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m19:06:33.484661 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m19:06:33.494704 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m19:06:33.495664 [info ] [MainThread]: 
[0m19:06:33.496665 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:06:33.497666 [info ] [MainThread]: 
[0m19:06:33.499667 [error] [MainThread]: [31mFailure in model fct_customer_orders (models\marts\fct_customer_orders.sql)[0m
[0m19:06:33.500665 [error] [MainThread]:   Database Error in model fct_customer_orders (models\marts\fct_customer_orders.sql)
  000904 (42000): SQL compilation error: error line 49 at position 4
  invalid identifier 'CUSTOMER_ORDERS.CUSTOMER_FIRST_ORDER_DATE'
  compiled code at target\run\snow_dbt\models\marts\fct_customer_orders.sql
[0m19:06:33.501665 [info ] [MainThread]: 
[0m19:06:33.502666 [info ] [MainThread]:   compiled code at target\compiled\snow_dbt\models\marts\fct_customer_orders.sql
[0m19:06:33.503662 [info ] [MainThread]: 
[0m19:06:33.504998 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:06:33.507051 [debug] [MainThread]: Command `dbt run` failed at 19:06:33.506006 after 11.12 seconds
[0m19:06:33.507051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9206A96F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9209661D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9239B60B0>]}
[0m19:06:33.508049 [debug] [MainThread]: Flushing usage events
[0m19:06:34.394295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:07:37.138705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183632296F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183644BC490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183644BC2B0>]}


============================== 19:07:37.144186 | b1636b61-cb6b-4294-b425-2f7d4bd7c817 ==============================
[0m19:07:37.144186 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:07:37.145182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s fct_customer_orders.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:07:38.006838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1636b61-cb6b-4294-b425-2f7d4bd7c817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183634ED090>]}
[0m19:07:38.155799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1636b61-cb6b-4294-b425-2f7d4bd7c817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018364F50400>]}
[0m19:07:38.159803 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:07:38.793192 [debug] [MainThread]: checksum: fa4c2685620973c5adba0a491aa9c06e8cf48c9113a5280b45b6efa706ae8f4b, vars: {}, profile: , target: , version: 1.10.5
[0m19:07:39.252194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:07:39.253195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:07:39.264193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snow_dbt.staging.legacy
[0m19:07:39.408196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1636b61-cb6b-4294-b425-2f7d4bd7c817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018366539D80>]}
[0m19:07:39.545200 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m19:07:39.549199 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m19:07:39.598196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1636b61-cb6b-4294-b425-2f7d4bd7c817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183664F0EB0>]}
[0m19:07:39.601199 [info ] [MainThread]: Found 5 models, 3 sources, 477 macros
[0m19:07:39.603194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1636b61-cb6b-4294-b425-2f7d4bd7c817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183664F0E80>]}
[0m19:07:39.606193 [info ] [MainThread]: 
[0m19:07:39.608208 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:07:39.610195 [info ] [MainThread]: 
[0m19:07:39.612198 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:07:39.615195 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db'
[0m19:07:39.791196 [debug] [ThreadPool]: Using snowflake connection "list_finance_db"
[0m19:07:39.792195 [debug] [ThreadPool]: On list_finance_db: show terse schemas in database finance_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db"} */
[0m19:07:39.793197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:40.379149 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.586 seconds
[0m19:07:40.391144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_finance_db_L1_LANDING'
[0m19:07:40.415149 [debug] [ThreadPool]: Using snowflake connection "list_finance_db_L1_LANDING"
[0m19:07:40.417148 [debug] [ThreadPool]: On list_finance_db_L1_LANDING: show objects in finance_db.L1_LANDING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "connection_name": "list_finance_db_L1_LANDING"} */;
[0m19:07:40.418147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:40.718884 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.300 seconds
[0m19:07:40.736887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1636b61-cb6b-4294-b425-2f7d4bd7c817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183664BC880>]}
[0m19:07:40.745882 [debug] [Thread-1 (]: Began running node model.snow_dbt.fct_customer_orders
[0m19:07:40.747884 [info ] [Thread-1 (]: 1 of 1 START sql table model L1_LANDING.fct_customer_orders .................... [RUN]
[0m19:07:40.750886 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snow_dbt.fct_customer_orders'
[0m19:07:40.752884 [debug] [Thread-1 (]: Began compiling node model.snow_dbt.fct_customer_orders
[0m19:07:40.769881 [debug] [Thread-1 (]: Writing injected SQL for node "model.snow_dbt.fct_customer_orders"
[0m19:07:40.771886 [debug] [Thread-1 (]: Began executing node model.snow_dbt.fct_customer_orders
[0m19:07:40.822879 [debug] [Thread-1 (]: Writing runtime sql for node "model.snow_dbt.fct_customer_orders"
[0m19:07:40.826883 [debug] [Thread-1 (]: Using snowflake connection "model.snow_dbt.fct_customer_orders"
[0m19:07:40.827920 [debug] [Thread-1 (]: On model.snow_dbt.fct_customer_orders: create or replace transient table finance_db.L1_LANDING.fct_customer_orders
    
    
    
    as (-- import CTEs
with 

customers as (select * from finance_db.L1_LANDING.stg_customers
),

orders as (
    select * from finance_db.L1_LANDING.int_orders
),
 
customer_orders as (
select 
        orders.* ,
        customers.givenname,
        customers.surname,
        customers.full_name,
        min(orders.order_date) over (partition by customers.customer_id) as customer_first_order_date,
        min(orders.valid_order_date) over (partition by customers.customer_id) as customer_first_non_returned_order_date,
        max(orders.valid_order_date) over (partition by customers.customer_id) as customer_most_recent_non_returned_order_date,
        count(*) over (partition by customers.customer_id) as customer_order_count,
        sum(nvl2(orders.valid_order_date, 1, 0)) over (partition by customers.customer_id) as customer_non_returned_order_count,
        sum(case when orders.valid_order_date is not null then orders.order_value_dollars else 0 end) 
        over (partition by customers.customer_id) as customer_total_lifetime_value,
        array_agg(distinct orders.order_id) over (partition by customers.customer_id) as customer_order_ids
from orders 
inner join customers
on orders.customer_id = customers.customer_id
),

add_avg_order_history as 
    (
    select 
        *,
        customer_total_lifetime_value / customer_non_returned_order_count as avg_non_returned_order_value

    from customer_orders
    ),

final as ( 
    select 
    order_id ,
    customer_id ,
    surname,
    givenname,
    customer_first_order_date as first_order_date,
    customer_order_count as order_count,
    customer_total_lifetime_value as total_lifetime_value,
    order_value_dollars,
    order_status ,
    payment_status
    from add_avg_order_history
)

select * from final
    )

/* {"app": "dbt", "dbt_version": "1.10.5", "profile_name": "snow_dbt", "target_name": "dev", "node_id": "model.snow_dbt.fct_customer_orders"} */;
[0m19:07:40.828930 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:07:44.610636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.782 seconds
[0m19:07:44.652634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1636b61-cb6b-4294-b425-2f7d4bd7c817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018366AF2890>]}
[0m19:07:44.654631 [info ] [Thread-1 (]: 1 of 1 OK created sql table model L1_LANDING.fct_customer_orders ............... [[32mSUCCESS 1[0m in 3.90s]
[0m19:07:44.657636 [debug] [Thread-1 (]: Finished running node model.snow_dbt.fct_customer_orders
[0m19:07:44.661638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:44.663633 [debug] [MainThread]: Connection 'list_finance_db' was left open.
[0m19:07:44.664634 [debug] [MainThread]: On list_finance_db: Close
[0m19:07:44.740632 [debug] [MainThread]: Connection 'list_finance_db_L1_LANDING' was left open.
[0m19:07:44.741635 [debug] [MainThread]: On list_finance_db_L1_LANDING: Close
[0m19:07:44.827642 [debug] [MainThread]: Connection 'model.snow_dbt.fct_customer_orders' was left open.
[0m19:07:44.828635 [debug] [MainThread]: On model.snow_dbt.fct_customer_orders: Close
[0m19:07:44.924643 [info ] [MainThread]: 
[0m19:07:44.925635 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m19:07:44.927651 [debug] [MainThread]: Command end result
[0m19:07:44.989634 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alawa\snow\snow_dbt\target\manifest.json
[0m19:07:44.996633 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alawa\snow\snow_dbt\target\semantic_manifest.json
[0m19:07:45.013634 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alawa\snow\snow_dbt\target\run_results.json
[0m19:07:45.014637 [info ] [MainThread]: 
[0m19:07:45.016634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:07:45.018641 [info ] [MainThread]: 
[0m19:07:45.020641 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:07:45.023635 [debug] [MainThread]: Command `dbt run` succeeded at 19:07:45.022636 after 8.01 seconds
[0m19:07:45.024646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183632296F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183665360B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183634ED090>]}
[0m19:07:45.025638 [debug] [MainThread]: Flushing usage events
[0m19:07:45.853865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:30.395534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015332175750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153343CC430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153343CC220>]}


============================== 19:16:30.400529 | 6323eca6-e0a8-40ad-90be-531ac058a108 ==============================
[0m19:16:30.400529 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:16:30.402495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m19:16:30.657492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6323eca6-e0a8-40ad-90be-531ac058a108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015334156CB0>]}
[0m19:16:30.708177 [debug] [MainThread]: Set downloads directory='C:\Users\alawa\AppData\Local\Temp\dbt-downloads-3333uamw'
[0m19:16:30.709185 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:16:30.798210 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:16:30.799249 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m19:16:30.897175 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m19:16:30.905168 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:16:31.018224 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:16:31.036220 [info ] [MainThread]: Updating lock file in file path: C:\Users\alawa\snow\snow_dbt/package-lock.yml
[0m19:16:31.051221 [debug] [MainThread]: Set downloads directory='C:\Users\alawa\AppData\Local\Temp\dbt-downloads-0sdaeve_'
[0m19:16:31.057219 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m19:16:31.533253 [info ] [MainThread]: Installed from version 0.12.1
[0m19:16:31.534253 [info ] [MainThread]: Up to date!
[0m19:16:31.535252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6323eca6-e0a8-40ad-90be-531ac058a108', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533341D5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153345D9B10>]}
[0m19:16:31.536252 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:16:36.971559 [info ] [MainThread]: Installed from version 1.3.0
[0m19:16:36.973557 [info ] [MainThread]: Up to date!
[0m19:16:36.974563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6323eca6-e0a8-40ad-90be-531ac058a108', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533341E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533452C5B0>]}
[0m19:16:36.978562 [debug] [MainThread]: Command `dbt deps` succeeded at 19:16:36.977559 after 6.69 seconds
[0m19:16:36.979561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015332175750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015333404AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533341E320>]}
[0m19:16:36.980557 [debug] [MainThread]: Flushing usage events
[0m19:16:37.719448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:44.960619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B351616F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B373B8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B373B8520>]}


============================== 19:39:44.969617 | 89337422-4096-4ad2-91d4-83b617fc48d6 ==============================
[0m19:39:44.969617 [info ] [MainThread]: Running with dbt=1.10.5
[0m19:39:44.971611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alawa\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\alawa\\snow\\snow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:39:45.479202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89337422-4096-4ad2-91d4-83b617fc48d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B373B8CD0>]}
[0m19:39:45.687960 [debug] [MainThread]: Set downloads directory='C:\Users\alawa\AppData\Local\Temp\dbt-downloads-lj8yrqs6'
[0m19:39:45.689959 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:39:45.977955 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:39:45.979954 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m19:39:46.265956 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m19:39:46.268962 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:39:46.537540 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:39:46.543540 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m19:39:47.021217 [info ] [MainThread]: Installed from version 0.12.1
[0m19:39:47.022215 [info ] [MainThread]: Up to date!
[0m19:39:47.024219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '89337422-4096-4ad2-91d4-83b617fc48d6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B37508760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B37508640>]}
[0m19:39:47.025219 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:39:49.993707 [info ] [MainThread]: Installed from version 1.3.0
[0m19:39:49.995741 [info ] [MainThread]: Up to date!
[0m19:39:49.997795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '89337422-4096-4ad2-91d4-83b617fc48d6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B3750B4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B37508AF0>]}
[0m19:39:50.006218 [debug] [MainThread]: Command `cli deps` succeeded at 19:39:50.004621 after 5.28 seconds
[0m19:39:50.007744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B351616F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B343FB850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B363EAF50>]}
[0m19:39:50.009891 [debug] [MainThread]: Flushing usage events
[0m19:39:50.824578 [debug] [MainThread]: An error was encountered while trying to flush usage events
